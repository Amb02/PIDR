File "TLS/tls-lib.pvl", line 380, characters 37-38:
Warning: identifier ck rebound.
File "TLS/tls-lib.pvl", line 376, characters 41-43:
Warning: identifier ems rebound.
File "TLS/tls-lib.pvl", line 458, characters 10-12:
Warning: identifier log rebound.
File "TLS/tls-lib.pvl", line 482, characters 12-14:
Warning: identifier log rebound.
File "TLS/tls-lib.pvl", line 485, characters 12-14:
Warning: identifier log rebound.
File "TLS/tls-lib.pvl", line 462, characters 12-14:
Warning: identifier log rebound.
File "TLS/tls-lib.pvl", line 468, characters 8-10:
Warning: identifier log rebound.
File "TLS/tls-lib.pvl", line 471, characters 8-10:
Warning: identifier log rebound.
File "TLS/tls-lib.pvl", line 508, characters 10-12:
Warning: identifier log rebound.
File "TLS/tls-lib.pvl", line 532, characters 12-14:
Warning: identifier log rebound.
File "TLS/tls-lib.pvl", line 538, characters 8-10:
Warning: identifier log rebound.
File "TLS/tls-lib.pvl", line 513, characters 12-14:
Warning: identifier log rebound.
File "TLS/tls-lib.pvl", line 515, characters 12-14:
Warning: identifier log rebound.
File "TLS/tls-lib.pvl", line 520, characters 8-10:
Warning: identifier log rebound.
File "TLS/tls-lib.pvl", line 563, characters 10-11:
Warning: identifier pt rebound.
File "TLS/tls-lib.pvl", line 575, character 38:
Warning: identifier a rebound.
File "TLS/tls-lib.pvl", line 580, characters 11-23:
Warning: identifier master_secret rebound.
File "TLS/tls-lib.pvl", line 585, characters 10-12:
Warning: identifier log rebound.
File "TLS/tls-lib.pvl", line 589, characters 10-12:
Warning: identifier log rebound.
File "TLS/tls-lib.pvl", line 592, characters 13-15:
Warning: identifier log rebound.
File "TLS/tls-lib.pvl", line 595, characters 13-15:
Warning: identifier log rebound.
File "TLS/tls-lib.pvl", line 617, character 39:
Warning: identifier a rebound.
File "TLS/tls-lib.pvl", line 619, characters 10-13:
Warning: identifier mode rebound.
File "TLS/tls-lib.pvl", line 630, characters 11-23:
Warning: identifier master_secret rebound.
File "TLS/tls-lib.pvl", line 635, characters 10-12:
Warning: identifier log rebound.
File "TLS/tls-lib.pvl", line 638, characters 10-12:
Warning: identifier log rebound.
File "TLS/tls-lib.pvl", line 641, characters 10-12:
Warning: identifier log rebound.
File "TLS/tls-lib.pvl", line 650, characters 13-15:
Warning: identifier log rebound.
Linear part:
dh_ideal(dh_ideal(G,x),y) = dh_ideal(dh_ideal(G,y),x)
Completing equations...
Completed equations:
dh_ideal(dh_ideal(G,x),y) = dh_ideal(dh_ideal(G,y),x)
Convergent part:
Completing equations...
Completed equations:
Process 0 (that is, the initial process):
(
    {1}!
    {2}new cr: random;
    {3}in(io, offer: params);
    {4}out(io, CH(cr,offer));
    {5}in(io, SH(sr: random,mode: params));
    {6}let nego(=TLS12,k: kex_alg,h: hash_alg,a: ae_alg,pt: psk_type) = mode in
    {7}let v: version = TLS12 in
    {8}let log: bitstring = (CH(cr,offer),SH(sr,mode)) in
    {9}in(io, CRT(p: pubkey));
    {10}let log_1: bitstring = (log,CRT(p)) in
    {45}get longTermKeys_tbl(sn: prin,xxx: privkey,=p) in
    {11}let DHE(g: group) = k in
    (
        {12}in(io, SKE(=g,e: element,s: bitstring));
        {13}let log_2: bitstring = (log_1,SKE(g,e,s)) in
        {14}if (verify(p,hash(h,(cr,sr,g,e)),s) = true) then
        {15}new x_1: bitstring;
        {16}let v_1: element = catch-fail(dh_exp(g,G,x_1)) in
        {17}let (x_2: bitstring,gx: element) = (if not-caught-fail(v_1) then (x_1,v_1) else fail-any) in
        {18}let pms: bitstring = e2b(dh_exp(g,e,x_2)) in
        {19}let ms: bitstring = tls12_prf(pms,master_secret,(cr,sr)) in
        {20}out(io, CKE(e2b(gx)));
        {21}let log_3: bitstring = (log_2,CKE(e2b(gx))) in
        {22}let m1: bitstring = tls12_prf(ms,client_finished,log_3) in
        {23}out(io, FIN(m1));
        {24}let log_4: bitstring = (log_3,FIN(m1)) in
        {25}in(io, FIN(m2: bitstring));
        {26}if (m2 = tls12_prf(ms,server_finished,log_4)) then
        {27}let ck: ae_key = b2ae(tls12_prf(ms,client_key_expansion,(sr,cr))) in
        {28}let sk: ae_key = b2ae(tls12_prf(ms,server_key_expansion,(sr,cr))) in
        {29}event ClientFinished(TLS12,cr,sr,NoPSK,p,offer,mode,ck,sk,m1,ms);
        {30}insert clientSession(cr,sr,NoPSK,p,offer,mode,ck,sk,m1,ms)
    )
    else
        {31}let RSA(r: rsa_alg) = k in
        {32}new pms_1: bitstring;
        {33}let ms_1: bitstring = tls12_prf(pms_1,master_secret,(cr,sr)) in
        {34}out(io, CKE(rsa_enc(p,pms_1)));
        {35}let log_5: bitstring = (log_1,CKE(rsa_enc(p,pms_1))) in
        {36}let m1_1: bitstring = tls12_prf(ms_1,client_finished,log_5) in
        {37}out(io, FIN(m1_1));
        {38}let log_6: bitstring = (log_5,FIN(m1_1)) in
        {39}in(io, FIN(m2_1: bitstring));
        {40}if (m2_1 = tls12_prf(ms_1,server_finished,log_6)) then
        {41}let ck_1: ae_key = b2ae(tls12_prf(ms_1,client_key_expansion,(sr,cr))) in
        {42}let sk_1: ae_key = b2ae(tls12_prf(ms_1,server_key_expansion,(sr,cr))) in
        {43}event ClientFinished(TLS12,cr,sr,NoPSK,p,offer,mode,ck_1,sk_1,m1_1,ms_1);
        {44}insert clientSession(cr,sr,NoPSK,p,offer,mode,ck_1,sk_1,m1_1,ms_1)
) | (
    {46}!
    {47}in(io, CH(cr_1: random,offer_1: params));
    {48}in(io, SH(xxx_1: random,mode_1: params));
    {49}let nego(=TLS12,k_1: kex_alg,h_1: hash_alg,a_1: ae_alg,pt_1: psk_type) = mode_1 in
    {50}let v_2: version = TLS12 in
    {51}new sr_1: random;
    {52}out(io, SH(sr_1,mode_1));
    {53}let log_7: bitstring = (CH(cr_1,offer_1),SH(sr_1,mode_1)) in
    {101}get longTermKeys_tbl(sn_1: prin,sk_2: privkey,p_1: pubkey) in
    {54}event ServerChoosesVersion(cr_1,sr_1,p_1,v_2);
    {55}event ServerChoosesKEX(cr_1,sr_1,p_1,v_2,k_1);
    {56}event ServerChoosesAE(cr_1,sr_1,p_1,v_2,a_1);
    {57}event ServerChoosesHash(cr_1,sr_1,p_1,v_2,h_1);
    {58}out(io, CRT(p_1));
    {59}let log_8: bitstring = (log_7,CRT(p_1)) in
    {60}let DHE(g_1: group) = k_1 in
    (
        {61}new x_3: bitstring;
        {62}let v_3: element = catch-fail(dh_exp(g_1,G,x_3)) in
        {63}let (y_1: bitstring,gy: element) = (if not-caught-fail(v_3) then (x_3,v_3) else fail-any) in
        {64}let sg: bitstring = sign(sk_2,hash(h_1,(cr_1,sr_1,g_1,gy))) in
        {65}out(io, SKE(g_1,gy,sg));
        {66}let log_9: bitstring = (log_8,SKE(g_1,gy,sg)) in
        {67}in(io, CKE(e2b(gx_1: element)));
        {68}let log_10: bitstring = (log_9,CKE(e2b(gx_1))) in
        {69}let pms_2: bitstring = e2b(dh_exp(g_1,gx_1,y_1)) in
        {70}let ms_2: bitstring = tls12_prf(pms_2,master_secret,(cr_1,sr_1)) in
        {71}in(io, FIN(m1_2: bitstring));
        {72}if (m1_2 = tls12_prf(ms_2,client_finished,log_10)) then
        {73}let log_11: bitstring = (log_10,FIN(m1_2)) in
        {74}let m2_2: bitstring = tls12_prf(ms_2,server_finished,log_11) in
        {75}let cak: ae_key = b2ae(tls12_prf(ms_2,client_key_expansion,(sr_1,cr_1))) in
        {76}let sak: ae_key = b2ae(tls12_prf(ms_2,server_key_expansion,(sr_1,cr_1))) in
        {77}event ServerFinished(TLS12,cr_1,sr_1,NoPSK,p_1,offer_1,mode_1,cak,sak,m1_2,ms_2);
        {78}out(io, FIN(m2_2));
        {79}insert serverSession(cr_1,sr_1,NoPSK,p_1,offer_1,mode_1,cak,sak,m1_2,ms_2);
        {80}phase 1;
        {81}event PostSessionCompromisedKey(pk(sk_2));
        {82}out(io, sk_2)
    )
    else
        {83}let RSA(r_1: rsa_alg) = k_1 in
        {84}in(io, CKE(epms: bitstring));
        {85}let log_12: bitstring = (log_8,CKE(epms)) in
        {86}let success(pms_3: bitstring,leak: bitstring) = rsa_dec(r_1,sk_2,epms) in
        {87}out(io, leak);
        {88}let ms_3: bitstring = tls12_prf(pms_3,master_secret,(cr_1,sr_1)) in
        {89}in(io, FIN(m1_3: bitstring));
        {90}if (m1_3 = tls12_prf(ms_3,client_finished,log_12)) then
        {91}let log_13: bitstring = (log_12,FIN(m1_3)) in
        {92}let m2_3: bitstring = tls12_prf(ms_3,server_finished,log_13) in
        {93}let cak_1: ae_key = b2ae(tls12_prf(ms_3,client_key_expansion,(sr_1,cr_1))) in
        {94}let sak_1: ae_key = b2ae(tls12_prf(ms_3,server_key_expansion,(sr_1,cr_1))) in
        {95}event ServerFinished(TLS12,cr_1,sr_1,NoPSK,p_1,offer_1,mode_1,cak_1,sak_1,m1_3,ms_3);
        {96}out(io, FIN(m2_3));
        {97}insert serverSession(cr_1,sr_1,NoPSK,p_1,offer_1,mode_1,cak_1,sak_1,m1_3,ms_3);
        {98}phase 1;
        {99}event PostSessionCompromisedKey(pk(sk_2));
        {100}out(io, sk_2)
) | (
    {102}!
    (
        {103}event WeakOrCompromisedKey(NoPubKey)
    ) | (
        {104}in(io, a_2: prin);
        {105}new k_2: privkey;
        {106}insert longTermKeys_tbl(a_2,k_2,pk(k_2));
        {107}out(io, pk(k_2))
    ) | (
        {108}in(io, (a_3: prin,k_3: privkey));
        {109}event WeakOrCompromisedKey(pk(k_3));
        {110}insert longTermKeys_tbl(a_3,k_3,pk(k_3))
    ) | (
        {111}in(io, (a_4: prin,b: prin));
        {112}new pskAB: bitstring;
        {113}insert preSharedKeys(a_4,b,PSK(pskAB))
    ) | (
        {114}in(io, (a_5: prin,b_1: prin));
        {115}new pskAB_1: bitstring;
        {116}event CompromisedPreSharedKey(PSK(pskAB_1));
        {117}insert preSharedKeys(a_5,b_1,PSK(pskAB_1));
        {118}out(io, pskAB_1)
    )
) | (
    {119}!
    (
        {125}get clientSession0(cr_2: random,psk: preSharedKey,o: params,kc0: ae_key,ems0: bitstring) in
        {120}let nego(v_4: version,kkk: kex_alg,hhh: hash_alg,a_6: ae_alg,pt_2: psk_type) = o in
        {121}in(io, (n: bitstring,ad: bitstring));
        {122}let mesg: bitstring = m_c0(TLS13,cr_2,psk) in
        {123}event ClientSends0(TLS13,cr_2,psk,n,ad,mesg);
        {124}out(io, aead_enc(a_6,kc0,n,ad,mesg))
    ) | (
        {130}get serverSession0(cr_3: random,psk_1: preSharedKey,o_1: params,kc0_1: ae_key,ems0_1: bitstring) in
        {126}let nego(v_5: version,kkk_1: kex_alg,hhh_1: hash_alg,a_7: ae_alg,pt_3: psk_type) = o_1 in
        {127}in(io, (n_1: bitstring,ad_1: bitstring,c: bitstring));
        {128}let f: bitstring = aead_dec(a_7,kc0_1,n_1,ad_1,c) in
        {129}event ServerReceives0(TLS13,cr_3,psk_1,n_1,ad_1,f)
    ) | (
        {136}get serverSession0_5(cr_4: random,sr_2: random,psk_2: preSharedKey,ps: pubkey,o_2: params,m: params,kc: ae_key,ks: ae_key,ems: bitstring) in
        {131}let nego(v_6: version,kkk_2: kex_alg,hhh_2: hash_alg,a_8: ae_alg,pt_4: psk_type) = m in
        {132}in(io, (n_2: bitstring,ad_2: bitstring));
        {133}let mesg_1: bitstring = m_s(v_6,cr_4,sr_2,ps,psk_2) in
        {134}event ServerSends(v_6,cr_4,sr_2,psk_2,ps,n_2,ad_2,mesg_1);
        {135}out(io, aead_enc(a_8,ks,n_2,ad_2,mesg_1))
    ) | (
        {142}get clientSession(cr_5: random,sr_3: random,psk_3: preSharedKey,ps_1: pubkey,o_3: params,m_1: params,kc_1: ae_key,ks_1: ae_key,ems_1: bitstring,rms: bitstring) in
        {137}let nego(v_7: version,kkk_3: kex_alg,hhh_3: hash_alg,a_9: ae_alg,pt_5: psk_type) = m_1 in
        {138}in(io, (n_3: bitstring,ad_3: bitstring));
        {139}let mesg_2: bitstring = m_c(v_7,cr_5,sr_3,ps_1,psk_3) in
        {140}event ClientSends(v_7,cr_5,sr_3,psk_3,ps_1,n_3,ad_3,mesg_2);
        {141}out(io, aead_enc(a_9,kc_1,n_3,ad_3,mesg_2))
    ) | (
        {147}get serverSession(cr_6: random,sr_4: random,psk_4: preSharedKey,ps_2: pubkey,o_4: params,m_2: params,kc_2: ae_key,ks_2: ae_key,ems_2: bitstring,rms_1: bitstring) in
        {143}let nego(v_8: version,kkk_4: kex_alg,hhh_4: hash_alg,a_10: ae_alg,pt_6: psk_type) = m_2 in
        {144}in(io, (n_4: bitstring,ad_4: bitstring,c_1: bitstring));
        {145}let f_1: bitstring = aead_dec(a_10,kc_2,n_4,ad_4,c_1) in
        {146}event ServerReceives(v_8,cr_6,sr_4,psk_4,ps_2,n_4,ad_4,f_1)
    ) | (
        {153}get serverSession(cr_7: random,sr_5: random,psk_5: preSharedKey,ps_3: pubkey,o_5: params,m_3: params,kc_3: ae_key,ks_3: ae_key,ems_3: bitstring,rms_2: bitstring) in
        {148}let nego(v_9: version,kkk_5: kex_alg,hhh_5: hash_alg,a_11: ae_alg,pt_7: psk_type) = m_3 in
        {149}in(io, (n_5: bitstring,ad_5: bitstring));
        {150}let mesg_3: bitstring = m_s(v_9,cr_7,sr_5,ps_3,psk_5) in
        {151}event ServerSends(v_9,cr_7,sr_5,psk_5,ps_3,n_5,ad_5,mesg_3);
        {152}out(io, aead_enc(a_11,ks_3,n_5,ad_5,mesg_3))
    ) | (
        {158}get clientSession(cr_8: random,sr_6: random,psk_6: preSharedKey,ps_4: pubkey,o_6: params,m_4: params,kc_4: ae_key,ks_4: ae_key,ems_4: bitstring,rms_3: bitstring) in
        {154}let nego(v_10: version,kkk_6: kex_alg,hhh_6: hash_alg,a_12: ae_alg,pt_8: psk_type) = m_4 in
        {155}in(io, (n_6: bitstring,ad_6: bitstring,c_2: bitstring));
        {156}let f_2: bitstring = aead_dec(a_12,ks_4,n_6,ad_6,c_2) in
        {157}event ClientReceives(v_10,cr_8,sr_6,psk_6,ps_4,n_6,ad_6,f_2)
    )
) | (
    {159}!
    (
        {163}get clientSession(cr_9: random,sr_7: random,psk_7: preSharedKey,p_2: pubkey,o_7: params,m_5: params,ck_2: ae_key,sk_3: ae_key,cb: bitstring,ms_4: bitstring) in
        {160}let nego(v_11: version,kkk_7: kex_alg,hhh_7: hash_alg,aaa: ae_alg,ppp: psk_type) = m_5 in
        {161}in(io, =ck_2);
        {162}event ClientAEKeyLeaked(v_11,cr_9,sr_7,psk_7,p_2)
    ) | (
        {167}get serverSession(cr_10: random,sr_8: random,psk_8: preSharedKey,p_3: pubkey,o_8: params,m_6: params,ck_3: ae_key,sk_4: ae_key,cb_1: bitstring,ms_5: bitstring) in
        {164}let nego(v_12: version,kkk_8: kex_alg,hhh_8: hash_alg,aaa_1: ae_alg,ppp_1: psk_type) = m_6 in
        {165}in(io, =sk_4);
        {166}event ServerAEKeyLeaked(v_12,cr_10,sr_8,psk_8,p_3)
    ) | (
        {170}get clientSession0(cr_11: random,psk_9: preSharedKey,o_9: params,ck_4: ae_key,ems_5: bitstring) in
        {168}in(io, =ck_4);
        {169}event ClientAEKeyLeaked0(TLS13,cr_11,psk_9,o_9)
    ) | (
        {173}get serverSession0(cr_12: random,psk_10: preSharedKey,o_10: params,ck_5: ae_key,ems_6: bitstring) in
        {171}in(io, =ck_5);
        {172}event ServerAEKeyLeaked0(TLS13,cr_12,psk_10,o_10)
    )
) | (
    {174}!
    (
        {178}get clientSession0(cr_13: random,psk_11: preSharedKey,o_11: params,ck_6: ae_key,ems_7: bitstring) in
        {177}get serverSession0(cr': random,psk': preSharedKey,o': params,=ck_6,ems_8: bitstring) in
        {175}if ((cr_13 ≠ cr') || ((psk_11 ≠ psk') || (o_11 ≠ o'))) then
        {176}event MatchingAEKey0(TLS13,cr_13,psk_11,o_11,cr',psk',o')
    ) | (
        {182}get clientSession0(cr_14: random,psk_12: preSharedKey,o_12: params,ck_7: ae_key,ems_9: bitstring) in
        {181}get serverSession0(cr'_1: random,psk'_1: preSharedKey,o'_1: params,ck_8: ae_key,=ems_9) in
        {179}if ((cr_14 ≠ cr'_1) || ((psk_12 ≠ psk'_1) || (o_12 ≠ o'_1))) then
        {180}event MatchingEMS0(TLS13,cr_14,psk_12,o_12,cr'_1,psk'_1,o'_1)
    ) | (
        {188}get clientSession(cr_15: random,sr_9: random,psk_13: preSharedKey,p_4: pubkey,o_13: params,m_7: params,ck_9: ae_key,sk_5: ae_key,cb_2: bitstring,ms_6: bitstring) in
        {187}get serverSession(cr'_2: random,sr': random,psk'_2: preSharedKey,p': pubkey,o'_2: params,m': params,ck': ae_key,sk': ae_key,=cb_2,ms': bitstring) in
        {183}let nego(v_13: version,kkk_9: kex_alg,hhh_9: hash_alg,aaa_2: ae_alg,ppp_2: psk_type) = m_7 in
        {184}let nego(v': version,kkk': kex_alg,hhh': hash_alg,aaa': ae_alg,ppp': psk_type) = m' in
        {185}if ((cr_15 ≠ cr'_2) || ((sr_9 ≠ sr') || (p_4 ≠ p'))) then
        {186}event MatchingChannelBinding(v_13,cr_15,sr_9,p_4,v',cr'_2,sr',p')
    ) | (
        {194}get clientSession(cr_16: random,sr_10: random,psk_14: preSharedKey,p_5: pubkey,o_14: params,m_8: params,ck_10: ae_key,sk_6: ae_key,cb_3: bitstring,ms_7: bitstring) in
        {193}get serverSession(cr'_3: random,sr'_1: random,psk'_3: preSharedKey,p'_1: pubkey,o'_3: params,m'_1: params,ck'_1: ae_key,sk'_1: ae_key,cb': bitstring,=ms_7) in
        {189}let nego(v_14: version,kkk_10: kex_alg,hhh_10: hash_alg,aaa_3: ae_alg,ppp_3: psk_type) = m_8 in
        {190}let nego(v'_1: version,kkk'_1: kex_alg,hhh'_1: hash_alg,aaa'_1: ae_alg,ppp'_1: psk_type) = m'_1 in
        {191}if ((cr_16 ≠ cr'_3) || ((sr_10 ≠ sr'_1) || (p_5 ≠ p'_1))) then
        {192}event MatchingResumptionSecret(v_14,cr_16,sr_10,p_5,v'_1,cr'_3,sr'_1,p'_1)
    ) | (
        {200}get clientSession(cr_17: random,sr_11: random,psk_15: preSharedKey,p_6: pubkey,o_15: params,m_9: params,ck_11: ae_key,sk_7: ae_key,cb_4: bitstring,ms_8: bitstring) in
        {199}get serverSession(cr'_4: random,sr'_2: random,psk'_4: preSharedKey,p'_2: pubkey,o'_4: params,m'_2: params,=ck_11,=sk_7,cb'_1: bitstring,ms'_1: bitstring) in
        {195}let nego(v_15: version,kkk_11: kex_alg,hhh_11: hash_alg,aaa_4: ae_alg,ppp_4: psk_type) = m_9 in
        {196}let nego(v'_2: version,kkk'_2: kex_alg,hhh'_2: hash_alg,aaa'_2: ae_alg,ppp'_2: psk_type) = m'_2 in
        {197}if ((cr_17 ≠ cr'_4) || ((sr_11 ≠ sr'_2) || (p_6 ≠ p'_2))) then
        {198}event MatchingAEKey(v_15,cr_17,sr_11,p_6,v'_2,cr'_4,sr'_2,p'_2)
    )
)

-- Query event(ClientFinished(TLS12,cr_18,sr_12,psk_16,p_7,m_10,o_16,ck_12,sk_8,cb_5,ms_9)) ==> event(ServerFinished(TLS12,cr_18,sr_12,psk_16,p_7,m_10,o_16,ck_12,sk_8,cb_5,ms_9)) in process 0.
Completing...
200 rules inserted. The rule base contains 200 rules. 139 rules in the queue.
400 rules inserted. The rule base contains 396 rules. 79 rules in the queue.
600 rules inserted. The rule base contains 517 rules. 162 rules in the queue.
800 rules inserted. The rule base contains 577 rules. 198 rules in the queue.
1000 rules inserted. The rule base contains 642 rules. 228 rules in the queue.
1200 rules inserted. The rule base contains 671 rules. 235 rules in the queue.
1400 rules inserted. The rule base contains 754 rules. 301 rules in the queue.
1600 rules inserted. The rule base contains 799 rules. 297 rules in the queue.
1800 rules inserted. The rule base contains 850 rules. 293 rules in the queue.
2000 rules inserted. The rule base contains 879 rules. 303 rules in the queue.
2200 rules inserted. The rule base contains 944 rules. 263 rules in the queue.
2400 rules inserted. The rule base contains 996 rules. 278 rules in the queue.
2600 rules inserted. The rule base contains 1083 rules. 290 rules in the queue.
2800 rules inserted. The rule base contains 1175 rules. 331 rules in the queue.
3000 rules inserted. The rule base contains 1245 rules. 297 rules in the queue.
3200 rules inserted. The rule base contains 1352 rules. 291 rules in the queue.
3400 rules inserted. The rule base contains 1440 rules. 294 rules in the queue.
3600 rules inserted. The rule base contains 1555 rules. 284 rules in the queue.
3800 rules inserted. The rule base contains 1650 rules. 263 rules in the queue.
4000 rules inserted. The rule base contains 1764 rules. 274 rules in the queue.
4200 rules inserted. The rule base contains 1806 rules. 310 rules in the queue.
4400 rules inserted. The rule base contains 1859 rules. 275 rules in the queue.
4600 rules inserted. The rule base contains 1852 rules. 220 rules in the queue.
4800 rules inserted. The rule base contains 1839 rules. 130 rules in the queue.
5000 rules inserted. The rule base contains 1824 rules. 49 rules in the queue.
5200 rules inserted. The rule base contains 1929 rules. 11 rules in the queue.
Starting query event(ClientFinished(TLS12,cr_18,sr_12,psk_16,p_7,m_10,o_16,ck_12,sk_8,cb_5,ms_9)) ==> event(ServerFinished(TLS12,cr_18,sr_12,psk_16,p_7,m_10,o_16,ck_12,sk_8,cb_5,ms_9))
goal reachable: attacker(sn_2) && attacker(sr_12) && attacker(a_13) && attacker(pt_9) && attacker(m_10) -> end(ClientFinished(TLS12,cr_18,sr_12,NoPSK,pk(k_4),m_10,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),client_key_expansion,(sr_12,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),server_key_expansion,(sr_12,cr_18))),tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G))))),CKE(e2b(dh_ideal(G,x_4))))),tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12))))
Abbreviations:
cr_18 = cr[!1 = @sid]
k_4 = k_2[a_2 = sn_2,!1 = @sid_1]
x_4 = x_1[s = sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G))),e = G,xxx = k_4,sn = sn_2,p = pk(k_4),mode = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),sr = sr_12,offer = m_10,!1 = @sid]

Derivation:
Abbreviations:
cr_18 = cr[!1 = @sid]
k_4 = k_2[a_2 = sn_2,!1 = @sid_1]
x_4 = x_1[s = sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G))),e = G,xxx = k_4,sn = sn_2,p = pk(k_4),mode = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),sr = sr_12,offer = m_10,!1 = @sid]

1. We assume as hypothesis that
attacker(m_10).

2. We assume as hypothesis that
attacker(pt_9).

3. We assume as hypothesis that
attacker(a_13).

4. Using the function StrongHash the attacker may obtain StrongHash.
attacker(StrongHash).

5. Using the function StrongDH the attacker may obtain StrongDH.
attacker(StrongDH).

6. By 5, the attacker may know StrongDH.
Using the function DHE the attacker may obtain DHE(StrongDH).
attacker(DHE(StrongDH)).

7. Using the function TLS12 the attacker may obtain TLS12.
attacker(TLS12).

8. By 7, the attacker may know TLS12.
By 6, the attacker may know DHE(StrongDH).
By 4, the attacker may know StrongHash.
By 3, the attacker may know a_13.
By 2, the attacker may know pt_9.
Using the function nego the attacker may obtain nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9).
attacker(nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9)).

9. We assume as hypothesis that
attacker(sr_12).

10. By 9, the attacker may know sr_12.
By 8, the attacker may know nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9).
Using the function SH the attacker may obtain SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9)).
attacker(SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))).

11. We assume as hypothesis that
attacker(sn_2).

12. The message sn_2 that the attacker may have by 11 may be received at input {104}.
So the message pk(k_4) may be sent to the attacker at output {107}.
attacker(pk(k_4)).

13. By 12, the attacker may know pk(k_4).
Using the function CRT the attacker may obtain CRT(pk(k_4)).
attacker(CRT(pk(k_4))).

14. The message sn_2 that the attacker may have by 11 may be received at input {104}.
So the entry longTermKeys_tbl(sn_2,k_4,pk(k_4)) may be inserted in a table at insert {106}.
table(longTermKeys_tbl(sn_2,k_4,pk(k_4))).

15. The attacker has some term offer_2.
attacker(offer_2).

16. The attacker has some term cr_19.
attacker(cr_19).

17. By 16, the attacker may know cr_19.
By 15, the attacker may know offer_2.
Using the function CH the attacker may obtain CH(cr_19,offer_2).
attacker(CH(cr_19,offer_2)).

18. The attacker has some term pt_10.
attacker(pt_10).

19. The attacker has some term a_14.
attacker(a_14).

20. The attacker has some term h_2.
attacker(h_2).

21. Using the function WeakRSADecryption the attacker may obtain WeakRSADecryption.
attacker(WeakRSADecryption).

22. By 21, the attacker may know WeakRSADecryption.
Using the function RSA the attacker may obtain RSA(WeakRSADecryption).
attacker(RSA(WeakRSADecryption)).

23. By 7, the attacker may know TLS12.
By 22, the attacker may know RSA(WeakRSADecryption).
By 20, the attacker may know h_2.
By 19, the attacker may know a_14.
By 18, the attacker may know pt_10.
Using the function nego the attacker may obtain nego(TLS12,RSA(WeakRSADecryption),h_2,a_14,pt_10).
attacker(nego(TLS12,RSA(WeakRSADecryption),h_2,a_14,pt_10)).

24. The attacker has some term xxx_2.
attacker(xxx_2).

25. By 24, the attacker may know xxx_2.
By 23, the attacker may know nego(TLS12,RSA(WeakRSADecryption),h_2,a_14,pt_10).
Using the function SH the attacker may obtain SH(xxx_2,nego(TLS12,RSA(WeakRSADecryption),h_2,a_14,pt_10)).
attacker(SH(xxx_2,nego(TLS12,RSA(WeakRSADecryption),h_2,a_14,pt_10))).

26. Using the function G the attacker may obtain G.
attacker(G).

27. The attacker has some term offer_3.
attacker(offer_3).

28. The message offer_3 that the attacker may have by 27 may be received at input {3}.
So the message CH(cr_18,offer_3) may be sent to the attacker at output {4}.
attacker(CH(cr_18,offer_3)).

29. By 28, the attacker may know CH(cr_18,offer_3).
Using the function 1-proj-CH the attacker may obtain cr_18.
attacker(cr_18).

30. By 29, the attacker may know cr_18.
By 9, the attacker may know sr_12.
By 5, the attacker may know StrongDH.
By 26, the attacker may know G.
Using the function 4-tuple the attacker may obtain (cr_18,sr_12,StrongDH,G).
attacker((cr_18,sr_12,StrongDH,G)).

31. By 30, the attacker may know (cr_18,sr_12,StrongDH,G).
Using the function hash_ideal the attacker may obtain hash_ideal((cr_18,sr_12,StrongDH,G)).
attacker(hash_ideal((cr_18,sr_12,StrongDH,G))).

32. By 12, the attacker may know pk(k_4).
By 31, the attacker may know hash_ideal((cr_18,sr_12,StrongDH,G)).
Using the function rsa_enc the attacker may obtain rsa_enc(pk(k_4),hash_ideal((cr_18,sr_12,StrongDH,G))).
attacker(rsa_enc(pk(k_4),hash_ideal((cr_18,sr_12,StrongDH,G)))).

33. By 32, the attacker may know rsa_enc(pk(k_4),hash_ideal((cr_18,sr_12,StrongDH,G))).
Using the function CKE the attacker may obtain CKE(rsa_enc(pk(k_4),hash_ideal((cr_18,sr_12,StrongDH,G)))).
attacker(CKE(rsa_enc(pk(k_4),hash_ideal((cr_18,sr_12,StrongDH,G))))).

34. The message CH(cr_19,offer_2) that the attacker may have by 17 may be received at input {47}.
The message SH(xxx_2,nego(TLS12,RSA(WeakRSADecryption),h_2,a_14,pt_10)) that the attacker may have by 25 may be received at input {48}.
The entry longTermKeys_tbl(sn_2,k_4,pk(k_4)) that may be in a table by 14 may be read at get {101}.
The message CKE(rsa_enc(pk(k_4),hash_ideal((cr_18,sr_12,StrongDH,G)))) that the attacker may have by 33 may be received at input {84}.
So the message (hash_ideal((cr_18,sr_12,StrongDH,G)),sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G)))) may be sent to the attacker at output {87}.
attacker((hash_ideal((cr_18,sr_12,StrongDH,G)),sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G))))).

35. By 34, the attacker may know (hash_ideal((cr_18,sr_12,StrongDH,G)),sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G)))).
Using the function 2-proj-2-tuple the attacker may obtain sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G))).
attacker(sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G)))).

36. By 5, the attacker may know StrongDH.
By 26, the attacker may know G.
By 35, the attacker may know sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G))).
Using the function SKE the attacker may obtain SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G)))).
attacker(SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G))))).

37. The message m_10 that the attacker may have by 1 may be received at input {3}.
The message SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9)) that the attacker may have by 10 may be received at input {5}.
The message CRT(pk(k_4)) that the attacker may have by 13 may be received at input {9}.
The entry longTermKeys_tbl(sn_2,k_4,pk(k_4)) that may be in a table by 14 may be read at get {45}.
The message SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G)))) that the attacker may have by 36 may be received at input {12}.
We have G ≠ BadElement.
So the message CKE(e2b(dh_ideal(G,x_4))) may be sent to the attacker at output {20}.
attacker(CKE(e2b(dh_ideal(G,x_4)))).

38. By 37, the attacker may know CKE(e2b(dh_ideal(G,x_4))).
Using the function 1-proj-CKE the attacker may obtain e2b(dh_ideal(G,x_4)).
attacker(e2b(dh_ideal(G,x_4))).

39. By 38, the attacker may know e2b(dh_ideal(G,x_4)).
Using the function 1-proj-e2b the attacker may obtain dh_ideal(G,x_4).
attacker(dh_ideal(G,x_4)).

40. By 39, the attacker may know dh_ideal(G,x_4).
Using the function e2b the attacker may obtain e2b(dh_ideal(G,x_4)).
attacker(e2b(dh_ideal(G,x_4))).

41. By 40, the attacker may know e2b(dh_ideal(G,x_4)).
Using the function CKE the attacker may obtain CKE(e2b(dh_ideal(G,x_4))).
attacker(CKE(e2b(dh_ideal(G,x_4)))).

42. By 29, the attacker may know cr_18.
By 1, the attacker may know m_10.
Using the function CH the attacker may obtain CH(cr_18,m_10).
attacker(CH(cr_18,m_10)).

43. By 42, the attacker may know CH(cr_18,m_10).
By 10, the attacker may know SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9)).
Using the function 2-tuple the attacker may obtain (CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))).
attacker((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9)))).

44. By 43, the attacker may know (CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))).
By 13, the attacker may know CRT(pk(k_4)).
Using the function 2-tuple the attacker may obtain ((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))).
attacker(((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4)))).

45. By 44, the attacker may know ((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))).
By 36, the attacker may know SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G)))).
Using the function 2-tuple the attacker may obtain (((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G))))).
attacker((((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G)))))).

46. By 45, the attacker may know (((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G))))).
By 41, the attacker may know CKE(e2b(dh_ideal(G,x_4))).
Using the function 2-tuple the attacker may obtain ((((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G))))),CKE(e2b(dh_ideal(G,x_4)))).
attacker(((((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G))))),CKE(e2b(dh_ideal(G,x_4))))).

47. Using the function client_finished the attacker may obtain client_finished.
attacker(client_finished).

48. By 29, the attacker may know cr_18.
By 9, the attacker may know sr_12.
Using the function 2-tuple the attacker may obtain (cr_18,sr_12).
attacker((cr_18,sr_12)).

49. Using the function master_secret the attacker may obtain master_secret.
attacker(master_secret).

50. By 40, the attacker may know e2b(dh_ideal(G,x_4)).
By 49, the attacker may know master_secret.
By 48, the attacker may know (cr_18,sr_12).
Using the function tls12_prf the attacker may obtain tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)).
attacker(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12))).

51. By 50, the attacker may know tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)).
By 47, the attacker may know client_finished.
By 46, the attacker may know ((((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G))))),CKE(e2b(dh_ideal(G,x_4)))).
Using the function tls12_prf the attacker may obtain tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G))))),CKE(e2b(dh_ideal(G,x_4))))).
attacker(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G))))),CKE(e2b(dh_ideal(G,x_4)))))).

52. By 51, the attacker may know tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G))))),CKE(e2b(dh_ideal(G,x_4))))).
Using the function FIN the attacker may obtain FIN(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G))))),CKE(e2b(dh_ideal(G,x_4)))))).
attacker(FIN(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G))))),CKE(e2b(dh_ideal(G,x_4))))))).

53. By 46, the attacker may know ((((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G))))),CKE(e2b(dh_ideal(G,x_4)))).
By 52, the attacker may know FIN(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G))))),CKE(e2b(dh_ideal(G,x_4)))))).
Using the function 2-tuple the attacker may obtain (((((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G))))),CKE(e2b(dh_ideal(G,x_4)))),FIN(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G))))),CKE(e2b(dh_ideal(G,x_4))))))).
attacker((((((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G))))),CKE(e2b(dh_ideal(G,x_4)))),FIN(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G))))),CKE(e2b(dh_ideal(G,x_4)))))))).

54. Using the function server_finished the attacker may obtain server_finished.
attacker(server_finished).

55. By 50, the attacker may know tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)).
By 54, the attacker may know server_finished.
By 53, the attacker may know (((((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G))))),CKE(e2b(dh_ideal(G,x_4)))),FIN(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G))))),CKE(e2b(dh_ideal(G,x_4))))))).
Using the function tls12_prf the attacker may obtain tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),server_finished,(((((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G))))),CKE(e2b(dh_ideal(G,x_4)))),FIN(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G))))),CKE(e2b(dh_ideal(G,x_4)))))))).
attacker(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),server_finished,(((((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G))))),CKE(e2b(dh_ideal(G,x_4)))),FIN(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G))))),CKE(e2b(dh_ideal(G,x_4))))))))).

56. By 55, the attacker may know tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),server_finished,(((((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G))))),CKE(e2b(dh_ideal(G,x_4)))),FIN(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G))))),CKE(e2b(dh_ideal(G,x_4)))))))).
Using the function FIN the attacker may obtain FIN(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),server_finished,(((((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G))))),CKE(e2b(dh_ideal(G,x_4)))),FIN(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G))))),CKE(e2b(dh_ideal(G,x_4))))))))).
attacker(FIN(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),server_finished,(((((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G))))),CKE(e2b(dh_ideal(G,x_4)))),FIN(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G))))),CKE(e2b(dh_ideal(G,x_4)))))))))).

57. The message m_10 that the attacker may have by 1 may be received at input {3}.
The message SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9)) that the attacker may have by 10 may be received at input {5}.
The message CRT(pk(k_4)) that the attacker may have by 13 may be received at input {9}.
The entry longTermKeys_tbl(sn_2,k_4,pk(k_4)) that may be in a table by 14 may be read at get {45}.
The message SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G)))) that the attacker may have by 36 may be received at input {12}.
The message FIN(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),server_finished,(((((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G))))),CKE(e2b(dh_ideal(G,x_4)))),FIN(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G))))),CKE(e2b(dh_ideal(G,x_4))))))))) that the attacker may have by 56 may be received at input {25}.
We have G ≠ BadElement.
So event ClientFinished(TLS12,cr_18,sr_12,NoPSK,pk(k_4),m_10,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),client_key_expansion,(sr_12,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),server_key_expansion,(sr_12,cr_18))),tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G))))),CKE(e2b(dh_ideal(G,x_4))))),tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12))) may be executed at {29}.
end(ClientFinished(TLS12,cr_18,sr_12,NoPSK,pk(k_4),m_10,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),client_key_expansion,(sr_12,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),server_key_expansion,(sr_12,cr_18))),tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G))))),CKE(e2b(dh_ideal(G,x_4))))),tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)))).

58. By 57, end(ClientFinished(TLS12,cr_18,sr_12,NoPSK,pk(k_4),m_10,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),client_key_expansion,(sr_12,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),server_key_expansion,(sr_12,cr_18))),tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G))))),CKE(e2b(dh_ideal(G,x_4))))),tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)))).
The goal is reached, represented in the following fact:
end(ClientFinished(TLS12,cr_18,sr_12,NoPSK,pk(k_4),m_10,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),client_key_expansion,(sr_12,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),server_key_expansion,(sr_12,cr_18))),tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G))))),CKE(e2b(dh_ideal(G,x_4))))),tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)))).


Unified offer_2 with m_10
Iterating unifyDerivation.
Fixpoint reached: nothing more to unify.
The clause after unifyDerivation is
attacker(m_11) && attacker(pt_9) && attacker(a_13) && attacker(sr_12) && attacker(sn_2) -> end(ClientFinished(TLS12,cr[!1 = @sid],sr_12,NoPSK,pk(k_2[a_2 = sn_2,!1 = @sid_1]),m_11,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_1[s = sign(k_2[a_2 = sn_2,!1 = @sid_1],hash_ideal((cr[!1 = @sid],sr_12,StrongDH,G))),e = G,xxx = k_2[a_2 = sn_2,!1 = @sid_1],sn = sn_2,p = pk(k_2[a_2 = sn_2,!1 = @sid_1]),mode = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),sr = sr_12,offer = m_11,!1 = @sid])),master_secret,(cr[!1 = @sid],sr_12)),client_key_expansion,(sr_12,cr[!1 = @sid]))),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_1[s = sign(k_2[a_2 = sn_2,!1 = @sid_1],hash_ideal((cr[!1 = @sid],sr_12,StrongDH,G))),e = G,xxx = k_2[a_2 = sn_2,!1 = @sid_1],sn = sn_2,p = pk(k_2[a_2 = sn_2,!1 = @sid_1]),mode = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),sr = sr_12,offer = m_11,!1 = @sid])),master_secret,(cr[!1 = @sid],sr_12)),server_key_expansion,(sr_12,cr[!1 = @sid]))),tls12_prf(tls12_prf(e2b(dh_ideal(G,x_1[s = sign(k_2[a_2 = sn_2,!1 = @sid_1],hash_ideal((cr[!1 = @sid],sr_12,StrongDH,G))),e = G,xxx = k_2[a_2 = sn_2,!1 = @sid_1],sn = sn_2,p = pk(k_2[a_2 = sn_2,!1 = @sid_1]),mode = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),sr = sr_12,offer = m_11,!1 = @sid])),master_secret,(cr[!1 = @sid],sr_12)),client_finished,((((CH(cr[!1 = @sid],m_11),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_2[a_2 = sn_2,!1 = @sid_1]))),SKE(StrongDH,G,sign(k_2[a_2 = sn_2,!1 = @sid_1],hash_ideal((cr[!1 = @sid],sr_12,StrongDH,G))))),CKE(e2b(dh_ideal(G,x_1[s = sign(k_2[a_2 = sn_2,!1 = @sid_1],hash_ideal((cr[!1 = @sid],sr_12,StrongDH,G))),e = G,xxx = k_2[a_2 = sn_2,!1 = @sid_1],sn = sn_2,p = pk(k_2[a_2 = sn_2,!1 = @sid_1]),mode = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),sr = sr_12,offer = m_11,!1 = @sid]))))),tls12_prf(e2b(dh_ideal(G,x_1[s = sign(k_2[a_2 = sn_2,!1 = @sid_1],hash_ideal((cr[!1 = @sid],sr_12,StrongDH,G))),e = G,xxx = k_2[a_2 = sn_2,!1 = @sid_1],sn = sn_2,p = pk(k_2[a_2 = sn_2,!1 = @sid_1]),mode = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),sr = sr_12,offer = m_11,!1 = @sid])),master_secret,(cr[!1 = @sid],sr_12))))
This clause still contradicts the query.
A more detailed output of the traces is available with
  set traceDisplay = long.

event WeakOrCompromisedKey(NoPubKey) at {103} in copy a_14

new cr: random creating cr_18 at {2} in copy a_15

in(io, a_16) at {3} in copy a_15

out(io, CH(~M,~M_1)) with ~M = cr_18, ~M_1 = a_16 at {4} in copy a_15

in(io, SH(a_17,nego(TLS12,DHE(StrongDH),StrongHash,a_18,a_19))) at {5} in copy a_15

in(io, CH(a_20,a_21)) at {47} in copy a_22

in(io, SH(a_23,nego(TLS12,RSA(WeakRSADecryption),a_24,a_25,a_26))) at {48} in copy a_22

new sr_1: random creating sr_13 at {51} in copy a_22

out(io, SH(~M_2,nego(~M_3,RSA(~M_4),~M_5,~M_6,~M_7))) with ~M_2 = sr_13, ~M_3 = TLS12, ~M_4 = WeakRSADecryption, ~M_5 = a_24, ~M_6 = a_25, ~M_7 = a_26 at {52} in copy a_22

in(io, a_27) at {104} in copy a_14

new k_2: privkey creating k_4 at {105} in copy a_14

insert longTermKeys_tbl(a_27,k_4,pk(k_4)) at {106} in copy a_14

out(io, ~M_8) with ~M_8 = pk(k_4) at {107} in copy a_14

in(io, CRT(~M_8)) with ~M_8 = pk(k_4) at {9} in copy a_15

get longTermKeys_tbl(a_27,k_4,pk(k_4)) at {45} in copy a_15

get longTermKeys_tbl(a_27,k_4,pk(k_4)) at {101} in copy a_22

event ServerChoosesVersion(a_20,sr_13,pk(k_4),TLS12) at {54} in copy a_22

event ServerChoosesKEX(a_20,sr_13,pk(k_4),TLS12,RSA(WeakRSADecryption)) at {55} in copy a_22

event ServerChoosesAE(a_20,sr_13,pk(k_4),TLS12,a_25) at {56} in copy a_22

event ServerChoosesHash(a_20,sr_13,pk(k_4),TLS12,a_24) at {57} in copy a_22

out(io, CRT(~M_9)) with ~M_9 = pk(k_4) at {58} in copy a_22

in(io, CKE(rsa_enc(~M_8,hash_ideal((~M,a_17,StrongDH,G))))) with rsa_enc(~M_8,hash_ideal((~M,a_17,StrongDH,G))) = rsa_enc(pk(k_4),hash_ideal((cr_18,a_17,StrongDH,G))) at {84} in copy a_22

out(io, (~M_10,~M_11)) with ~M_10 = hash_ideal((cr_18,a_17,StrongDH,G)), ~M_11 = sign(k_4,hash_ideal((cr_18,a_17,StrongDH,G))) at {87} in copy a_22

in(io, SKE(StrongDH,G,~M_11)) with ~M_11 = sign(k_4,hash_ideal((cr_18,a_17,StrongDH,G))) at {12} in copy a_15

new x_1: bitstring creating x_4 at {15} in copy a_15

out(io, CKE(e2b(~M_12))) with ~M_12 = dh_ideal(G,x_4) at {20} in copy a_15

out(io, FIN(~M_13)) with ~M_13 = tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,a_17)),client_finished,((((CH(cr_18,a_16),SH(a_17,nego(TLS12,DHE(StrongDH),StrongHash,a_18,a_19))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,a_17,StrongDH,G))))),CKE(e2b(dh_ideal(G,x_4))))) at {23} in copy a_15

in(io, FIN(tls12_prf(tls12_prf(e2b(~M_12),master_secret,(~M,a_17)),server_finished,(((((CH(~M,a_16),SH(a_17,nego(TLS12,DHE(StrongDH),StrongHash,a_18,a_19))),CRT(~M_8)),SKE(StrongDH,G,~M_11)),CKE(e2b(~M_12))),FIN(tls12_prf(tls12_prf(e2b(~M_12),master_secret,(~M,a_17)),client_finished,((((CH(~M,a_16),SH(a_17,nego(TLS12,DHE(StrongDH),StrongHash,a_18,a_19))),CRT(~M_8)),SKE(StrongDH,G,~M_11)),CKE(e2b(~M_12))))))))) with tls12_prf(tls12_prf(e2b(~M_12),master_secret,(~M,a_17)),server_finished,(((((CH(~M,a_16),SH(a_17,nego(TLS12,DHE(StrongDH),StrongHash,a_18,a_19))),CRT(~M_8)),SKE(StrongDH,G,~M_11)),CKE(e2b(~M_12))),FIN(tls12_prf(tls12_prf(e2b(~M_12),master_secret,(~M,a_17)),client_finished,((((CH(~M,a_16),SH(a_17,nego(TLS12,DHE(StrongDH),StrongHash,a_18,a_19))),CRT(~M_8)),SKE(StrongDH,G,~M_11)),CKE(e2b(~M_12))))))) = tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,a_17)),server_finished,(((((CH(cr_18,a_16),SH(a_17,nego(TLS12,DHE(StrongDH),StrongHash,a_18,a_19))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,a_17,StrongDH,G))))),CKE(e2b(dh_ideal(G,x_4)))),FIN(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,a_17)),client_finished,((((CH(cr_18,a_16),SH(a_17,nego(TLS12,DHE(StrongDH),StrongHash,a_18,a_19))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,a_17,StrongDH,G))))),CKE(e2b(dh_ideal(G,x_4)))))))) at {25} in copy a_15

event ClientFinished(TLS12,cr_18,a_17,NoPSK,pk(k_4),a_16,nego(TLS12,DHE(StrongDH),StrongHash,a_18,a_19),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,a_17)),client_key_expansion,(a_17,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,a_17)),server_key_expansion,(a_17,cr_18))),tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,a_17)),client_finished,((((CH(cr_18,a_16),SH(a_17,nego(TLS12,DHE(StrongDH),StrongHash,a_18,a_19))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,a_17,StrongDH,G))))),CKE(e2b(dh_ideal(G,x_4))))),tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,a_17))) at {29} in copy a_15 (goal)

The event ClientFinished(TLS12,cr_18,a_17,NoPSK,pk(k_4),a_16,nego(TLS12,DHE(StrongDH),StrongHash,a_18,a_19),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,a_17)),client_key_expansion,(a_17,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,a_17)),server_key_expansion,(a_17,cr_18))),tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,a_17)),client_finished,((((CH(cr_18,a_16),SH(a_17,nego(TLS12,DHE(StrongDH),StrongHash,a_18,a_19))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,a_17,StrongDH,G))))),CKE(e2b(dh_ideal(G,x_4))))),tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,a_17))) is executed at {29} in copy a_15.
A trace has been found.
RESULT event(ClientFinished(TLS12,cr_18,sr_12,psk_16,p_7,m_10,o_16,ck_12,sk_8,cb_5,ms_9)) ==> event(ServerFinished(TLS12,cr_18,sr_12,psk_16,p_7,m_10,o_16,ck_12,sk_8,cb_5,ms_9)) is false.
-- Query event(ClientFinished(TLS13,cr_18,sr_12,psk_16,p_7,m_10,o_16,ck_12,sk_8,cb_5,ms_9)) ==> event(PreServerFinished(TLS13,cr_18,sr_12,psk_16,p_7,m_10,o_16,ck_12,sk_8,cb_5)) in process 0.
Completing...
200 rules inserted. The rule base contains 200 rules. 139 rules in the queue.
400 rules inserted. The rule base contains 396 rules. 77 rules in the queue.
600 rules inserted. The rule base contains 520 rules. 150 rules in the queue.
800 rules inserted. The rule base contains 582 rules. 181 rules in the queue.
1000 rules inserted. The rule base contains 630 rules. 207 rules in the queue.
1200 rules inserted. The rule base contains 681 rules. 226 rules in the queue.
1400 rules inserted. The rule base contains 753 rules. 263 rules in the queue.
1600 rules inserted. The rule base contains 803 rules. 266 rules in the queue.
1800 rules inserted. The rule base contains 831 rules. 248 rules in the queue.
2000 rules inserted. The rule base contains 893 rules. 245 rules in the queue.
2200 rules inserted. The rule base contains 944 rules. 254 rules in the queue.
2400 rules inserted. The rule base contains 1033 rules. 263 rules in the queue.
2600 rules inserted. The rule base contains 1120 rules. 301 rules in the queue.
2800 rules inserted. The rule base contains 1212 rules. 270 rules in the queue.
3000 rules inserted. The rule base contains 1320 rules. 252 rules in the queue.
3200 rules inserted. The rule base contains 1442 rules. 253 rules in the queue.
3400 rules inserted. The rule base contains 1524 rules. 220 rules in the queue.
3600 rules inserted. The rule base contains 1614 rules. 168 rules in the queue.
3800 rules inserted. The rule base contains 1614 rules. 132 rules in the queue.
4000 rules inserted. The rule base contains 1593 rules. 67 rules in the queue.
4200 rules inserted. The rule base contains 1700 rules. 17 rules in the queue.
Starting query event(ClientFinished(TLS13,cr_18,sr_12,psk_16,p_7,m_10,o_16,ck_12,sk_8,cb_5,ms_9)) ==> event(PreServerFinished(TLS13,cr_18,sr_12,psk_16,p_7,m_10,o_16,ck_12,sk_8,cb_5))
RESULT event(ClientFinished(TLS13,cr_18,sr_12,psk_16,p_7,m_10,o_16,ck_12,sk_8,cb_5,ms_9)) ==> event(PreServerFinished(TLS13,cr_18,sr_12,psk_16,p_7,m_10,o_16,ck_12,sk_8,cb_5)) is true.
-- Query not event(ServerFinished(TLS12,cr_18,sr_12,psk_16,p_7,m_10,o_16,ck_12,sk_8,cb_5,ms_9)) in process 0.
Completing...
200 rules inserted. The rule base contains 200 rules. 140 rules in the queue.
400 rules inserted. The rule base contains 396 rules. 78 rules in the queue.
600 rules inserted. The rule base contains 510 rules. 164 rules in the queue.
800 rules inserted. The rule base contains 574 rules. 199 rules in the queue.
1000 rules inserted. The rule base contains 620 rules. 227 rules in the queue.
1200 rules inserted. The rule base contains 655 rules. 246 rules in the queue.
1400 rules inserted. The rule base contains 727 rules. 294 rules in the queue.
1600 rules inserted. The rule base contains 775 rules. 269 rules in the queue.
1800 rules inserted. The rule base contains 827 rules. 275 rules in the queue.
2000 rules inserted. The rule base contains 841 rules. 270 rules in the queue.
2200 rules inserted. The rule base contains 895 rules. 229 rules in the queue.
2400 rules inserted. The rule base contains 966 rules. 234 rules in the queue.
2600 rules inserted. The rule base contains 1056 rules. 238 rules in the queue.
2800 rules inserted. The rule base contains 1149 rules. 226 rules in the queue.
3000 rules inserted. The rule base contains 1253 rules. 221 rules in the queue.
3200 rules inserted. The rule base contains 1378 rules. 210 rules in the queue.
3400 rules inserted. The rule base contains 1466 rules. 173 rules in the queue.
3600 rules inserted. The rule base contains 1518 rules. 112 rules in the queue.
3800 rules inserted. The rule base contains 1473 rules. 45 rules in the queue.
4000 rules inserted. The rule base contains 1606 rules. 18 rules in the queue.
Starting query not event(ServerFinished(TLS12,cr_18,sr_12,psk_16,p_7,m_10,o_16,ck_12,sk_8,cb_5,ms_9))
goal reachable: attacker(sn_2) && attacker(xxx_2) && attacker(a_13) && attacker(pt_9) && attacker(m_10) -> end(ServerFinished(TLS12,cr_18,sr_12,NoPSK,pk(k_4),m_10,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),client_key_expansion,(sr_12,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),server_key_expansion,(sr_12,cr_18))),tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,dh_ideal(G,x_4),sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4)))))),CKE(e2b(dh_ideal(G,x_5))))),tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12))))
Abbreviations:
cr_18 = cr[!1 = @sid]
sr_12 = sr_1[mode_1 = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = m_10,cr_1 = cr_18,!1 = @sid_1]
k_4 = k_2[a_2 = sn_2,!1 = @sid_2]
x_4 = x_3[p_1 = pk(k_4),sk_2 = k_4,sn_1 = sn_2,mode_1 = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = m_10,cr_1 = cr_18,!1 = @sid_1]
x_5 = x_1[s = sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4)))),e = dh_ideal(G,x_4),xxx = k_4,sn = sn_2,p = pk(k_4),mode = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),sr = sr_12,offer = m_10,!1 = @sid]

Derivation:
Abbreviations:
cr_18 = cr[!1 = @sid]
sr_12 = sr_1[mode_1 = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = m_10,cr_1 = cr_18,!1 = @sid_1]
k_4 = k_2[a_2 = sn_2,!1 = @sid_2]
x_4 = x_3[p_1 = pk(k_4),sk_2 = k_4,sn_1 = sn_2,mode_1 = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = m_10,cr_1 = cr_18,!1 = @sid_1]
x_5 = x_1[s = sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4)))),e = dh_ideal(G,x_4),xxx = k_4,sn = sn_2,p = pk(k_4),mode = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),sr = sr_12,offer = m_10,!1 = @sid]

1. We assume as hypothesis that
attacker(m_10).

2. The attacker has some term offer_2.
attacker(offer_2).

3. The message offer_2 that the attacker may have by 2 may be received at input {3}.
So the message CH(cr_18,offer_2) may be sent to the attacker at output {4}.
attacker(CH(cr_18,offer_2)).

4. By 3, the attacker may know CH(cr_18,offer_2).
Using the function 1-proj-CH the attacker may obtain cr_18.
attacker(cr_18).

5. By 4, the attacker may know cr_18.
By 1, the attacker may know m_10.
Using the function CH the attacker may obtain CH(cr_18,m_10).
attacker(CH(cr_18,m_10)).

6. We assume as hypothesis that
attacker(pt_9).

7. We assume as hypothesis that
attacker(a_13).

8. Using the function StrongHash the attacker may obtain StrongHash.
attacker(StrongHash).

9. Using the function StrongDH the attacker may obtain StrongDH.
attacker(StrongDH).

10. By 9, the attacker may know StrongDH.
Using the function DHE the attacker may obtain DHE(StrongDH).
attacker(DHE(StrongDH)).

11. Using the function TLS12 the attacker may obtain TLS12.
attacker(TLS12).

12. By 11, the attacker may know TLS12.
By 10, the attacker may know DHE(StrongDH).
By 8, the attacker may know StrongHash.
By 7, the attacker may know a_13.
By 6, the attacker may know pt_9.
Using the function nego the attacker may obtain nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9).
attacker(nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9)).

13. We assume as hypothesis that
attacker(xxx_2).

14. By 13, the attacker may know xxx_2.
By 12, the attacker may know nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9).
Using the function SH the attacker may obtain SH(xxx_2,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9)).
attacker(SH(xxx_2,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))).

15. We assume as hypothesis that
attacker(sn_2).

16. The message sn_2 that the attacker may have by 15 may be received at input {104}.
So the entry longTermKeys_tbl(sn_2,k_4,pk(k_4)) may be inserted in a table at insert {106}.
table(longTermKeys_tbl(sn_2,k_4,pk(k_4))).

17. The message CH(cr_18,m_10) that the attacker may have by 5 may be received at input {47}.
The message SH(xxx_2,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9)) that the attacker may have by 14 may be received at input {48}.
So the message SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9)) may be sent to the attacker at output {52}.
attacker(SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))).

18. By 17, the attacker may know SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9)).
Using the function 1-proj-SH the attacker may obtain sr_12.
attacker(sr_12).

19. By 18, the attacker may know sr_12.
By 12, the attacker may know nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9).
Using the function SH the attacker may obtain SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9)).
attacker(SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))).

20. The message sn_2 that the attacker may have by 15 may be received at input {104}.
So the message pk(k_4) may be sent to the attacker at output {107}.
attacker(pk(k_4)).

21. By 20, the attacker may know pk(k_4).
Using the function CRT the attacker may obtain CRT(pk(k_4)).
attacker(CRT(pk(k_4))).

22. The message CH(cr_18,m_10) that the attacker may have by 5 may be received at input {47}.
The message SH(xxx_2,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9)) that the attacker may have by 14 may be received at input {48}.
The entry longTermKeys_tbl(sn_2,k_4,pk(k_4)) that may be in a table by 16 may be read at get {101}.
So the message SKE(StrongDH,dh_ideal(G,x_4),sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4))))) may be sent to the attacker at output {65}.
attacker(SKE(StrongDH,dh_ideal(G,x_4),sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4)))))).

23. By 22, the attacker may know SKE(StrongDH,dh_ideal(G,x_4),sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4))))).
Using the function 3-proj-SKE the attacker may obtain sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4)))).
attacker(sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4))))).

24. By 22, the attacker may know SKE(StrongDH,dh_ideal(G,x_4),sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4))))).
Using the function 2-proj-SKE the attacker may obtain dh_ideal(G,x_4).
attacker(dh_ideal(G,x_4)).

25. By 9, the attacker may know StrongDH.
By 24, the attacker may know dh_ideal(G,x_4).
By 23, the attacker may know sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4)))).
Using the function SKE the attacker may obtain SKE(StrongDH,dh_ideal(G,x_4),sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4))))).
attacker(SKE(StrongDH,dh_ideal(G,x_4),sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4)))))).

26. The message m_10 that the attacker may have by 1 may be received at input {3}.
The message SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9)) that the attacker may have by 19 may be received at input {5}.
The message CRT(pk(k_4)) that the attacker may have by 21 may be received at input {9}.
The entry longTermKeys_tbl(sn_2,k_4,pk(k_4)) that may be in a table by 16 may be read at get {45}.
The message SKE(StrongDH,dh_ideal(G,x_4),sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4))))) that the attacker may have by 25 may be received at input {12}.
We have dh_ideal(G,x_4) ≠ BadElement.
So the message CKE(e2b(dh_ideal(G,x_5))) may be sent to the attacker at output {20}.
attacker(CKE(e2b(dh_ideal(G,x_5)))).

27. By 26, the attacker may know CKE(e2b(dh_ideal(G,x_5))).
Using the function 1-proj-CKE the attacker may obtain e2b(dh_ideal(G,x_5)).
attacker(e2b(dh_ideal(G,x_5))).

28. By 27, the attacker may know e2b(dh_ideal(G,x_5)).
Using the function 1-proj-e2b the attacker may obtain dh_ideal(G,x_5).
attacker(dh_ideal(G,x_5)).

29. By 28, the attacker may know dh_ideal(G,x_5).
Using the function e2b the attacker may obtain e2b(dh_ideal(G,x_5)).
attacker(e2b(dh_ideal(G,x_5))).

30. By 29, the attacker may know e2b(dh_ideal(G,x_5)).
Using the function CKE the attacker may obtain CKE(e2b(dh_ideal(G,x_5))).
attacker(CKE(e2b(dh_ideal(G,x_5)))).

31. The message m_10 that the attacker may have by 1 may be received at input {3}.
The message SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9)) that the attacker may have by 19 may be received at input {5}.
The message CRT(pk(k_4)) that the attacker may have by 21 may be received at input {9}.
The entry longTermKeys_tbl(sn_2,k_4,pk(k_4)) that may be in a table by 16 may be read at get {45}.
The message SKE(StrongDH,dh_ideal(G,x_4),sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4))))) that the attacker may have by 25 may be received at input {12}.
We have dh_ideal(G,x_4) ≠ BadElement.
So the message FIN(tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,dh_ideal(G,x_4),sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4)))))),CKE(e2b(dh_ideal(G,x_5)))))) may be sent to the attacker at output {23}.
attacker(FIN(tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,dh_ideal(G,x_4),sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4)))))),CKE(e2b(dh_ideal(G,x_5))))))).

32. By 31, the attacker may know FIN(tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,dh_ideal(G,x_4),sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4)))))),CKE(e2b(dh_ideal(G,x_5)))))).
Using the function 1-proj-FIN the attacker may obtain tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,dh_ideal(G,x_4),sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4)))))),CKE(e2b(dh_ideal(G,x_5))))).
attacker(tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,dh_ideal(G,x_4),sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4)))))),CKE(e2b(dh_ideal(G,x_5)))))).

33. By 32, the attacker may know tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,dh_ideal(G,x_4),sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4)))))),CKE(e2b(dh_ideal(G,x_5))))).
Using the function FIN the attacker may obtain FIN(tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,dh_ideal(G,x_4),sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4)))))),CKE(e2b(dh_ideal(G,x_5)))))).
attacker(FIN(tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,dh_ideal(G,x_4),sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4)))))),CKE(e2b(dh_ideal(G,x_5))))))).

34. The message CH(cr_18,m_10) that the attacker may have by 5 may be received at input {47}.
The message SH(xxx_2,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9)) that the attacker may have by 14 may be received at input {48}.
The entry longTermKeys_tbl(sn_2,k_4,pk(k_4)) that may be in a table by 16 may be read at get {101}.
The message CKE(e2b(dh_ideal(G,x_5))) that the attacker may have by 30 may be received at input {67}.
The message FIN(tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,dh_ideal(G,x_4),sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4)))))),CKE(e2b(dh_ideal(G,x_5)))))) that the attacker may have by 33 may be received at input {71}.
So event ServerFinished(TLS12,cr_18,sr_12,NoPSK,pk(k_4),m_10,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),client_key_expansion,(sr_12,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),server_key_expansion,(sr_12,cr_18))),tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,dh_ideal(G,x_4),sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4)))))),CKE(e2b(dh_ideal(G,x_5))))),tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12))) may be executed at {77}.
end(ServerFinished(TLS12,cr_18,sr_12,NoPSK,pk(k_4),m_10,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),client_key_expansion,(sr_12,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),server_key_expansion,(sr_12,cr_18))),tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,dh_ideal(G,x_4),sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4)))))),CKE(e2b(dh_ideal(G,x_5))))),tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)))).

35. By 34, end(ServerFinished(TLS12,cr_18,sr_12,NoPSK,pk(k_4),m_10,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),client_key_expansion,(sr_12,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),server_key_expansion,(sr_12,cr_18))),tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,dh_ideal(G,x_4),sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4)))))),CKE(e2b(dh_ideal(G,x_5))))),tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)))).
The goal is reached, represented in the following fact:
end(ServerFinished(TLS12,cr_18,sr_12,NoPSK,pk(k_4),m_10,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),client_key_expansion,(sr_12,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),server_key_expansion,(sr_12,cr_18))),tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,dh_ideal(G,x_4),sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4)))))),CKE(e2b(dh_ideal(G,x_5))))),tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)))).


Unified offer_2 with m_10
Iterating unifyDerivation.
Fixpoint reached: nothing more to unify.
The clause after unifyDerivation is
attacker(m_11) && attacker(pt_9) && attacker(a_13) && attacker(xxx_2) && attacker(sn_2) -> end(ServerFinished(TLS12,cr[!1 = @sid],sr_1[mode_1 = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = m_11,cr_1 = cr[!1 = @sid],!1 = @sid_1],NoPSK,pk(k_2[a_2 = sn_2,!1 = @sid_2]),m_11,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_3[p_1 = pk(k_2[a_2 = sn_2,!1 = @sid_2]),sk_2 = k_2[a_2 = sn_2,!1 = @sid_2],sn_1 = sn_2,mode_1 = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = m_11,cr_1 = cr[!1 = @sid],!1 = @sid_1]),x_1[s = sign(k_2[a_2 = sn_2,!1 = @sid_2],hash_ideal((cr[!1 = @sid],sr_1[mode_1 = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = m_11,cr_1 = cr[!1 = @sid],!1 = @sid_1],StrongDH,dh_ideal(G,x_3[p_1 = pk(k_2[a_2 = sn_2,!1 = @sid_2]),sk_2 = k_2[a_2 = sn_2,!1 = @sid_2],sn_1 = sn_2,mode_1 = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = m_11,cr_1 = cr[!1 = @sid],!1 = @sid_1])))),e = dh_ideal(G,x_3[p_1 = pk(k_2[a_2 = sn_2,!1 = @sid_2]),sk_2 = k_2[a_2 = sn_2,!1 = @sid_2],sn_1 = sn_2,mode_1 = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = m_11,cr_1 = cr[!1 = @sid],!1 = @sid_1]),xxx = k_2[a_2 = sn_2,!1 = @sid_2],sn = sn_2,p = pk(k_2[a_2 = sn_2,!1 = @sid_2]),mode = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),sr = sr_1[mode_1 = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = m_11,cr_1 = cr[!1 = @sid],!1 = @sid_1],offer = m_11,!1 = @sid])),master_secret,(cr[!1 = @sid],sr_1[mode_1 = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = m_11,cr_1 = cr[!1 = @sid],!1 = @sid_1])),client_key_expansion,(sr_1[mode_1 = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = m_11,cr_1 = cr[!1 = @sid],!1 = @sid_1],cr[!1 = @sid]))),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_3[p_1 = pk(k_2[a_2 = sn_2,!1 = @sid_2]),sk_2 = k_2[a_2 = sn_2,!1 = @sid_2],sn_1 = sn_2,mode_1 = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = m_11,cr_1 = cr[!1 = @sid],!1 = @sid_1]),x_1[s = sign(k_2[a_2 = sn_2,!1 = @sid_2],hash_ideal((cr[!1 = @sid],sr_1[mode_1 = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = m_11,cr_1 = cr[!1 = @sid],!1 = @sid_1],StrongDH,dh_ideal(G,x_3[p_1 = pk(k_2[a_2 = sn_2,!1 = @sid_2]),sk_2 = k_2[a_2 = sn_2,!1 = @sid_2],sn_1 = sn_2,mode_1 = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = m_11,cr_1 = cr[!1 = @sid],!1 = @sid_1])))),e = dh_ideal(G,x_3[p_1 = pk(k_2[a_2 = sn_2,!1 = @sid_2]),sk_2 = k_2[a_2 = sn_2,!1 = @sid_2],sn_1 = sn_2,mode_1 = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = m_11,cr_1 = cr[!1 = @sid],!1 = @sid_1]),xxx = k_2[a_2 = sn_2,!1 = @sid_2],sn = sn_2,p = pk(k_2[a_2 = sn_2,!1 = @sid_2]),mode = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),sr = sr_1[mode_1 = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = m_11,cr_1 = cr[!1 = @sid],!1 = @sid_1],offer = m_11,!1 = @sid])),master_secret,(cr[!1 = @sid],sr_1[mode_1 = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = m_11,cr_1 = cr[!1 = @sid],!1 = @sid_1])),server_key_expansion,(sr_1[mode_1 = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = m_11,cr_1 = cr[!1 = @sid],!1 = @sid_1],cr[!1 = @sid]))),tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_3[p_1 = pk(k_2[a_2 = sn_2,!1 = @sid_2]),sk_2 = k_2[a_2 = sn_2,!1 = @sid_2],sn_1 = sn_2,mode_1 = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = m_11,cr_1 = cr[!1 = @sid],!1 = @sid_1]),x_1[s = sign(k_2[a_2 = sn_2,!1 = @sid_2],hash_ideal((cr[!1 = @sid],sr_1[mode_1 = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = m_11,cr_1 = cr[!1 = @sid],!1 = @sid_1],StrongDH,dh_ideal(G,x_3[p_1 = pk(k_2[a_2 = sn_2,!1 = @sid_2]),sk_2 = k_2[a_2 = sn_2,!1 = @sid_2],sn_1 = sn_2,mode_1 = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = m_11,cr_1 = cr[!1 = @sid],!1 = @sid_1])))),e = dh_ideal(G,x_3[p_1 = pk(k_2[a_2 = sn_2,!1 = @sid_2]),sk_2 = k_2[a_2 = sn_2,!1 = @sid_2],sn_1 = sn_2,mode_1 = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = m_11,cr_1 = cr[!1 = @sid],!1 = @sid_1]),xxx = k_2[a_2 = sn_2,!1 = @sid_2],sn = sn_2,p = pk(k_2[a_2 = sn_2,!1 = @sid_2]),mode = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),sr = sr_1[mode_1 = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = m_11,cr_1 = cr[!1 = @sid],!1 = @sid_1],offer = m_11,!1 = @sid])),master_secret,(cr[!1 = @sid],sr_1[mode_1 = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = m_11,cr_1 = cr[!1 = @sid],!1 = @sid_1])),client_finished,((((CH(cr[!1 = @sid],m_11),SH(sr_1[mode_1 = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = m_11,cr_1 = cr[!1 = @sid],!1 = @sid_1],nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_2[a_2 = sn_2,!1 = @sid_2]))),SKE(StrongDH,dh_ideal(G,x_3[p_1 = pk(k_2[a_2 = sn_2,!1 = @sid_2]),sk_2 = k_2[a_2 = sn_2,!1 = @sid_2],sn_1 = sn_2,mode_1 = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = m_11,cr_1 = cr[!1 = @sid],!1 = @sid_1]),sign(k_2[a_2 = sn_2,!1 = @sid_2],hash_ideal((cr[!1 = @sid],sr_1[mode_1 = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = m_11,cr_1 = cr[!1 = @sid],!1 = @sid_1],StrongDH,dh_ideal(G,x_3[p_1 = pk(k_2[a_2 = sn_2,!1 = @sid_2]),sk_2 = k_2[a_2 = sn_2,!1 = @sid_2],sn_1 = sn_2,mode_1 = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = m_11,cr_1 = cr[!1 = @sid],!1 = @sid_1])))))),CKE(e2b(dh_ideal(G,x_1[s = sign(k_2[a_2 = sn_2,!1 = @sid_2],hash_ideal((cr[!1 = @sid],sr_1[mode_1 = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = m_11,cr_1 = cr[!1 = @sid],!1 = @sid_1],StrongDH,dh_ideal(G,x_3[p_1 = pk(k_2[a_2 = sn_2,!1 = @sid_2]),sk_2 = k_2[a_2 = sn_2,!1 = @sid_2],sn_1 = sn_2,mode_1 = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = m_11,cr_1 = cr[!1 = @sid],!1 = @sid_1])))),e = dh_ideal(G,x_3[p_1 = pk(k_2[a_2 = sn_2,!1 = @sid_2]),sk_2 = k_2[a_2 = sn_2,!1 = @sid_2],sn_1 = sn_2,mode_1 = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = m_11,cr_1 = cr[!1 = @sid],!1 = @sid_1]),xxx = k_2[a_2 = sn_2,!1 = @sid_2],sn = sn_2,p = pk(k_2[a_2 = sn_2,!1 = @sid_2]),mode = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),sr = sr_1[mode_1 = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = m_11,cr_1 = cr[!1 = @sid],!1 = @sid_1],offer = m_11,!1 = @sid]))))),tls12_prf(e2b(dh_ideal(dh_ideal(G,x_3[p_1 = pk(k_2[a_2 = sn_2,!1 = @sid_2]),sk_2 = k_2[a_2 = sn_2,!1 = @sid_2],sn_1 = sn_2,mode_1 = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = m_11,cr_1 = cr[!1 = @sid],!1 = @sid_1]),x_1[s = sign(k_2[a_2 = sn_2,!1 = @sid_2],hash_ideal((cr[!1 = @sid],sr_1[mode_1 = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = m_11,cr_1 = cr[!1 = @sid],!1 = @sid_1],StrongDH,dh_ideal(G,x_3[p_1 = pk(k_2[a_2 = sn_2,!1 = @sid_2]),sk_2 = k_2[a_2 = sn_2,!1 = @sid_2],sn_1 = sn_2,mode_1 = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = m_11,cr_1 = cr[!1 = @sid],!1 = @sid_1])))),e = dh_ideal(G,x_3[p_1 = pk(k_2[a_2 = sn_2,!1 = @sid_2]),sk_2 = k_2[a_2 = sn_2,!1 = @sid_2],sn_1 = sn_2,mode_1 = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = m_11,cr_1 = cr[!1 = @sid],!1 = @sid_1]),xxx = k_2[a_2 = sn_2,!1 = @sid_2],sn = sn_2,p = pk(k_2[a_2 = sn_2,!1 = @sid_2]),mode = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),sr = sr_1[mode_1 = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = m_11,cr_1 = cr[!1 = @sid],!1 = @sid_1],offer = m_11,!1 = @sid])),master_secret,(cr[!1 = @sid],sr_1[mode_1 = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = m_11,cr_1 = cr[!1 = @sid],!1 = @sid_1]))))
This clause still contradicts the query.
A more detailed output of the traces is available with
  set traceDisplay = long.

event WeakOrCompromisedKey(NoPubKey) at {103} in copy a_14

new cr: random creating cr_18 at {2} in copy a_15

in(io, a_16) at {3} in copy a_15

out(io, CH(~M,~M_1)) with ~M = cr_18, ~M_1 = a_16 at {4} in copy a_15

in(io, CH(~M,a_16)) with ~M = cr_18 at {47} in copy a_17

in(io, SH(a_18,nego(TLS12,DHE(StrongDH),StrongHash,a_19,a_20))) at {48} in copy a_17

new sr_1: random creating sr_12 at {51} in copy a_17

out(io, SH(~M_2,nego(~M_3,DHE(StrongDH),StrongHash,~M_4,~M_5))) with ~M_2 = sr_12, ~M_3 = TLS12, ~M_4 = a_19, ~M_5 = a_20 at {52} in copy a_17

in(io, SH(~M_2,nego(TLS12,DHE(StrongDH),StrongHash,a_19,a_20))) with ~M_2 = sr_12 at {5} in copy a_15

in(io, a_21) at {104} in copy a_14

new k_2: privkey creating k_4 at {105} in copy a_14

insert longTermKeys_tbl(a_21,k_4,pk(k_4)) at {106} in copy a_14

out(io, ~M_6) with ~M_6 = pk(k_4) at {107} in copy a_14

in(io, CRT(~M_6)) with ~M_6 = pk(k_4) at {9} in copy a_15

get longTermKeys_tbl(a_21,k_4,pk(k_4)) at {45} in copy a_15

get longTermKeys_tbl(a_21,k_4,pk(k_4)) at {101} in copy a_17

event ServerChoosesVersion(cr_18,sr_12,pk(k_4),TLS12) at {54} in copy a_17

event ServerChoosesKEX(cr_18,sr_12,pk(k_4),TLS12,DHE(StrongDH)) at {55} in copy a_17

event ServerChoosesAE(cr_18,sr_12,pk(k_4),TLS12,a_19) at {56} in copy a_17

event ServerChoosesHash(cr_18,sr_12,pk(k_4),TLS12,StrongHash) at {57} in copy a_17

out(io, CRT(~M_7)) with ~M_7 = pk(k_4) at {58} in copy a_17

new x_3: bitstring creating x_4 at {61} in copy a_17

out(io, SKE(StrongDH,~M_8,~M_9)) with ~M_8 = dh_ideal(G,x_4), ~M_9 = sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4)))) at {65} in copy a_17

in(io, SKE(StrongDH,~M_8,~M_9)) with ~M_8 = dh_ideal(G,x_4), ~M_9 = sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4)))) at {12} in copy a_15

new x_1: bitstring creating x_5 at {15} in copy a_15

out(io, CKE(e2b(~M_10))) with ~M_10 = dh_ideal(G,x_5) at {20} in copy a_15

out(io, FIN(~M_11)) with ~M_11 = tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,a_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_19,a_20))),CRT(pk(k_4))),SKE(StrongDH,dh_ideal(G,x_4),sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4)))))),CKE(e2b(dh_ideal(G,x_5))))) at {23} in copy a_15

in(io, CKE(e2b(~M_10))) with ~M_10 = dh_ideal(G,x_5) at {67} in copy a_17

in(io, FIN(~M_11)) with ~M_11 = tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,a_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_19,a_20))),CRT(pk(k_4))),SKE(StrongDH,dh_ideal(G,x_4),sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4)))))),CKE(e2b(dh_ideal(G,x_5))))) at {71} in copy a_17

event ServerFinished(TLS12,cr_18,sr_12,NoPSK,pk(k_4),a_16,nego(TLS12,DHE(StrongDH),StrongHash,a_19,a_20),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_5),x_4)),master_secret,(cr_18,sr_12)),client_key_expansion,(sr_12,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_5),x_4)),master_secret,(cr_18,sr_12)),server_key_expansion,(sr_12,cr_18))),tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,a_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_19,a_20))),CRT(pk(k_4))),SKE(StrongDH,dh_ideal(G,x_4),sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4)))))),CKE(e2b(dh_ideal(G,x_5))))),tls12_prf(e2b(dh_ideal(dh_ideal(G,x_5),x_4)),master_secret,(cr_18,sr_12))) at {77} in copy a_17 (goal)

The event ServerFinished(TLS12,cr_18,sr_12,NoPSK,pk(k_4),a_16,nego(TLS12,DHE(StrongDH),StrongHash,a_19,a_20),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),client_key_expansion,(sr_12,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),server_key_expansion,(sr_12,cr_18))),tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,a_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_19,a_20))),CRT(pk(k_4))),SKE(StrongDH,dh_ideal(G,x_4),sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4)))))),CKE(e2b(dh_ideal(G,x_5))))),tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12))) is executed at {77} in copy a_17.
A trace has been found.
RESULT not event(ServerFinished(TLS12,cr_18,sr_12,psk_16,p_7,m_10,o_16,ck_12,sk_8,cb_5,ms_9)) is false.
-- Query not event(ClientFinished(TLS12,cr_18,sr_12,psk_16,p_7,m_10,o_16,ck_12,sk_8,cb_5,ms_9)) in process 0.
Completing...
200 rules inserted. The rule base contains 200 rules. 139 rules in the queue.
400 rules inserted. The rule base contains 396 rules. 77 rules in the queue.
600 rules inserted. The rule base contains 520 rules. 150 rules in the queue.
800 rules inserted. The rule base contains 582 rules. 181 rules in the queue.
1000 rules inserted. The rule base contains 630 rules. 207 rules in the queue.
1200 rules inserted. The rule base contains 681 rules. 226 rules in the queue.
1400 rules inserted. The rule base contains 753 rules. 263 rules in the queue.
1600 rules inserted. The rule base contains 803 rules. 266 rules in the queue.
1800 rules inserted. The rule base contains 831 rules. 248 rules in the queue.
2000 rules inserted. The rule base contains 893 rules. 245 rules in the queue.
2200 rules inserted. The rule base contains 944 rules. 254 rules in the queue.
2400 rules inserted. The rule base contains 1033 rules. 263 rules in the queue.
2600 rules inserted. The rule base contains 1120 rules. 301 rules in the queue.
2800 rules inserted. The rule base contains 1212 rules. 270 rules in the queue.
3000 rules inserted. The rule base contains 1320 rules. 252 rules in the queue.
3200 rules inserted. The rule base contains 1442 rules. 253 rules in the queue.
3400 rules inserted. The rule base contains 1524 rules. 220 rules in the queue.
3600 rules inserted. The rule base contains 1614 rules. 168 rules in the queue.
3800 rules inserted. The rule base contains 1614 rules. 132 rules in the queue.
4000 rules inserted. The rule base contains 1593 rules. 67 rules in the queue.
4200 rules inserted. The rule base contains 1700 rules. 17 rules in the queue.
Starting query not event(ClientFinished(TLS12,cr_18,sr_12,psk_16,p_7,m_10,o_16,ck_12,sk_8,cb_5,ms_9))
goal reachable: attacker(sn_2) && attacker(xxx_2) && attacker(a_13) && attacker(pt_9) && attacker(m_10) -> end(ClientFinished(TLS12,cr_18,sr_12,NoPSK,pk(k_4),m_10,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),client_key_expansion,(sr_12,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),server_key_expansion,(sr_12,cr_18))),tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,dh_ideal(G,x_4),sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4)))))),CKE(e2b(dh_ideal(G,x_5))))),tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12))))
Abbreviations:
cr_18 = cr[!1 = @sid]
sr_12 = sr_1[mode_1 = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = m_10,cr_1 = cr_18,!1 = @sid_1]
k_4 = k_2[a_2 = sn_2,!1 = @sid_2]
x_4 = x_3[p_1 = pk(k_4),sk_2 = k_4,sn_1 = sn_2,mode_1 = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = m_10,cr_1 = cr_18,!1 = @sid_1]
x_5 = x_1[s = sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4)))),e = dh_ideal(G,x_4),xxx = k_4,sn = sn_2,p = pk(k_4),mode = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),sr = sr_12,offer = m_10,!1 = @sid]

Derivation:
Abbreviations:
cr_18 = cr[!1 = @sid]
sr_12 = sr_1[mode_1 = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = m_10,cr_1 = cr_18,!1 = @sid_1]
k_4 = k_2[a_2 = sn_2,!1 = @sid_2]
x_4 = x_3[p_1 = pk(k_4),sk_2 = k_4,sn_1 = sn_2,mode_1 = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = m_10,cr_1 = cr_18,!1 = @sid_1]
x_5 = x_1[s = sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4)))),e = dh_ideal(G,x_4),xxx = k_4,sn = sn_2,p = pk(k_4),mode = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),sr = sr_12,offer = m_10,!1 = @sid]

1. We assume as hypothesis that
attacker(m_10).

2. We assume as hypothesis that
attacker(pt_9).

3. We assume as hypothesis that
attacker(a_13).

4. Using the function StrongHash the attacker may obtain StrongHash.
attacker(StrongHash).

5. Using the function StrongDH the attacker may obtain StrongDH.
attacker(StrongDH).

6. By 5, the attacker may know StrongDH.
Using the function DHE the attacker may obtain DHE(StrongDH).
attacker(DHE(StrongDH)).

7. Using the function TLS12 the attacker may obtain TLS12.
attacker(TLS12).

8. By 7, the attacker may know TLS12.
By 6, the attacker may know DHE(StrongDH).
By 4, the attacker may know StrongHash.
By 3, the attacker may know a_13.
By 2, the attacker may know pt_9.
Using the function nego the attacker may obtain nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9).
attacker(nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9)).

9. The attacker has some term offer_2.
attacker(offer_2).

10. The message offer_2 that the attacker may have by 9 may be received at input {3}.
So the message CH(cr_18,offer_2) may be sent to the attacker at output {4}.
attacker(CH(cr_18,offer_2)).

11. By 10, the attacker may know CH(cr_18,offer_2).
Using the function 1-proj-CH the attacker may obtain cr_18.
attacker(cr_18).

12. By 11, the attacker may know cr_18.
By 1, the attacker may know m_10.
Using the function CH the attacker may obtain CH(cr_18,m_10).
attacker(CH(cr_18,m_10)).

13. We assume as hypothesis that
attacker(xxx_2).

14. By 13, the attacker may know xxx_2.
By 8, the attacker may know nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9).
Using the function SH the attacker may obtain SH(xxx_2,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9)).
attacker(SH(xxx_2,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))).

15. The message CH(cr_18,m_10) that the attacker may have by 12 may be received at input {47}.
The message SH(xxx_2,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9)) that the attacker may have by 14 may be received at input {48}.
So the message SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9)) may be sent to the attacker at output {52}.
attacker(SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))).

16. By 15, the attacker may know SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9)).
Using the function 1-proj-SH the attacker may obtain sr_12.
attacker(sr_12).

17. By 16, the attacker may know sr_12.
By 8, the attacker may know nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9).
Using the function SH the attacker may obtain SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9)).
attacker(SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))).

18. We assume as hypothesis that
attacker(sn_2).

19. The message sn_2 that the attacker may have by 18 may be received at input {104}.
So the message pk(k_4) may be sent to the attacker at output {107}.
attacker(pk(k_4)).

20. By 19, the attacker may know pk(k_4).
Using the function CRT the attacker may obtain CRT(pk(k_4)).
attacker(CRT(pk(k_4))).

21. The message sn_2 that the attacker may have by 18 may be received at input {104}.
So the entry longTermKeys_tbl(sn_2,k_4,pk(k_4)) may be inserted in a table at insert {106}.
table(longTermKeys_tbl(sn_2,k_4,pk(k_4))).

22. The message CH(cr_18,m_10) that the attacker may have by 12 may be received at input {47}.
The message SH(xxx_2,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9)) that the attacker may have by 14 may be received at input {48}.
The entry longTermKeys_tbl(sn_2,k_4,pk(k_4)) that may be in a table by 21 may be read at get {101}.
So the message SKE(StrongDH,dh_ideal(G,x_4),sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4))))) may be sent to the attacker at output {65}.
attacker(SKE(StrongDH,dh_ideal(G,x_4),sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4)))))).

23. By 22, the attacker may know SKE(StrongDH,dh_ideal(G,x_4),sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4))))).
Using the function 3-proj-SKE the attacker may obtain sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4)))).
attacker(sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4))))).

24. By 22, the attacker may know SKE(StrongDH,dh_ideal(G,x_4),sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4))))).
Using the function 2-proj-SKE the attacker may obtain dh_ideal(G,x_4).
attacker(dh_ideal(G,x_4)).

25. By 5, the attacker may know StrongDH.
By 24, the attacker may know dh_ideal(G,x_4).
By 23, the attacker may know sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4)))).
Using the function SKE the attacker may obtain SKE(StrongDH,dh_ideal(G,x_4),sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4))))).
attacker(SKE(StrongDH,dh_ideal(G,x_4),sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4)))))).

26. The message m_10 that the attacker may have by 1 may be received at input {3}.
The message SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9)) that the attacker may have by 17 may be received at input {5}.
The message CRT(pk(k_4)) that the attacker may have by 20 may be received at input {9}.
The entry longTermKeys_tbl(sn_2,k_4,pk(k_4)) that may be in a table by 21 may be read at get {45}.
The message SKE(StrongDH,dh_ideal(G,x_4),sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4))))) that the attacker may have by 25 may be received at input {12}.
We have dh_ideal(G,x_4) ≠ BadElement.
So the message CKE(e2b(dh_ideal(G,x_5))) may be sent to the attacker at output {20}.
attacker(CKE(e2b(dh_ideal(G,x_5)))).

27. By 26, the attacker may know CKE(e2b(dh_ideal(G,x_5))).
Using the function 1-proj-CKE the attacker may obtain e2b(dh_ideal(G,x_5)).
attacker(e2b(dh_ideal(G,x_5))).

28. By 27, the attacker may know e2b(dh_ideal(G,x_5)).
Using the function 1-proj-e2b the attacker may obtain dh_ideal(G,x_5).
attacker(dh_ideal(G,x_5)).

29. By 28, the attacker may know dh_ideal(G,x_5).
Using the function e2b the attacker may obtain e2b(dh_ideal(G,x_5)).
attacker(e2b(dh_ideal(G,x_5))).

30. By 29, the attacker may know e2b(dh_ideal(G,x_5)).
Using the function CKE the attacker may obtain CKE(e2b(dh_ideal(G,x_5))).
attacker(CKE(e2b(dh_ideal(G,x_5)))).

31. The message m_10 that the attacker may have by 1 may be received at input {3}.
The message SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9)) that the attacker may have by 17 may be received at input {5}.
The message CRT(pk(k_4)) that the attacker may have by 20 may be received at input {9}.
The entry longTermKeys_tbl(sn_2,k_4,pk(k_4)) that may be in a table by 21 may be read at get {45}.
The message SKE(StrongDH,dh_ideal(G,x_4),sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4))))) that the attacker may have by 25 may be received at input {12}.
We have dh_ideal(G,x_4) ≠ BadElement.
So the message FIN(tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,dh_ideal(G,x_4),sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4)))))),CKE(e2b(dh_ideal(G,x_5)))))) may be sent to the attacker at output {23}.
attacker(FIN(tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,dh_ideal(G,x_4),sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4)))))),CKE(e2b(dh_ideal(G,x_5))))))).

32. By 31, the attacker may know FIN(tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,dh_ideal(G,x_4),sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4)))))),CKE(e2b(dh_ideal(G,x_5)))))).
Using the function 1-proj-FIN the attacker may obtain tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,dh_ideal(G,x_4),sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4)))))),CKE(e2b(dh_ideal(G,x_5))))).
attacker(tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,dh_ideal(G,x_4),sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4)))))),CKE(e2b(dh_ideal(G,x_5)))))).

33. By 32, the attacker may know tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,dh_ideal(G,x_4),sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4)))))),CKE(e2b(dh_ideal(G,x_5))))).
Using the function FIN the attacker may obtain FIN(tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,dh_ideal(G,x_4),sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4)))))),CKE(e2b(dh_ideal(G,x_5)))))).
attacker(FIN(tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,dh_ideal(G,x_4),sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4)))))),CKE(e2b(dh_ideal(G,x_5))))))).

34. The message CH(cr_18,m_10) that the attacker may have by 12 may be received at input {47}.
The message SH(xxx_2,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9)) that the attacker may have by 14 may be received at input {48}.
The entry longTermKeys_tbl(sn_2,k_4,pk(k_4)) that may be in a table by 21 may be read at get {101}.
The message CKE(e2b(dh_ideal(G,x_5))) that the attacker may have by 30 may be received at input {67}.
The message FIN(tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,dh_ideal(G,x_4),sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4)))))),CKE(e2b(dh_ideal(G,x_5)))))) that the attacker may have by 33 may be received at input {71}.
So the message FIN(tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),server_finished,(((((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,dh_ideal(G,x_4),sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4)))))),CKE(e2b(dh_ideal(G,x_5)))),FIN(tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,dh_ideal(G,x_4),sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4)))))),CKE(e2b(dh_ideal(G,x_5))))))))) may be sent to the attacker at output {78}.
attacker(FIN(tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),server_finished,(((((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,dh_ideal(G,x_4),sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4)))))),CKE(e2b(dh_ideal(G,x_5)))),FIN(tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,dh_ideal(G,x_4),sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4)))))),CKE(e2b(dh_ideal(G,x_5)))))))))).

35. By 34, the attacker may know FIN(tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),server_finished,(((((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,dh_ideal(G,x_4),sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4)))))),CKE(e2b(dh_ideal(G,x_5)))),FIN(tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,dh_ideal(G,x_4),sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4)))))),CKE(e2b(dh_ideal(G,x_5))))))))).
Using the function 1-proj-FIN the attacker may obtain tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),server_finished,(((((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,dh_ideal(G,x_4),sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4)))))),CKE(e2b(dh_ideal(G,x_5)))),FIN(tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,dh_ideal(G,x_4),sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4)))))),CKE(e2b(dh_ideal(G,x_5)))))))).
attacker(tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),server_finished,(((((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,dh_ideal(G,x_4),sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4)))))),CKE(e2b(dh_ideal(G,x_5)))),FIN(tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,dh_ideal(G,x_4),sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4)))))),CKE(e2b(dh_ideal(G,x_5))))))))).

36. By 35, the attacker may know tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),server_finished,(((((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,dh_ideal(G,x_4),sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4)))))),CKE(e2b(dh_ideal(G,x_5)))),FIN(tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,dh_ideal(G,x_4),sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4)))))),CKE(e2b(dh_ideal(G,x_5)))))))).
Using the function FIN the attacker may obtain FIN(tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),server_finished,(((((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,dh_ideal(G,x_4),sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4)))))),CKE(e2b(dh_ideal(G,x_5)))),FIN(tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,dh_ideal(G,x_4),sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4)))))),CKE(e2b(dh_ideal(G,x_5))))))))).
attacker(FIN(tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),server_finished,(((((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,dh_ideal(G,x_4),sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4)))))),CKE(e2b(dh_ideal(G,x_5)))),FIN(tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,dh_ideal(G,x_4),sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4)))))),CKE(e2b(dh_ideal(G,x_5)))))))))).

37. The message m_10 that the attacker may have by 1 may be received at input {3}.
The message SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9)) that the attacker may have by 17 may be received at input {5}.
The message CRT(pk(k_4)) that the attacker may have by 20 may be received at input {9}.
The entry longTermKeys_tbl(sn_2,k_4,pk(k_4)) that may be in a table by 21 may be read at get {45}.
The message SKE(StrongDH,dh_ideal(G,x_4),sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4))))) that the attacker may have by 25 may be received at input {12}.
The message FIN(tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),server_finished,(((((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,dh_ideal(G,x_4),sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4)))))),CKE(e2b(dh_ideal(G,x_5)))),FIN(tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,dh_ideal(G,x_4),sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4)))))),CKE(e2b(dh_ideal(G,x_5))))))))) that the attacker may have by 36 may be received at input {25}.
We have dh_ideal(G,x_4) ≠ BadElement.
So event ClientFinished(TLS12,cr_18,sr_12,NoPSK,pk(k_4),m_10,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),client_key_expansion,(sr_12,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),server_key_expansion,(sr_12,cr_18))),tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,dh_ideal(G,x_4),sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4)))))),CKE(e2b(dh_ideal(G,x_5))))),tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12))) may be executed at {29}.
end(ClientFinished(TLS12,cr_18,sr_12,NoPSK,pk(k_4),m_10,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),client_key_expansion,(sr_12,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),server_key_expansion,(sr_12,cr_18))),tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,dh_ideal(G,x_4),sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4)))))),CKE(e2b(dh_ideal(G,x_5))))),tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)))).

38. By 37, end(ClientFinished(TLS12,cr_18,sr_12,NoPSK,pk(k_4),m_10,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),client_key_expansion,(sr_12,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),server_key_expansion,(sr_12,cr_18))),tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,dh_ideal(G,x_4),sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4)))))),CKE(e2b(dh_ideal(G,x_5))))),tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)))).
The goal is reached, represented in the following fact:
end(ClientFinished(TLS12,cr_18,sr_12,NoPSK,pk(k_4),m_10,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),client_key_expansion,(sr_12,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),server_key_expansion,(sr_12,cr_18))),tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,m_10),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,dh_ideal(G,x_4),sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4)))))),CKE(e2b(dh_ideal(G,x_5))))),tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)))).


Unified offer_2 with m_10
Iterating unifyDerivation.
Fixpoint reached: nothing more to unify.
The clause after unifyDerivation is
attacker(m_11) && attacker(pt_9) && attacker(a_13) && attacker(xxx_2) && attacker(sn_2) -> end(ClientFinished(TLS12,cr[!1 = @sid],sr_1[mode_1 = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = m_11,cr_1 = cr[!1 = @sid],!1 = @sid_1],NoPSK,pk(k_2[a_2 = sn_2,!1 = @sid_2]),m_11,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_3[p_1 = pk(k_2[a_2 = sn_2,!1 = @sid_2]),sk_2 = k_2[a_2 = sn_2,!1 = @sid_2],sn_1 = sn_2,mode_1 = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = m_11,cr_1 = cr[!1 = @sid],!1 = @sid_1]),x_1[s = sign(k_2[a_2 = sn_2,!1 = @sid_2],hash_ideal((cr[!1 = @sid],sr_1[mode_1 = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = m_11,cr_1 = cr[!1 = @sid],!1 = @sid_1],StrongDH,dh_ideal(G,x_3[p_1 = pk(k_2[a_2 = sn_2,!1 = @sid_2]),sk_2 = k_2[a_2 = sn_2,!1 = @sid_2],sn_1 = sn_2,mode_1 = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = m_11,cr_1 = cr[!1 = @sid],!1 = @sid_1])))),e = dh_ideal(G,x_3[p_1 = pk(k_2[a_2 = sn_2,!1 = @sid_2]),sk_2 = k_2[a_2 = sn_2,!1 = @sid_2],sn_1 = sn_2,mode_1 = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = m_11,cr_1 = cr[!1 = @sid],!1 = @sid_1]),xxx = k_2[a_2 = sn_2,!1 = @sid_2],sn = sn_2,p = pk(k_2[a_2 = sn_2,!1 = @sid_2]),mode = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),sr = sr_1[mode_1 = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = m_11,cr_1 = cr[!1 = @sid],!1 = @sid_1],offer = m_11,!1 = @sid])),master_secret,(cr[!1 = @sid],sr_1[mode_1 = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = m_11,cr_1 = cr[!1 = @sid],!1 = @sid_1])),client_key_expansion,(sr_1[mode_1 = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = m_11,cr_1 = cr[!1 = @sid],!1 = @sid_1],cr[!1 = @sid]))),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_3[p_1 = pk(k_2[a_2 = sn_2,!1 = @sid_2]),sk_2 = k_2[a_2 = sn_2,!1 = @sid_2],sn_1 = sn_2,mode_1 = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = m_11,cr_1 = cr[!1 = @sid],!1 = @sid_1]),x_1[s = sign(k_2[a_2 = sn_2,!1 = @sid_2],hash_ideal((cr[!1 = @sid],sr_1[mode_1 = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = m_11,cr_1 = cr[!1 = @sid],!1 = @sid_1],StrongDH,dh_ideal(G,x_3[p_1 = pk(k_2[a_2 = sn_2,!1 = @sid_2]),sk_2 = k_2[a_2 = sn_2,!1 = @sid_2],sn_1 = sn_2,mode_1 = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = m_11,cr_1 = cr[!1 = @sid],!1 = @sid_1])))),e = dh_ideal(G,x_3[p_1 = pk(k_2[a_2 = sn_2,!1 = @sid_2]),sk_2 = k_2[a_2 = sn_2,!1 = @sid_2],sn_1 = sn_2,mode_1 = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = m_11,cr_1 = cr[!1 = @sid],!1 = @sid_1]),xxx = k_2[a_2 = sn_2,!1 = @sid_2],sn = sn_2,p = pk(k_2[a_2 = sn_2,!1 = @sid_2]),mode = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),sr = sr_1[mode_1 = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = m_11,cr_1 = cr[!1 = @sid],!1 = @sid_1],offer = m_11,!1 = @sid])),master_secret,(cr[!1 = @sid],sr_1[mode_1 = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = m_11,cr_1 = cr[!1 = @sid],!1 = @sid_1])),server_key_expansion,(sr_1[mode_1 = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = m_11,cr_1 = cr[!1 = @sid],!1 = @sid_1],cr[!1 = @sid]))),tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_3[p_1 = pk(k_2[a_2 = sn_2,!1 = @sid_2]),sk_2 = k_2[a_2 = sn_2,!1 = @sid_2],sn_1 = sn_2,mode_1 = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = m_11,cr_1 = cr[!1 = @sid],!1 = @sid_1]),x_1[s = sign(k_2[a_2 = sn_2,!1 = @sid_2],hash_ideal((cr[!1 = @sid],sr_1[mode_1 = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = m_11,cr_1 = cr[!1 = @sid],!1 = @sid_1],StrongDH,dh_ideal(G,x_3[p_1 = pk(k_2[a_2 = sn_2,!1 = @sid_2]),sk_2 = k_2[a_2 = sn_2,!1 = @sid_2],sn_1 = sn_2,mode_1 = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = m_11,cr_1 = cr[!1 = @sid],!1 = @sid_1])))),e = dh_ideal(G,x_3[p_1 = pk(k_2[a_2 = sn_2,!1 = @sid_2]),sk_2 = k_2[a_2 = sn_2,!1 = @sid_2],sn_1 = sn_2,mode_1 = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = m_11,cr_1 = cr[!1 = @sid],!1 = @sid_1]),xxx = k_2[a_2 = sn_2,!1 = @sid_2],sn = sn_2,p = pk(k_2[a_2 = sn_2,!1 = @sid_2]),mode = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),sr = sr_1[mode_1 = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = m_11,cr_1 = cr[!1 = @sid],!1 = @sid_1],offer = m_11,!1 = @sid])),master_secret,(cr[!1 = @sid],sr_1[mode_1 = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = m_11,cr_1 = cr[!1 = @sid],!1 = @sid_1])),client_finished,((((CH(cr[!1 = @sid],m_11),SH(sr_1[mode_1 = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = m_11,cr_1 = cr[!1 = @sid],!1 = @sid_1],nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_2[a_2 = sn_2,!1 = @sid_2]))),SKE(StrongDH,dh_ideal(G,x_3[p_1 = pk(k_2[a_2 = sn_2,!1 = @sid_2]),sk_2 = k_2[a_2 = sn_2,!1 = @sid_2],sn_1 = sn_2,mode_1 = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = m_11,cr_1 = cr[!1 = @sid],!1 = @sid_1]),sign(k_2[a_2 = sn_2,!1 = @sid_2],hash_ideal((cr[!1 = @sid],sr_1[mode_1 = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = m_11,cr_1 = cr[!1 = @sid],!1 = @sid_1],StrongDH,dh_ideal(G,x_3[p_1 = pk(k_2[a_2 = sn_2,!1 = @sid_2]),sk_2 = k_2[a_2 = sn_2,!1 = @sid_2],sn_1 = sn_2,mode_1 = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = m_11,cr_1 = cr[!1 = @sid],!1 = @sid_1])))))),CKE(e2b(dh_ideal(G,x_1[s = sign(k_2[a_2 = sn_2,!1 = @sid_2],hash_ideal((cr[!1 = @sid],sr_1[mode_1 = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = m_11,cr_1 = cr[!1 = @sid],!1 = @sid_1],StrongDH,dh_ideal(G,x_3[p_1 = pk(k_2[a_2 = sn_2,!1 = @sid_2]),sk_2 = k_2[a_2 = sn_2,!1 = @sid_2],sn_1 = sn_2,mode_1 = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = m_11,cr_1 = cr[!1 = @sid],!1 = @sid_1])))),e = dh_ideal(G,x_3[p_1 = pk(k_2[a_2 = sn_2,!1 = @sid_2]),sk_2 = k_2[a_2 = sn_2,!1 = @sid_2],sn_1 = sn_2,mode_1 = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = m_11,cr_1 = cr[!1 = @sid],!1 = @sid_1]),xxx = k_2[a_2 = sn_2,!1 = @sid_2],sn = sn_2,p = pk(k_2[a_2 = sn_2,!1 = @sid_2]),mode = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),sr = sr_1[mode_1 = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = m_11,cr_1 = cr[!1 = @sid],!1 = @sid_1],offer = m_11,!1 = @sid]))))),tls12_prf(e2b(dh_ideal(dh_ideal(G,x_3[p_1 = pk(k_2[a_2 = sn_2,!1 = @sid_2]),sk_2 = k_2[a_2 = sn_2,!1 = @sid_2],sn_1 = sn_2,mode_1 = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = m_11,cr_1 = cr[!1 = @sid],!1 = @sid_1]),x_1[s = sign(k_2[a_2 = sn_2,!1 = @sid_2],hash_ideal((cr[!1 = @sid],sr_1[mode_1 = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = m_11,cr_1 = cr[!1 = @sid],!1 = @sid_1],StrongDH,dh_ideal(G,x_3[p_1 = pk(k_2[a_2 = sn_2,!1 = @sid_2]),sk_2 = k_2[a_2 = sn_2,!1 = @sid_2],sn_1 = sn_2,mode_1 = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = m_11,cr_1 = cr[!1 = @sid],!1 = @sid_1])))),e = dh_ideal(G,x_3[p_1 = pk(k_2[a_2 = sn_2,!1 = @sid_2]),sk_2 = k_2[a_2 = sn_2,!1 = @sid_2],sn_1 = sn_2,mode_1 = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = m_11,cr_1 = cr[!1 = @sid],!1 = @sid_1]),xxx = k_2[a_2 = sn_2,!1 = @sid_2],sn = sn_2,p = pk(k_2[a_2 = sn_2,!1 = @sid_2]),mode = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),sr = sr_1[mode_1 = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = m_11,cr_1 = cr[!1 = @sid],!1 = @sid_1],offer = m_11,!1 = @sid])),master_secret,(cr[!1 = @sid],sr_1[mode_1 = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = m_11,cr_1 = cr[!1 = @sid],!1 = @sid_1]))))
This clause still contradicts the query.
A more detailed output of the traces is available with
  set traceDisplay = long.

event WeakOrCompromisedKey(NoPubKey) at {103} in copy a_14

new cr: random creating cr_18 at {2} in copy a_15

in(io, a_16) at {3} in copy a_15

out(io, CH(~M,~M_1)) with ~M = cr_18, ~M_1 = a_16 at {4} in copy a_15

in(io, CH(~M,a_16)) with ~M = cr_18 at {47} in copy a_17

in(io, SH(a_18,nego(TLS12,DHE(StrongDH),StrongHash,a_19,a_20))) at {48} in copy a_17

new sr_1: random creating sr_12 at {51} in copy a_17

out(io, SH(~M_2,nego(~M_3,DHE(StrongDH),StrongHash,~M_4,~M_5))) with ~M_2 = sr_12, ~M_3 = TLS12, ~M_4 = a_19, ~M_5 = a_20 at {52} in copy a_17

in(io, SH(~M_2,nego(TLS12,DHE(StrongDH),StrongHash,a_19,a_20))) with ~M_2 = sr_12 at {5} in copy a_15

in(io, a_21) at {104} in copy a_14

new k_2: privkey creating k_4 at {105} in copy a_14

insert longTermKeys_tbl(a_21,k_4,pk(k_4)) at {106} in copy a_14

out(io, ~M_6) with ~M_6 = pk(k_4) at {107} in copy a_14

in(io, CRT(~M_6)) with ~M_6 = pk(k_4) at {9} in copy a_15

get longTermKeys_tbl(a_21,k_4,pk(k_4)) at {45} in copy a_15

get longTermKeys_tbl(a_21,k_4,pk(k_4)) at {101} in copy a_17

event ServerChoosesVersion(cr_18,sr_12,pk(k_4),TLS12) at {54} in copy a_17

event ServerChoosesKEX(cr_18,sr_12,pk(k_4),TLS12,DHE(StrongDH)) at {55} in copy a_17

event ServerChoosesAE(cr_18,sr_12,pk(k_4),TLS12,a_19) at {56} in copy a_17

event ServerChoosesHash(cr_18,sr_12,pk(k_4),TLS12,StrongHash) at {57} in copy a_17

out(io, CRT(~M_7)) with ~M_7 = pk(k_4) at {58} in copy a_17

new x_3: bitstring creating x_4 at {61} in copy a_17

out(io, SKE(StrongDH,~M_8,~M_9)) with ~M_8 = dh_ideal(G,x_4), ~M_9 = sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4)))) at {65} in copy a_17

in(io, SKE(StrongDH,~M_8,~M_9)) with ~M_8 = dh_ideal(G,x_4), ~M_9 = sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4)))) at {12} in copy a_15

new x_1: bitstring creating x_5 at {15} in copy a_15

out(io, CKE(e2b(~M_10))) with ~M_10 = dh_ideal(G,x_5) at {20} in copy a_15

out(io, FIN(~M_11)) with ~M_11 = tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,a_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_19,a_20))),CRT(pk(k_4))),SKE(StrongDH,dh_ideal(G,x_4),sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4)))))),CKE(e2b(dh_ideal(G,x_5))))) at {23} in copy a_15

in(io, CKE(e2b(~M_10))) with ~M_10 = dh_ideal(G,x_5) at {67} in copy a_17

in(io, FIN(~M_11)) with ~M_11 = tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,a_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_19,a_20))),CRT(pk(k_4))),SKE(StrongDH,dh_ideal(G,x_4),sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4)))))),CKE(e2b(dh_ideal(G,x_5))))) at {71} in copy a_17

event ServerFinished(TLS12,cr_18,sr_12,NoPSK,pk(k_4),a_16,nego(TLS12,DHE(StrongDH),StrongHash,a_19,a_20),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_5),x_4)),master_secret,(cr_18,sr_12)),client_key_expansion,(sr_12,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_5),x_4)),master_secret,(cr_18,sr_12)),server_key_expansion,(sr_12,cr_18))),tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,a_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_19,a_20))),CRT(pk(k_4))),SKE(StrongDH,dh_ideal(G,x_4),sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4)))))),CKE(e2b(dh_ideal(G,x_5))))),tls12_prf(e2b(dh_ideal(dh_ideal(G,x_5),x_4)),master_secret,(cr_18,sr_12))) at {77} in copy a_17

out(io, FIN(~M_12)) with ~M_12 = tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_5),x_4)),master_secret,(cr_18,sr_12)),server_finished,(((((CH(cr_18,a_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_19,a_20))),CRT(pk(k_4))),SKE(StrongDH,dh_ideal(G,x_4),sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4)))))),CKE(e2b(dh_ideal(G,x_5)))),FIN(tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,a_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_19,a_20))),CRT(pk(k_4))),SKE(StrongDH,dh_ideal(G,x_4),sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4)))))),CKE(e2b(dh_ideal(G,x_5)))))))) at {78} in copy a_17

insert serverSession(cr_18,sr_12,NoPSK,pk(k_4),a_16,nego(TLS12,DHE(StrongDH),StrongHash,a_19,a_20),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_5),x_4)),master_secret,(cr_18,sr_12)),client_key_expansion,(sr_12,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_5),x_4)),master_secret,(cr_18,sr_12)),server_key_expansion,(sr_12,cr_18))),tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,a_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_19,a_20))),CRT(pk(k_4))),SKE(StrongDH,dh_ideal(G,x_4),sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4)))))),CKE(e2b(dh_ideal(G,x_5))))),tls12_prf(e2b(dh_ideal(dh_ideal(G,x_5),x_4)),master_secret,(cr_18,sr_12))) at {79} in copy a_17

in(io, FIN(~M_12)) with ~M_12 = tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),server_finished,(((((CH(cr_18,a_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_19,a_20))),CRT(pk(k_4))),SKE(StrongDH,dh_ideal(G,x_4),sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4)))))),CKE(e2b(dh_ideal(G,x_5)))),FIN(tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,a_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_19,a_20))),CRT(pk(k_4))),SKE(StrongDH,dh_ideal(G,x_4),sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4)))))),CKE(e2b(dh_ideal(G,x_5)))))))) at {25} in copy a_15

event ClientFinished(TLS12,cr_18,sr_12,NoPSK,pk(k_4),a_16,nego(TLS12,DHE(StrongDH),StrongHash,a_19,a_20),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),client_key_expansion,(sr_12,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),server_key_expansion,(sr_12,cr_18))),tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,a_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_19,a_20))),CRT(pk(k_4))),SKE(StrongDH,dh_ideal(G,x_4),sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4)))))),CKE(e2b(dh_ideal(G,x_5))))),tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12))) at {29} in copy a_15 (goal)

The event ClientFinished(TLS12,cr_18,sr_12,NoPSK,pk(k_4),a_16,nego(TLS12,DHE(StrongDH),StrongHash,a_19,a_20),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),client_key_expansion,(sr_12,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),server_key_expansion,(sr_12,cr_18))),tls12_prf(tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,a_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_19,a_20))),CRT(pk(k_4))),SKE(StrongDH,dh_ideal(G,x_4),sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,dh_ideal(G,x_4)))))),CKE(e2b(dh_ideal(G,x_5))))),tls12_prf(e2b(dh_ideal(dh_ideal(G,x_4),x_5)),master_secret,(cr_18,sr_12))) is executed at {29} in copy a_15.
A trace has been found.
RESULT not event(ClientFinished(TLS12,cr_18,sr_12,psk_16,p_7,m_10,o_16,ck_12,sk_8,cb_5,ms_9)) is false.
-- Query not event(ServerFinished(TLS13,cr_18,sr_12,psk_16,p_7,m_10,o_16,ck_12,sk_8,cb_5,ms_9)) in process 0.
Completing...
200 rules inserted. The rule base contains 200 rules. 140 rules in the queue.
400 rules inserted. The rule base contains 396 rules. 78 rules in the queue.
600 rules inserted. The rule base contains 510 rules. 164 rules in the queue.
800 rules inserted. The rule base contains 574 rules. 199 rules in the queue.
1000 rules inserted. The rule base contains 620 rules. 227 rules in the queue.
1200 rules inserted. The rule base contains 655 rules. 246 rules in the queue.
1400 rules inserted. The rule base contains 727 rules. 294 rules in the queue.
1600 rules inserted. The rule base contains 775 rules. 269 rules in the queue.
1800 rules inserted. The rule base contains 827 rules. 275 rules in the queue.
2000 rules inserted. The rule base contains 841 rules. 270 rules in the queue.
2200 rules inserted. The rule base contains 895 rules. 229 rules in the queue.
2400 rules inserted. The rule base contains 966 rules. 234 rules in the queue.
2600 rules inserted. The rule base contains 1056 rules. 238 rules in the queue.
2800 rules inserted. The rule base contains 1149 rules. 226 rules in the queue.
3000 rules inserted. The rule base contains 1253 rules. 221 rules in the queue.
3200 rules inserted. The rule base contains 1378 rules. 210 rules in the queue.
3400 rules inserted. The rule base contains 1466 rules. 173 rules in the queue.
3600 rules inserted. The rule base contains 1518 rules. 112 rules in the queue.
3800 rules inserted. The rule base contains 1473 rules. 45 rules in the queue.
4000 rules inserted. The rule base contains 1606 rules. 18 rules in the queue.
Starting query not event(ServerFinished(TLS13,cr_18,sr_12,psk_16,p_7,m_10,o_16,ck_12,sk_8,cb_5,ms_9))
RESULT not event(ServerFinished(TLS13,cr_18,sr_12,psk_16,p_7,m_10,o_16,ck_12,sk_8,cb_5,ms_9)) is true.
-- Query not event(PreServerFinished(TLS13,cr_18,sr_12,psk_16,p_7,m_10,o_16,ck_12,sk_8,cb_5)) in process 0.
Completing...
200 rules inserted. The rule base contains 200 rules. 130 rules in the queue.
400 rules inserted. The rule base contains 387 rules. 67 rules in the queue.
600 rules inserted. The rule base contains 502 rules. 170 rules in the queue.
800 rules inserted. The rule base contains 551 rules. 179 rules in the queue.
1000 rules inserted. The rule base contains 593 rules. 196 rules in the queue.
1200 rules inserted. The rule base contains 667 rules. 219 rules in the queue.
1400 rules inserted. The rule base contains 710 rules. 216 rules in the queue.
1600 rules inserted. The rule base contains 743 rules. 199 rules in the queue.
1800 rules inserted. The rule base contains 793 rules. 187 rules in the queue.
2000 rules inserted. The rule base contains 865 rules. 200 rules in the queue.
2200 rules inserted. The rule base contains 970 rules. 231 rules in the queue.
2400 rules inserted. The rule base contains 1056 rules. 211 rules in the queue.
2600 rules inserted. The rule base contains 1168 rules. 201 rules in the queue.
2800 rules inserted. The rule base contains 1274 rules. 177 rules in the queue.
3000 rules inserted. The rule base contains 1366 rules. 124 rules in the queue.
3200 rules inserted. The rule base contains 1342 rules. 75 rules in the queue.
3400 rules inserted. The rule base contains 1396 rules. 25 rules in the queue.
Starting query not event(PreServerFinished(TLS13,cr_18,sr_12,psk_16,p_7,m_10,o_16,ck_12,sk_8,cb_5))
RESULT not event(PreServerFinished(TLS13,cr_18,sr_12,psk_16,p_7,m_10,o_16,ck_12,sk_8,cb_5)) is true.
-- Query not event(ClientFinished(TLS13,cr_18,sr_12,psk_16,p_7,m_10,o_16,ck_12,sk_8,cb_5,ms_9)) in process 0.
Completing...
200 rules inserted. The rule base contains 200 rules. 139 rules in the queue.
400 rules inserted. The rule base contains 396 rules. 77 rules in the queue.
600 rules inserted. The rule base contains 520 rules. 150 rules in the queue.
800 rules inserted. The rule base contains 582 rules. 181 rules in the queue.
1000 rules inserted. The rule base contains 630 rules. 207 rules in the queue.
1200 rules inserted. The rule base contains 681 rules. 226 rules in the queue.
1400 rules inserted. The rule base contains 753 rules. 263 rules in the queue.
1600 rules inserted. The rule base contains 803 rules. 266 rules in the queue.
1800 rules inserted. The rule base contains 831 rules. 248 rules in the queue.
2000 rules inserted. The rule base contains 893 rules. 245 rules in the queue.
2200 rules inserted. The rule base contains 944 rules. 254 rules in the queue.
2400 rules inserted. The rule base contains 1033 rules. 263 rules in the queue.
2600 rules inserted. The rule base contains 1120 rules. 301 rules in the queue.
2800 rules inserted. The rule base contains 1212 rules. 270 rules in the queue.
3000 rules inserted. The rule base contains 1320 rules. 252 rules in the queue.
3200 rules inserted. The rule base contains 1442 rules. 253 rules in the queue.
3400 rules inserted. The rule base contains 1524 rules. 220 rules in the queue.
3600 rules inserted. The rule base contains 1614 rules. 168 rules in the queue.
3800 rules inserted. The rule base contains 1614 rules. 132 rules in the queue.
4000 rules inserted. The rule base contains 1593 rules. 67 rules in the queue.
4200 rules inserted. The rule base contains 1700 rules. 17 rules in the queue.
Starting query not event(ClientFinished(TLS13,cr_18,sr_12,psk_16,p_7,m_10,o_16,ck_12,sk_8,cb_5,ms_9))
RESULT not event(ClientFinished(TLS13,cr_18,sr_12,psk_16,p_7,m_10,o_16,ck_12,sk_8,cb_5,ms_9)) is true.
-- Query not event(MatchingResumptionSecret(TLS12,cr_18,sr_12,p_7,TLS12,cr'_5,sr'_3,p'_3)) in process 0.
Completing...
200 rules inserted. The rule base contains 200 rules. 137 rules in the queue.
400 rules inserted. The rule base contains 393 rules. 68 rules in the queue.
600 rules inserted. The rule base contains 505 rules. 166 rules in the queue.
800 rules inserted. The rule base contains 558 rules. 179 rules in the queue.
1000 rules inserted. The rule base contains 599 rules. 197 rules in the queue.
1200 rules inserted. The rule base contains 671 rules. 222 rules in the queue.
1400 rules inserted. The rule base contains 717 rules. 216 rules in the queue.
1600 rules inserted. The rule base contains 748 rules. 222 rules in the queue.
1800 rules inserted. The rule base contains 817 rules. 197 rules in the queue.
2000 rules inserted. The rule base contains 884 rules. 296 rules in the queue.
2200 rules inserted. The rule base contains 1002 rules. 294 rules in the queue.
2400 rules inserted. The rule base contains 1120 rules. 306 rules in the queue.
2600 rules inserted. The rule base contains 1232 rules. 291 rules in the queue.
2800 rules inserted. The rule base contains 1364 rules. 232 rules in the queue.
3000 rules inserted. The rule base contains 1497 rules. 242 rules in the queue.
3200 rules inserted. The rule base contains 1591 rules. 177 rules in the queue.
3400 rules inserted. The rule base contains 1647 rules. 111 rules in the queue.
3600 rules inserted. The rule base contains 1600 rules. 45 rules in the queue.
3800 rules inserted. The rule base contains 1729 rules. 22 rules in the queue.
Starting query not event(MatchingResumptionSecret(TLS12,cr_18,sr_12,p_7,TLS12,cr'_5,sr'_3,p'_3))
goal reachable: k_4 ≠ k_5 && attacker(k_4) && attacker(sn_2) && attacker(xxx_2) && attacker(hhh'_3) && attacker(aaa'_3) && attacker(ppp'_3) && attacker(o'_5) -> end(MatchingResumptionSecret(TLS12,cr_18,sr_12,pk(k_5),TLS12,cr_18,sr_12,pk(k_4)))
Abbreviations:
k_5 = k_2[a_2 = sn_2,!1 = @sid]
cr_18 = cr[!1 = @sid_1]
sr_12 = sr_1[mode_1 = nego(TLS12,RSA(StrongRSADecryption),hhh'_3,aaa'_3,ppp'_3),xxx_1 = xxx_2,offer_1 = o'_5,cr_1 = cr_18,!1 = @sid_2]

Derivation:
Abbreviations:
cr_18 = cr[!1 = @sid]
sr_12 = sr_1[mode_1 = nego(TLS12,RSA(StrongRSADecryption),hhh'_3,aaa'_3,ppp'_3),xxx_1 = xxx_2,offer_1 = o'_5,cr_1 = cr_18,!1 = @sid_1]
k_4 = k_2[a_2 = sn_2,!1 = @sid_2]
x_4 = x_3[p_1 = pk(k_4),sk_2 = k_4,sn_1 = sn_2,mode_1 = nego(TLS12,DHE(StrongDH),WeakHash,a_13,pt_9),xxx_1 = xxx_3,offer_1 = offer_2,cr_1 = cr_19,!1 = @sid_3]

1. The attacker has some term o_16.
attacker(o_16).

2. The attacker has some term ppp_5.
attacker(ppp_5).

3. The attacker has some term aaa_5.
attacker(aaa_5).

4. Using the function WeakHash the attacker may obtain WeakHash.
attacker(WeakHash).

5. Using the function WeakDH the attacker may obtain WeakDH.
attacker(WeakDH).

6. By 5, the attacker may know WeakDH.
Using the function DHE the attacker may obtain DHE(WeakDH).
attacker(DHE(WeakDH)).

7. Using the function TLS12 the attacker may obtain TLS12.
attacker(TLS12).

8. By 7, the attacker may know TLS12.
By 6, the attacker may know DHE(WeakDH).
By 4, the attacker may know WeakHash.
By 3, the attacker may know aaa_5.
By 2, the attacker may know ppp_5.
Using the function nego the attacker may obtain nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5).
attacker(nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5)).

9. We assume as hypothesis that
attacker(o'_5).

10. The attacker has some term offer_3.
attacker(offer_3).

11. The message offer_3 that the attacker may have by 10 may be received at input {3}.
So the message CH(cr_18,offer_3) may be sent to the attacker at output {4}.
attacker(CH(cr_18,offer_3)).

12. By 11, the attacker may know CH(cr_18,offer_3).
Using the function 1-proj-CH the attacker may obtain cr_18.
attacker(cr_18).

13. By 12, the attacker may know cr_18.
By 9, the attacker may know o'_5.
Using the function CH the attacker may obtain CH(cr_18,o'_5).
attacker(CH(cr_18,o'_5)).

14. We assume as hypothesis that
attacker(ppp'_3).

15. We assume as hypothesis that
attacker(aaa'_3).

16. We assume as hypothesis that
attacker(hhh'_3).

17. Using the function StrongRSADecryption the attacker may obtain StrongRSADecryption.
attacker(StrongRSADecryption).

18. By 17, the attacker may know StrongRSADecryption.
Using the function RSA the attacker may obtain RSA(StrongRSADecryption).
attacker(RSA(StrongRSADecryption)).

19. By 7, the attacker may know TLS12.
By 18, the attacker may know RSA(StrongRSADecryption).
By 16, the attacker may know hhh'_3.
By 15, the attacker may know aaa'_3.
By 14, the attacker may know ppp'_3.
Using the function nego the attacker may obtain nego(TLS12,RSA(StrongRSADecryption),hhh'_3,aaa'_3,ppp'_3).
attacker(nego(TLS12,RSA(StrongRSADecryption),hhh'_3,aaa'_3,ppp'_3)).

20. We assume as hypothesis that
attacker(xxx_2).

21. By 20, the attacker may know xxx_2.
By 19, the attacker may know nego(TLS12,RSA(StrongRSADecryption),hhh'_3,aaa'_3,ppp'_3).
Using the function SH the attacker may obtain SH(xxx_2,nego(TLS12,RSA(StrongRSADecryption),hhh'_3,aaa'_3,ppp'_3)).
attacker(SH(xxx_2,nego(TLS12,RSA(StrongRSADecryption),hhh'_3,aaa'_3,ppp'_3))).

22. The message CH(cr_18,o'_5) that the attacker may have by 13 may be received at input {47}.
The message SH(xxx_2,nego(TLS12,RSA(StrongRSADecryption),hhh'_3,aaa'_3,ppp'_3)) that the attacker may have by 21 may be received at input {48}.
So the message SH(sr_12,nego(TLS12,RSA(StrongRSADecryption),hhh'_3,aaa'_3,ppp'_3)) may be sent to the attacker at output {52}.
attacker(SH(sr_12,nego(TLS12,RSA(StrongRSADecryption),hhh'_3,aaa'_3,ppp'_3))).

23. By 22, the attacker may know SH(sr_12,nego(TLS12,RSA(StrongRSADecryption),hhh'_3,aaa'_3,ppp'_3)).
Using the function 1-proj-SH the attacker may obtain sr_12.
attacker(sr_12).

24. By 23, the attacker may know sr_12.
By 8, the attacker may know nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5).
Using the function SH the attacker may obtain SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5)).
attacker(SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))).

25. We assume as hypothesis that
attacker(sn_2).

26. The message sn_2 that the attacker may have by 25 may be received at input {104}.
So the message pk(k_4) may be sent to the attacker at output {107}.
attacker(pk(k_4)).

27. By 26, the attacker may know pk(k_4).
Using the function CRT the attacker may obtain CRT(pk(k_4)).
attacker(CRT(pk(k_4))).

28. The message sn_2 that the attacker may have by 25 may be received at input {104}.
So the entry longTermKeys_tbl(sn_2,k_4,pk(k_4)) may be inserted in a table at insert {106}.
table(longTermKeys_tbl(sn_2,k_4,pk(k_4))).

29. The attacker has some term offer_2.
attacker(offer_2).

30. The attacker has some term cr_19.
attacker(cr_19).

31. By 30, the attacker may know cr_19.
By 29, the attacker may know offer_2.
Using the function CH the attacker may obtain CH(cr_19,offer_2).
attacker(CH(cr_19,offer_2)).

32. The attacker has some term pt_9.
attacker(pt_9).

33. The attacker has some term a_13.
attacker(a_13).

34. Using the function StrongDH the attacker may obtain StrongDH.
attacker(StrongDH).

35. By 34, the attacker may know StrongDH.
Using the function DHE the attacker may obtain DHE(StrongDH).
attacker(DHE(StrongDH)).

36. By 7, the attacker may know TLS12.
By 35, the attacker may know DHE(StrongDH).
By 4, the attacker may know WeakHash.
By 33, the attacker may know a_13.
By 32, the attacker may know pt_9.
Using the function nego the attacker may obtain nego(TLS12,DHE(StrongDH),WeakHash,a_13,pt_9).
attacker(nego(TLS12,DHE(StrongDH),WeakHash,a_13,pt_9)).

37. The attacker has some term xxx_3.
attacker(xxx_3).

38. By 37, the attacker may know xxx_3.
By 36, the attacker may know nego(TLS12,DHE(StrongDH),WeakHash,a_13,pt_9).
Using the function SH the attacker may obtain SH(xxx_3,nego(TLS12,DHE(StrongDH),WeakHash,a_13,pt_9)).
attacker(SH(xxx_3,nego(TLS12,DHE(StrongDH),WeakHash,a_13,pt_9))).

39. The message CH(cr_19,offer_2) that the attacker may have by 31 may be received at input {47}.
The message SH(xxx_3,nego(TLS12,DHE(StrongDH),WeakHash,a_13,pt_9)) that the attacker may have by 38 may be received at input {48}.
The entry longTermKeys_tbl(sn_2,k_4,pk(k_4)) that may be in a table by 28 may be read at get {101}.
So the message SKE(StrongDH,dh_ideal(G,x_4),sign(k_4,collision)) may be sent to the attacker at output {65}.
attacker(SKE(StrongDH,dh_ideal(G,x_4),sign(k_4,collision))).

40. By 39, the attacker may know SKE(StrongDH,dh_ideal(G,x_4),sign(k_4,collision)).
Using the function 3-proj-SKE the attacker may obtain sign(k_4,collision).
attacker(sign(k_4,collision)).

41. The attacker has some term e_1.
attacker(e_1).

42. By 5, the attacker may know WeakDH.
By 41, the attacker may know e_1.
By 40, the attacker may know sign(k_4,collision).
Using the function SKE the attacker may obtain SKE(WeakDH,e_1,sign(k_4,collision)).
attacker(SKE(WeakDH,e_1,sign(k_4,collision))).

43. Using the function BadElement the attacker may obtain BadElement.
attacker(BadElement).

44. By 43, the attacker may know BadElement.
Using the function e2b the attacker may obtain e2b(BadElement).
attacker(e2b(BadElement)).

45. By 44, the attacker may know e2b(BadElement).
Using the function CKE the attacker may obtain CKE(e2b(BadElement)).
attacker(CKE(e2b(BadElement))).

46. By 12, the attacker may know cr_18.
By 1, the attacker may know o_16.
Using the function CH the attacker may obtain CH(cr_18,o_16).
attacker(CH(cr_18,o_16)).

47. By 46, the attacker may know CH(cr_18,o_16).
By 24, the attacker may know SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5)).
Using the function 2-tuple the attacker may obtain (CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))).
attacker((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5)))).

48. By 47, the attacker may know (CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))).
By 27, the attacker may know CRT(pk(k_4)).
Using the function 2-tuple the attacker may obtain ((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))).
attacker(((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4)))).

49. By 48, the attacker may know ((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))).
By 42, the attacker may know SKE(WeakDH,e_1,sign(k_4,collision)).
Using the function 2-tuple the attacker may obtain (((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))).
attacker((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision)))).

50. By 49, the attacker may know (((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))).
By 45, the attacker may know CKE(e2b(BadElement)).
Using the function 2-tuple the attacker may obtain ((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))).
attacker(((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement)))).

51. Using the function client_finished the attacker may obtain client_finished.
attacker(client_finished).

52. By 12, the attacker may know cr_18.
By 23, the attacker may know sr_12.
Using the function 2-tuple the attacker may obtain (cr_18,sr_12).
attacker((cr_18,sr_12)).

53. Using the function master_secret the attacker may obtain master_secret.
attacker(master_secret).

54. By 44, the attacker may know e2b(BadElement).
By 53, the attacker may know master_secret.
By 52, the attacker may know (cr_18,sr_12).
Using the function tls12_prf the attacker may obtain tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)).
attacker(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12))).

55. By 54, the attacker may know tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)).
By 51, the attacker may know client_finished.
By 50, the attacker may know ((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))).
Using the function tls12_prf the attacker may obtain tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement)))).
attacker(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))))).

56. By 55, the attacker may know tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement)))).
Using the function FIN the attacker may obtain FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))))).
attacker(FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement)))))).

57. By 50, the attacker may know ((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))).
By 56, the attacker may know FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))))).
Using the function 2-tuple the attacker may obtain (((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement)))))).
attacker((((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))))))).

58. Using the function server_finished the attacker may obtain server_finished.
attacker(server_finished).

59. By 54, the attacker may know tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)).
By 58, the attacker may know server_finished.
By 57, the attacker may know (((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement)))))).
Using the function tls12_prf the attacker may obtain tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),server_finished,(((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))))))).
attacker(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),server_finished,(((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement)))))))).

60. By 59, the attacker may know tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),server_finished,(((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))))))).
Using the function FIN the attacker may obtain FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),server_finished,(((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement)))))))).
attacker(FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),server_finished,(((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))))))))).

61. The message o_16 that the attacker may have by 1 may be received at input {3}.
The message SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5)) that the attacker may have by 24 may be received at input {5}.
The message CRT(pk(k_4)) that the attacker may have by 27 may be received at input {9}.
The entry longTermKeys_tbl(sn_2,k_4,pk(k_4)) that may be in a table by 28 may be read at get {45}.
The message SKE(WeakDH,e_1,sign(k_4,collision)) that the attacker may have by 42 may be received at input {12}.
The message FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),server_finished,(((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement)))))))) that the attacker may have by 60 may be received at input {25}.
So the entry clientSession(cr_18,sr_12,NoPSK,pk(k_4),o_16,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_key_expansion,(sr_12,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),server_key_expansion,(sr_12,cr_18))),tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement)))),tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12))) may be inserted in a table at insert {30}.
table(clientSession(cr_18,sr_12,NoPSK,pk(k_4),o_16,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_key_expansion,(sr_12,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),server_key_expansion,(sr_12,cr_18))),tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement)))),tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)))).

62. We assume as hypothesis that
attacker(k_5).

63. The attacker has some term sn_3.
attacker(sn_3).

64. By 63, the attacker may know sn_3.
By 62, the attacker may know k_5.
Using the function 2-tuple the attacker may obtain (sn_3,k_5).
attacker((sn_3,k_5)).

65. The message (sn_3,k_5) that the attacker may have by 64 may be received at input {108}.
So the entry longTermKeys_tbl(sn_3,k_5,pk(k_5)) may be inserted in a table at insert {110}.
table(longTermKeys_tbl(sn_3,k_5,pk(k_5))).

66. By 62, the attacker may know k_5.
Using the function pk the attacker may obtain pk(k_5).
attacker(pk(k_5)).

67. By 66, the attacker may know pk(k_5).
By 44, the attacker may know e2b(BadElement).
Using the function rsa_enc the attacker may obtain rsa_enc(pk(k_5),e2b(BadElement)).
attacker(rsa_enc(pk(k_5),e2b(BadElement))).

68. By 67, the attacker may know rsa_enc(pk(k_5),e2b(BadElement)).
Using the function CKE the attacker may obtain CKE(rsa_enc(pk(k_5),e2b(BadElement))).
attacker(CKE(rsa_enc(pk(k_5),e2b(BadElement)))).

69. By 66, the attacker may know pk(k_5).
Using the function CRT the attacker may obtain CRT(pk(k_5)).
attacker(CRT(pk(k_5))).

70. By 13, the attacker may know CH(cr_18,o'_5).
By 22, the attacker may know SH(sr_12,nego(TLS12,RSA(StrongRSADecryption),hhh'_3,aaa'_3,ppp'_3)).
Using the function 2-tuple the attacker may obtain (CH(cr_18,o'_5),SH(sr_12,nego(TLS12,RSA(StrongRSADecryption),hhh'_3,aaa'_3,ppp'_3))).
attacker((CH(cr_18,o'_5),SH(sr_12,nego(TLS12,RSA(StrongRSADecryption),hhh'_3,aaa'_3,ppp'_3)))).

71. By 70, the attacker may know (CH(cr_18,o'_5),SH(sr_12,nego(TLS12,RSA(StrongRSADecryption),hhh'_3,aaa'_3,ppp'_3))).
By 69, the attacker may know CRT(pk(k_5)).
Using the function 2-tuple the attacker may obtain ((CH(cr_18,o'_5),SH(sr_12,nego(TLS12,RSA(StrongRSADecryption),hhh'_3,aaa'_3,ppp'_3))),CRT(pk(k_5))).
attacker(((CH(cr_18,o'_5),SH(sr_12,nego(TLS12,RSA(StrongRSADecryption),hhh'_3,aaa'_3,ppp'_3))),CRT(pk(k_5)))).

72. By 71, the attacker may know ((CH(cr_18,o'_5),SH(sr_12,nego(TLS12,RSA(StrongRSADecryption),hhh'_3,aaa'_3,ppp'_3))),CRT(pk(k_5))).
By 68, the attacker may know CKE(rsa_enc(pk(k_5),e2b(BadElement))).
Using the function 2-tuple the attacker may obtain (((CH(cr_18,o'_5),SH(sr_12,nego(TLS12,RSA(StrongRSADecryption),hhh'_3,aaa'_3,ppp'_3))),CRT(pk(k_5))),CKE(rsa_enc(pk(k_5),e2b(BadElement)))).
attacker((((CH(cr_18,o'_5),SH(sr_12,nego(TLS12,RSA(StrongRSADecryption),hhh'_3,aaa'_3,ppp'_3))),CRT(pk(k_5))),CKE(rsa_enc(pk(k_5),e2b(BadElement))))).

73. By 54, the attacker may know tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)).
By 51, the attacker may know client_finished.
By 72, the attacker may know (((CH(cr_18,o'_5),SH(sr_12,nego(TLS12,RSA(StrongRSADecryption),hhh'_3,aaa'_3,ppp'_3))),CRT(pk(k_5))),CKE(rsa_enc(pk(k_5),e2b(BadElement)))).
Using the function tls12_prf the attacker may obtain tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,(((CH(cr_18,o'_5),SH(sr_12,nego(TLS12,RSA(StrongRSADecryption),hhh'_3,aaa'_3,ppp'_3))),CRT(pk(k_5))),CKE(rsa_enc(pk(k_5),e2b(BadElement))))).
attacker(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,(((CH(cr_18,o'_5),SH(sr_12,nego(TLS12,RSA(StrongRSADecryption),hhh'_3,aaa'_3,ppp'_3))),CRT(pk(k_5))),CKE(rsa_enc(pk(k_5),e2b(BadElement)))))).

74. By 73, the attacker may know tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,(((CH(cr_18,o'_5),SH(sr_12,nego(TLS12,RSA(StrongRSADecryption),hhh'_3,aaa'_3,ppp'_3))),CRT(pk(k_5))),CKE(rsa_enc(pk(k_5),e2b(BadElement))))).
Using the function FIN the attacker may obtain FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,(((CH(cr_18,o'_5),SH(sr_12,nego(TLS12,RSA(StrongRSADecryption),hhh'_3,aaa'_3,ppp'_3))),CRT(pk(k_5))),CKE(rsa_enc(pk(k_5),e2b(BadElement)))))).
attacker(FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,(((CH(cr_18,o'_5),SH(sr_12,nego(TLS12,RSA(StrongRSADecryption),hhh'_3,aaa'_3,ppp'_3))),CRT(pk(k_5))),CKE(rsa_enc(pk(k_5),e2b(BadElement))))))).

75. The message CH(cr_18,o'_5) that the attacker may have by 13 may be received at input {47}.
The message SH(xxx_2,nego(TLS12,RSA(StrongRSADecryption),hhh'_3,aaa'_3,ppp'_3)) that the attacker may have by 21 may be received at input {48}.
The entry longTermKeys_tbl(sn_3,k_5,pk(k_5)) that may be in a table by 65 may be read at get {101}.
The message CKE(rsa_enc(pk(k_5),e2b(BadElement))) that the attacker may have by 68 may be received at input {84}.
The message FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,(((CH(cr_18,o'_5),SH(sr_12,nego(TLS12,RSA(StrongRSADecryption),hhh'_3,aaa'_3,ppp'_3))),CRT(pk(k_5))),CKE(rsa_enc(pk(k_5),e2b(BadElement)))))) that the attacker may have by 74 may be received at input {89}.
So the entry serverSession(cr_18,sr_12,NoPSK,pk(k_5),o'_5,nego(TLS12,RSA(StrongRSADecryption),hhh'_3,aaa'_3,ppp'_3),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_key_expansion,(sr_12,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),server_key_expansion,(sr_12,cr_18))),tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,(((CH(cr_18,o'_5),SH(sr_12,nego(TLS12,RSA(StrongRSADecryption),hhh'_3,aaa'_3,ppp'_3))),CRT(pk(k_5))),CKE(rsa_enc(pk(k_5),e2b(BadElement))))),tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12))) may be inserted in a table at insert {97}.
table(serverSession(cr_18,sr_12,NoPSK,pk(k_5),o'_5,nego(TLS12,RSA(StrongRSADecryption),hhh'_3,aaa'_3,ppp'_3),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_key_expansion,(sr_12,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),server_key_expansion,(sr_12,cr_18))),tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,(((CH(cr_18,o'_5),SH(sr_12,nego(TLS12,RSA(StrongRSADecryption),hhh'_3,aaa'_3,ppp'_3))),CRT(pk(k_5))),CKE(rsa_enc(pk(k_5),e2b(BadElement))))),tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)))).

76. The entry clientSession(cr_18,sr_12,NoPSK,pk(k_4),o_16,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_key_expansion,(sr_12,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),server_key_expansion,(sr_12,cr_18))),tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement)))),tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12))) that may be in a table by 61 may be read at get {194}.
The entry serverSession(cr_18,sr_12,NoPSK,pk(k_5),o'_5,nego(TLS12,RSA(StrongRSADecryption),hhh'_3,aaa'_3,ppp'_3),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_key_expansion,(sr_12,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),server_key_expansion,(sr_12,cr_18))),tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,(((CH(cr_18,o'_5),SH(sr_12,nego(TLS12,RSA(StrongRSADecryption),hhh'_3,aaa'_3,ppp'_3))),CRT(pk(k_5))),CKE(rsa_enc(pk(k_5),e2b(BadElement))))),tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12))) that may be in a table by 75 may be read at get {193}.
We have pk(k_4) ≠ pk(k_5).
So event MatchingResumptionSecret(TLS12,cr_18,sr_12,pk(k_4),TLS12,cr_18,sr_12,pk(k_5)) may be executed at {192}.
end(MatchingResumptionSecret(TLS12,cr_18,sr_12,pk(k_4),TLS12,cr_18,sr_12,pk(k_5))).

77. By 76, end(MatchingResumptionSecret(TLS12,cr_18,sr_12,pk(k_4),TLS12,cr_18,sr_12,pk(k_5))).
The goal is reached, represented in the following fact:
end(MatchingResumptionSecret(TLS12,cr_18,sr_12,pk(k_4),TLS12,cr_18,sr_12,pk(k_5))).


Unified offer_2 with o_16
Iterating unifyDerivation.
Fixpoint reached: nothing more to unify.
The clause after unifyDerivation is
k_4 ≠ k_2[a_2 = sn_2,!1 = @sid] && attacker(o'_5) && attacker(ppp'_3) && attacker(aaa'_3) && attacker(hhh'_3) && attacker(xxx_2) && attacker(sn_2) && attacker(k_4) -> end(MatchingResumptionSecret(TLS12,cr[!1 = @sid_1],sr_1[mode_1 = nego(TLS12,RSA(StrongRSADecryption),hhh'_3,aaa'_3,ppp'_3),xxx_1 = xxx_2,offer_1 = o'_5,cr_1 = cr[!1 = @sid_1],!1 = @sid_2],pk(k_2[a_2 = sn_2,!1 = @sid]),TLS12,cr[!1 = @sid_1],sr_1[mode_1 = nego(TLS12,RSA(StrongRSADecryption),hhh'_3,aaa'_3,ppp'_3),xxx_1 = xxx_2,offer_1 = o'_5,cr_1 = cr[!1 = @sid_1],!1 = @sid_2],pk(k_4)))
This clause still contradicts the query.
A more detailed output of the traces is available with
  set traceDisplay = long.

event WeakOrCompromisedKey(NoPubKey) at {103} in copy a_13

event WeakOrCompromisedKey(NoPubKey) at {103} in copy a_14

new cr: random creating cr_18 at {2} in copy a_15

in(io, a_16) at {3} in copy a_15

out(io, CH(~M,~M_1)) with ~M = cr_18, ~M_1 = a_16 at {4} in copy a_15

in(io, CH(a_17,a_18)) at {47} in copy a_19

in(io, SH(a_20,nego(TLS12,DHE(StrongDH),WeakHash,a_21,a_22))) at {48} in copy a_19

new sr_1: random creating sr_12 at {51} in copy a_19

out(io, SH(~M_2,nego(~M_3,DHE(StrongDH),WeakHash,~M_4,~M_5))) with ~M_2 = sr_12, ~M_3 = TLS12, ~M_4 = a_21, ~M_5 = a_22 at {52} in copy a_19

in(io, CH(~M,a_23)) with ~M = cr_18 at {47} in copy a_24

in(io, SH(a_25,nego(TLS12,RSA(StrongRSADecryption),a_26,a_27,a_28))) at {48} in copy a_24

new sr_1: random creating sr_13 at {51} in copy a_24

out(io, SH(~M_6,nego(~M_7,RSA(~M_8),~M_9,~M_10,~M_11))) with ~M_6 = sr_13, ~M_7 = TLS12, ~M_8 = StrongRSADecryption, ~M_9 = a_26, ~M_10 = a_27, ~M_11 = a_28 at {52} in copy a_24

in(io, SH(~M_6,nego(TLS12,DHE(WeakDH),WeakHash,a_29,a_30))) with ~M_6 = sr_13 at {5} in copy a_15

in(io, (a_31,a_32)) at {108} in copy a_14

event WeakOrCompromisedKey(pk(a_32)) at {109} in copy a_14

insert longTermKeys_tbl(a_31,a_32,pk(a_32)) at {110} in copy a_14

get longTermKeys_tbl(a_31,a_32,pk(a_32)) at {101} in copy a_24

event ServerChoosesVersion(cr_18,sr_13,pk(a_32),TLS12) at {54} in copy a_24

event ServerChoosesKEX(cr_18,sr_13,pk(a_32),TLS12,RSA(StrongRSADecryption)) at {55} in copy a_24

event ServerChoosesAE(cr_18,sr_13,pk(a_32),TLS12,a_27) at {56} in copy a_24

event ServerChoosesHash(cr_18,sr_13,pk(a_32),TLS12,a_26) at {57} in copy a_24

out(io, CRT(~M_12)) with ~M_12 = pk(a_32) at {58} in copy a_24

in(io, CKE(rsa_enc(pk(a_32),e2b(BadElement)))) at {84} in copy a_24

out(io, ~M_13) with ~M_13 = zero at {87} in copy a_24

in(io, FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(~M,~M_6)),client_finished,(((CH(~M,a_23),SH(~M_6,nego(TLS12,RSA(StrongRSADecryption),a_26,a_27,a_28))),CRT(pk(a_32))),CKE(rsa_enc(pk(a_32),e2b(BadElement))))))) with tls12_prf(tls12_prf(e2b(BadElement),master_secret,(~M,~M_6)),client_finished,(((CH(~M,a_23),SH(~M_6,nego(TLS12,RSA(StrongRSADecryption),a_26,a_27,a_28))),CRT(pk(a_32))),CKE(rsa_enc(pk(a_32),e2b(BadElement))))) = tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_finished,(((CH(cr_18,a_23),SH(sr_13,nego(TLS12,RSA(StrongRSADecryption),a_26,a_27,a_28))),CRT(pk(a_32))),CKE(rsa_enc(pk(a_32),e2b(BadElement))))) at {89} in copy a_24

event ServerFinished(TLS12,cr_18,sr_13,NoPSK,pk(a_32),a_23,nego(TLS12,RSA(StrongRSADecryption),a_26,a_27,a_28),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_key_expansion,(sr_13,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),server_key_expansion,(sr_13,cr_18))),tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_finished,(((CH(cr_18,a_23),SH(sr_13,nego(TLS12,RSA(StrongRSADecryption),a_26,a_27,a_28))),CRT(pk(a_32))),CKE(rsa_enc(pk(a_32),e2b(BadElement))))),tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13))) at {95} in copy a_24

out(io, FIN(~M_14)) with ~M_14 = tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),server_finished,((((CH(cr_18,a_23),SH(sr_13,nego(TLS12,RSA(StrongRSADecryption),a_26,a_27,a_28))),CRT(pk(a_32))),CKE(rsa_enc(pk(a_32),e2b(BadElement)))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_finished,(((CH(cr_18,a_23),SH(sr_13,nego(TLS12,RSA(StrongRSADecryption),a_26,a_27,a_28))),CRT(pk(a_32))),CKE(rsa_enc(pk(a_32),e2b(BadElement)))))))) at {96} in copy a_24

insert serverSession(cr_18,sr_13,NoPSK,pk(a_32),a_23,nego(TLS12,RSA(StrongRSADecryption),a_26,a_27,a_28),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_key_expansion,(sr_13,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),server_key_expansion,(sr_13,cr_18))),tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_finished,(((CH(cr_18,a_23),SH(sr_13,nego(TLS12,RSA(StrongRSADecryption),a_26,a_27,a_28))),CRT(pk(a_32))),CKE(rsa_enc(pk(a_32),e2b(BadElement))))),tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13))) at {97} in copy a_24

in(io, a_33) at {104} in copy a_13

new k_2: privkey creating k_5 at {105} in copy a_13

insert longTermKeys_tbl(a_33,k_5,pk(k_5)) at {106} in copy a_13

out(io, ~M_15) with ~M_15 = pk(k_5) at {107} in copy a_13

in(io, CRT(~M_15)) with ~M_15 = pk(k_5) at {9} in copy a_15

get longTermKeys_tbl(a_33,k_5,pk(k_5)) at {45} in copy a_15

get longTermKeys_tbl(a_33,k_5,pk(k_5)) at {101} in copy a_19

event ServerChoosesVersion(a_17,sr_12,pk(k_5),TLS12) at {54} in copy a_19

event ServerChoosesKEX(a_17,sr_12,pk(k_5),TLS12,DHE(StrongDH)) at {55} in copy a_19

event ServerChoosesAE(a_17,sr_12,pk(k_5),TLS12,a_21) at {56} in copy a_19

event ServerChoosesHash(a_17,sr_12,pk(k_5),TLS12,WeakHash) at {57} in copy a_19

out(io, CRT(~M_16)) with ~M_16 = pk(k_5) at {58} in copy a_19

new x_3: bitstring creating x_4 at {61} in copy a_19

out(io, SKE(StrongDH,~M_17,~M_18)) with ~M_17 = dh_ideal(G,x_4), ~M_18 = sign(k_5,collision) at {65} in copy a_19

in(io, SKE(WeakDH,a_34,~M_18)) with ~M_18 = sign(k_5,collision) at {12} in copy a_15

new x_1: bitstring creating x_5 at {15} in copy a_15

out(io, CKE(e2b(BadElement))) at {20} in copy a_15

out(io, FIN(~M_19)) with ~M_19 = tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_finished,((((CH(cr_18,a_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,a_29,a_30))),CRT(pk(k_5))),SKE(WeakDH,a_34,sign(k_5,collision))),CKE(e2b(BadElement)))) at {23} in copy a_15

in(io, FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(~M,~M_6)),server_finished,(((((CH(~M,a_16),SH(~M_6,nego(TLS12,DHE(WeakDH),WeakHash,a_29,a_30))),CRT(~M_15)),SKE(WeakDH,a_34,~M_18)),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(~M,~M_6)),client_finished,((((CH(~M,a_16),SH(~M_6,nego(TLS12,DHE(WeakDH),WeakHash,a_29,a_30))),CRT(~M_15)),SKE(WeakDH,a_34,~M_18)),CKE(e2b(BadElement))))))))) with tls12_prf(tls12_prf(e2b(BadElement),master_secret,(~M,~M_6)),server_finished,(((((CH(~M,a_16),SH(~M_6,nego(TLS12,DHE(WeakDH),WeakHash,a_29,a_30))),CRT(~M_15)),SKE(WeakDH,a_34,~M_18)),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(~M,~M_6)),client_finished,((((CH(~M,a_16),SH(~M_6,nego(TLS12,DHE(WeakDH),WeakHash,a_29,a_30))),CRT(~M_15)),SKE(WeakDH,a_34,~M_18)),CKE(e2b(BadElement))))))) = tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),server_finished,(((((CH(cr_18,a_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,a_29,a_30))),CRT(pk(k_5))),SKE(WeakDH,a_34,sign(k_5,collision))),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_finished,((((CH(cr_18,a_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,a_29,a_30))),CRT(pk(k_5))),SKE(WeakDH,a_34,sign(k_5,collision))),CKE(e2b(BadElement))))))) at {25} in copy a_15

event ClientFinished(TLS12,cr_18,sr_13,NoPSK,pk(k_5),a_16,nego(TLS12,DHE(WeakDH),WeakHash,a_29,a_30),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_key_expansion,(sr_13,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),server_key_expansion,(sr_13,cr_18))),tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_finished,((((CH(cr_18,a_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,a_29,a_30))),CRT(pk(k_5))),SKE(WeakDH,a_34,sign(k_5,collision))),CKE(e2b(BadElement)))),tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13))) at {29} in copy a_15

insert clientSession(cr_18,sr_13,NoPSK,pk(k_5),a_16,nego(TLS12,DHE(WeakDH),WeakHash,a_29,a_30),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_key_expansion,(sr_13,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),server_key_expansion,(sr_13,cr_18))),tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_finished,((((CH(cr_18,a_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,a_29,a_30))),CRT(pk(k_5))),SKE(WeakDH,a_34,sign(k_5,collision))),CKE(e2b(BadElement)))),tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13))) at {30} in copy a_15

get clientSession(cr_18,sr_13,NoPSK,pk(k_5),a_16,nego(TLS12,DHE(WeakDH),WeakHash,a_29,a_30),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_key_expansion,(sr_13,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),server_key_expansion,(sr_13,cr_18))),tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_finished,((((CH(cr_18,a_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,a_29,a_30))),CRT(pk(k_5))),SKE(WeakDH,a_34,sign(k_5,collision))),CKE(e2b(BadElement)))),tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13))) at {194} in copy a_35

get serverSession(cr_18,sr_13,NoPSK,pk(a_32),a_23,nego(TLS12,RSA(StrongRSADecryption),a_26,a_27,a_28),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_key_expansion,(sr_13,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),server_key_expansion,(sr_13,cr_18))),tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_finished,(((CH(cr_18,a_23),SH(sr_13,nego(TLS12,RSA(StrongRSADecryption),a_26,a_27,a_28))),CRT(pk(a_32))),CKE(rsa_enc(pk(a_32),e2b(BadElement))))),tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13))) at {193} in copy a_35

event MatchingResumptionSecret(TLS12,cr_18,sr_13,pk(k_5),TLS12,cr_18,sr_13,pk(a_32)) at {192} in copy a_35 (goal)

The event MatchingResumptionSecret(TLS12,cr_18,sr_13,pk(k_5),TLS12,cr_18,sr_13,pk(a_32)) is executed at {192} in copy a_35.
A trace has been found.
RESULT not event(MatchingResumptionSecret(TLS12,cr_18,sr_12,p_7,TLS12,cr'_5,sr'_3,p'_3)) is false.
-- Query not event(MatchingAEKey(TLS12,cr_18,sr_12,p_7,TLS12,cr'_5,sr'_3,p'_3)) in process 0.
Completing...
200 rules inserted. The rule base contains 200 rules. 137 rules in the queue.
400 rules inserted. The rule base contains 393 rules. 68 rules in the queue.
600 rules inserted. The rule base contains 505 rules. 166 rules in the queue.
800 rules inserted. The rule base contains 558 rules. 179 rules in the queue.
1000 rules inserted. The rule base contains 599 rules. 197 rules in the queue.
1200 rules inserted. The rule base contains 671 rules. 222 rules in the queue.
1400 rules inserted. The rule base contains 717 rules. 216 rules in the queue.
1600 rules inserted. The rule base contains 748 rules. 222 rules in the queue.
1800 rules inserted. The rule base contains 817 rules. 197 rules in the queue.
2000 rules inserted. The rule base contains 884 rules. 296 rules in the queue.
2200 rules inserted. The rule base contains 1002 rules. 294 rules in the queue.
2400 rules inserted. The rule base contains 1120 rules. 306 rules in the queue.
2600 rules inserted. The rule base contains 1232 rules. 291 rules in the queue.
2800 rules inserted. The rule base contains 1364 rules. 232 rules in the queue.
3000 rules inserted. The rule base contains 1497 rules. 242 rules in the queue.
3200 rules inserted. The rule base contains 1591 rules. 177 rules in the queue.
3400 rules inserted. The rule base contains 1647 rules. 111 rules in the queue.
3600 rules inserted. The rule base contains 1600 rules. 45 rules in the queue.
3800 rules inserted. The rule base contains 1729 rules. 22 rules in the queue.
Starting query not event(MatchingAEKey(TLS12,cr_18,sr_12,p_7,TLS12,cr'_5,sr'_3,p'_3))
goal reachable: k_4 ≠ k_5 && attacker(k_4) && attacker(sn_2) && attacker(xxx_2) && attacker(hhh'_3) && attacker(aaa'_3) && attacker(ppp'_3) && attacker(o'_5) -> end(MatchingAEKey(TLS12,cr_18,sr_12,pk(k_5),TLS12,cr_18,sr_12,pk(k_4)))
Abbreviations:
k_5 = k_2[a_2 = sn_2,!1 = @sid]
cr_18 = cr[!1 = @sid_1]
sr_12 = sr_1[mode_1 = nego(TLS12,RSA(StrongRSADecryption),hhh'_3,aaa'_3,ppp'_3),xxx_1 = xxx_2,offer_1 = o'_5,cr_1 = cr_18,!1 = @sid_2]

Derivation:
Abbreviations:
cr_18 = cr[!1 = @sid]
sr_12 = sr_1[mode_1 = nego(TLS12,RSA(StrongRSADecryption),hhh'_3,aaa'_3,ppp'_3),xxx_1 = xxx_2,offer_1 = o'_5,cr_1 = cr_18,!1 = @sid_1]
k_4 = k_2[a_2 = sn_2,!1 = @sid_2]
x_4 = x_3[p_1 = pk(k_4),sk_2 = k_4,sn_1 = sn_2,mode_1 = nego(TLS12,DHE(StrongDH),WeakHash,a_13,pt_9),xxx_1 = xxx_3,offer_1 = offer_2,cr_1 = cr_19,!1 = @sid_3]

1. The attacker has some term o_16.
attacker(o_16).

2. The attacker has some term ppp_5.
attacker(ppp_5).

3. The attacker has some term aaa_5.
attacker(aaa_5).

4. Using the function WeakHash the attacker may obtain WeakHash.
attacker(WeakHash).

5. Using the function WeakDH the attacker may obtain WeakDH.
attacker(WeakDH).

6. By 5, the attacker may know WeakDH.
Using the function DHE the attacker may obtain DHE(WeakDH).
attacker(DHE(WeakDH)).

7. Using the function TLS12 the attacker may obtain TLS12.
attacker(TLS12).

8. By 7, the attacker may know TLS12.
By 6, the attacker may know DHE(WeakDH).
By 4, the attacker may know WeakHash.
By 3, the attacker may know aaa_5.
By 2, the attacker may know ppp_5.
Using the function nego the attacker may obtain nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5).
attacker(nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5)).

9. We assume as hypothesis that
attacker(o'_5).

10. The attacker has some term offer_3.
attacker(offer_3).

11. The message offer_3 that the attacker may have by 10 may be received at input {3}.
So the message CH(cr_18,offer_3) may be sent to the attacker at output {4}.
attacker(CH(cr_18,offer_3)).

12. By 11, the attacker may know CH(cr_18,offer_3).
Using the function 1-proj-CH the attacker may obtain cr_18.
attacker(cr_18).

13. By 12, the attacker may know cr_18.
By 9, the attacker may know o'_5.
Using the function CH the attacker may obtain CH(cr_18,o'_5).
attacker(CH(cr_18,o'_5)).

14. We assume as hypothesis that
attacker(ppp'_3).

15. We assume as hypothesis that
attacker(aaa'_3).

16. We assume as hypothesis that
attacker(hhh'_3).

17. Using the function StrongRSADecryption the attacker may obtain StrongRSADecryption.
attacker(StrongRSADecryption).

18. By 17, the attacker may know StrongRSADecryption.
Using the function RSA the attacker may obtain RSA(StrongRSADecryption).
attacker(RSA(StrongRSADecryption)).

19. By 7, the attacker may know TLS12.
By 18, the attacker may know RSA(StrongRSADecryption).
By 16, the attacker may know hhh'_3.
By 15, the attacker may know aaa'_3.
By 14, the attacker may know ppp'_3.
Using the function nego the attacker may obtain nego(TLS12,RSA(StrongRSADecryption),hhh'_3,aaa'_3,ppp'_3).
attacker(nego(TLS12,RSA(StrongRSADecryption),hhh'_3,aaa'_3,ppp'_3)).

20. We assume as hypothesis that
attacker(xxx_2).

21. By 20, the attacker may know xxx_2.
By 19, the attacker may know nego(TLS12,RSA(StrongRSADecryption),hhh'_3,aaa'_3,ppp'_3).
Using the function SH the attacker may obtain SH(xxx_2,nego(TLS12,RSA(StrongRSADecryption),hhh'_3,aaa'_3,ppp'_3)).
attacker(SH(xxx_2,nego(TLS12,RSA(StrongRSADecryption),hhh'_3,aaa'_3,ppp'_3))).

22. The message CH(cr_18,o'_5) that the attacker may have by 13 may be received at input {47}.
The message SH(xxx_2,nego(TLS12,RSA(StrongRSADecryption),hhh'_3,aaa'_3,ppp'_3)) that the attacker may have by 21 may be received at input {48}.
So the message SH(sr_12,nego(TLS12,RSA(StrongRSADecryption),hhh'_3,aaa'_3,ppp'_3)) may be sent to the attacker at output {52}.
attacker(SH(sr_12,nego(TLS12,RSA(StrongRSADecryption),hhh'_3,aaa'_3,ppp'_3))).

23. By 22, the attacker may know SH(sr_12,nego(TLS12,RSA(StrongRSADecryption),hhh'_3,aaa'_3,ppp'_3)).
Using the function 1-proj-SH the attacker may obtain sr_12.
attacker(sr_12).

24. By 23, the attacker may know sr_12.
By 8, the attacker may know nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5).
Using the function SH the attacker may obtain SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5)).
attacker(SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))).

25. We assume as hypothesis that
attacker(sn_2).

26. The message sn_2 that the attacker may have by 25 may be received at input {104}.
So the message pk(k_4) may be sent to the attacker at output {107}.
attacker(pk(k_4)).

27. By 26, the attacker may know pk(k_4).
Using the function CRT the attacker may obtain CRT(pk(k_4)).
attacker(CRT(pk(k_4))).

28. The message sn_2 that the attacker may have by 25 may be received at input {104}.
So the entry longTermKeys_tbl(sn_2,k_4,pk(k_4)) may be inserted in a table at insert {106}.
table(longTermKeys_tbl(sn_2,k_4,pk(k_4))).

29. The attacker has some term offer_2.
attacker(offer_2).

30. The attacker has some term cr_19.
attacker(cr_19).

31. By 30, the attacker may know cr_19.
By 29, the attacker may know offer_2.
Using the function CH the attacker may obtain CH(cr_19,offer_2).
attacker(CH(cr_19,offer_2)).

32. The attacker has some term pt_9.
attacker(pt_9).

33. The attacker has some term a_13.
attacker(a_13).

34. Using the function StrongDH the attacker may obtain StrongDH.
attacker(StrongDH).

35. By 34, the attacker may know StrongDH.
Using the function DHE the attacker may obtain DHE(StrongDH).
attacker(DHE(StrongDH)).

36. By 7, the attacker may know TLS12.
By 35, the attacker may know DHE(StrongDH).
By 4, the attacker may know WeakHash.
By 33, the attacker may know a_13.
By 32, the attacker may know pt_9.
Using the function nego the attacker may obtain nego(TLS12,DHE(StrongDH),WeakHash,a_13,pt_9).
attacker(nego(TLS12,DHE(StrongDH),WeakHash,a_13,pt_9)).

37. The attacker has some term xxx_3.
attacker(xxx_3).

38. By 37, the attacker may know xxx_3.
By 36, the attacker may know nego(TLS12,DHE(StrongDH),WeakHash,a_13,pt_9).
Using the function SH the attacker may obtain SH(xxx_3,nego(TLS12,DHE(StrongDH),WeakHash,a_13,pt_9)).
attacker(SH(xxx_3,nego(TLS12,DHE(StrongDH),WeakHash,a_13,pt_9))).

39. The message CH(cr_19,offer_2) that the attacker may have by 31 may be received at input {47}.
The message SH(xxx_3,nego(TLS12,DHE(StrongDH),WeakHash,a_13,pt_9)) that the attacker may have by 38 may be received at input {48}.
The entry longTermKeys_tbl(sn_2,k_4,pk(k_4)) that may be in a table by 28 may be read at get {101}.
So the message SKE(StrongDH,dh_ideal(G,x_4),sign(k_4,collision)) may be sent to the attacker at output {65}.
attacker(SKE(StrongDH,dh_ideal(G,x_4),sign(k_4,collision))).

40. By 39, the attacker may know SKE(StrongDH,dh_ideal(G,x_4),sign(k_4,collision)).
Using the function 3-proj-SKE the attacker may obtain sign(k_4,collision).
attacker(sign(k_4,collision)).

41. The attacker has some term e_1.
attacker(e_1).

42. By 5, the attacker may know WeakDH.
By 41, the attacker may know e_1.
By 40, the attacker may know sign(k_4,collision).
Using the function SKE the attacker may obtain SKE(WeakDH,e_1,sign(k_4,collision)).
attacker(SKE(WeakDH,e_1,sign(k_4,collision))).

43. Using the function BadElement the attacker may obtain BadElement.
attacker(BadElement).

44. By 43, the attacker may know BadElement.
Using the function e2b the attacker may obtain e2b(BadElement).
attacker(e2b(BadElement)).

45. By 44, the attacker may know e2b(BadElement).
Using the function CKE the attacker may obtain CKE(e2b(BadElement)).
attacker(CKE(e2b(BadElement))).

46. By 12, the attacker may know cr_18.
By 1, the attacker may know o_16.
Using the function CH the attacker may obtain CH(cr_18,o_16).
attacker(CH(cr_18,o_16)).

47. By 46, the attacker may know CH(cr_18,o_16).
By 24, the attacker may know SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5)).
Using the function 2-tuple the attacker may obtain (CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))).
attacker((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5)))).

48. By 47, the attacker may know (CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))).
By 27, the attacker may know CRT(pk(k_4)).
Using the function 2-tuple the attacker may obtain ((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))).
attacker(((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4)))).

49. By 48, the attacker may know ((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))).
By 42, the attacker may know SKE(WeakDH,e_1,sign(k_4,collision)).
Using the function 2-tuple the attacker may obtain (((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))).
attacker((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision)))).

50. By 49, the attacker may know (((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))).
By 45, the attacker may know CKE(e2b(BadElement)).
Using the function 2-tuple the attacker may obtain ((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))).
attacker(((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement)))).

51. Using the function client_finished the attacker may obtain client_finished.
attacker(client_finished).

52. By 12, the attacker may know cr_18.
By 23, the attacker may know sr_12.
Using the function 2-tuple the attacker may obtain (cr_18,sr_12).
attacker((cr_18,sr_12)).

53. Using the function master_secret the attacker may obtain master_secret.
attacker(master_secret).

54. By 44, the attacker may know e2b(BadElement).
By 53, the attacker may know master_secret.
By 52, the attacker may know (cr_18,sr_12).
Using the function tls12_prf the attacker may obtain tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)).
attacker(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12))).

55. By 54, the attacker may know tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)).
By 51, the attacker may know client_finished.
By 50, the attacker may know ((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))).
Using the function tls12_prf the attacker may obtain tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement)))).
attacker(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))))).

56. By 55, the attacker may know tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement)))).
Using the function FIN the attacker may obtain FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))))).
attacker(FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement)))))).

57. By 50, the attacker may know ((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))).
By 56, the attacker may know FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))))).
Using the function 2-tuple the attacker may obtain (((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement)))))).
attacker((((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))))))).

58. Using the function server_finished the attacker may obtain server_finished.
attacker(server_finished).

59. By 54, the attacker may know tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)).
By 58, the attacker may know server_finished.
By 57, the attacker may know (((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement)))))).
Using the function tls12_prf the attacker may obtain tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),server_finished,(((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))))))).
attacker(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),server_finished,(((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement)))))))).

60. By 59, the attacker may know tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),server_finished,(((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))))))).
Using the function FIN the attacker may obtain FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),server_finished,(((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement)))))))).
attacker(FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),server_finished,(((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))))))))).

61. The message o_16 that the attacker may have by 1 may be received at input {3}.
The message SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5)) that the attacker may have by 24 may be received at input {5}.
The message CRT(pk(k_4)) that the attacker may have by 27 may be received at input {9}.
The entry longTermKeys_tbl(sn_2,k_4,pk(k_4)) that may be in a table by 28 may be read at get {45}.
The message SKE(WeakDH,e_1,sign(k_4,collision)) that the attacker may have by 42 may be received at input {12}.
The message FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),server_finished,(((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement)))))))) that the attacker may have by 60 may be received at input {25}.
So the entry clientSession(cr_18,sr_12,NoPSK,pk(k_4),o_16,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_key_expansion,(sr_12,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),server_key_expansion,(sr_12,cr_18))),tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement)))),tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12))) may be inserted in a table at insert {30}.
table(clientSession(cr_18,sr_12,NoPSK,pk(k_4),o_16,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_key_expansion,(sr_12,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),server_key_expansion,(sr_12,cr_18))),tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement)))),tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)))).

62. We assume as hypothesis that
attacker(k_5).

63. The attacker has some term sn_3.
attacker(sn_3).

64. By 63, the attacker may know sn_3.
By 62, the attacker may know k_5.
Using the function 2-tuple the attacker may obtain (sn_3,k_5).
attacker((sn_3,k_5)).

65. The message (sn_3,k_5) that the attacker may have by 64 may be received at input {108}.
So the entry longTermKeys_tbl(sn_3,k_5,pk(k_5)) may be inserted in a table at insert {110}.
table(longTermKeys_tbl(sn_3,k_5,pk(k_5))).

66. By 62, the attacker may know k_5.
Using the function pk the attacker may obtain pk(k_5).
attacker(pk(k_5)).

67. By 66, the attacker may know pk(k_5).
By 44, the attacker may know e2b(BadElement).
Using the function rsa_enc the attacker may obtain rsa_enc(pk(k_5),e2b(BadElement)).
attacker(rsa_enc(pk(k_5),e2b(BadElement))).

68. By 67, the attacker may know rsa_enc(pk(k_5),e2b(BadElement)).
Using the function CKE the attacker may obtain CKE(rsa_enc(pk(k_5),e2b(BadElement))).
attacker(CKE(rsa_enc(pk(k_5),e2b(BadElement)))).

69. By 66, the attacker may know pk(k_5).
Using the function CRT the attacker may obtain CRT(pk(k_5)).
attacker(CRT(pk(k_5))).

70. By 13, the attacker may know CH(cr_18,o'_5).
By 22, the attacker may know SH(sr_12,nego(TLS12,RSA(StrongRSADecryption),hhh'_3,aaa'_3,ppp'_3)).
Using the function 2-tuple the attacker may obtain (CH(cr_18,o'_5),SH(sr_12,nego(TLS12,RSA(StrongRSADecryption),hhh'_3,aaa'_3,ppp'_3))).
attacker((CH(cr_18,o'_5),SH(sr_12,nego(TLS12,RSA(StrongRSADecryption),hhh'_3,aaa'_3,ppp'_3)))).

71. By 70, the attacker may know (CH(cr_18,o'_5),SH(sr_12,nego(TLS12,RSA(StrongRSADecryption),hhh'_3,aaa'_3,ppp'_3))).
By 69, the attacker may know CRT(pk(k_5)).
Using the function 2-tuple the attacker may obtain ((CH(cr_18,o'_5),SH(sr_12,nego(TLS12,RSA(StrongRSADecryption),hhh'_3,aaa'_3,ppp'_3))),CRT(pk(k_5))).
attacker(((CH(cr_18,o'_5),SH(sr_12,nego(TLS12,RSA(StrongRSADecryption),hhh'_3,aaa'_3,ppp'_3))),CRT(pk(k_5)))).

72. By 71, the attacker may know ((CH(cr_18,o'_5),SH(sr_12,nego(TLS12,RSA(StrongRSADecryption),hhh'_3,aaa'_3,ppp'_3))),CRT(pk(k_5))).
By 68, the attacker may know CKE(rsa_enc(pk(k_5),e2b(BadElement))).
Using the function 2-tuple the attacker may obtain (((CH(cr_18,o'_5),SH(sr_12,nego(TLS12,RSA(StrongRSADecryption),hhh'_3,aaa'_3,ppp'_3))),CRT(pk(k_5))),CKE(rsa_enc(pk(k_5),e2b(BadElement)))).
attacker((((CH(cr_18,o'_5),SH(sr_12,nego(TLS12,RSA(StrongRSADecryption),hhh'_3,aaa'_3,ppp'_3))),CRT(pk(k_5))),CKE(rsa_enc(pk(k_5),e2b(BadElement))))).

73. By 54, the attacker may know tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)).
By 51, the attacker may know client_finished.
By 72, the attacker may know (((CH(cr_18,o'_5),SH(sr_12,nego(TLS12,RSA(StrongRSADecryption),hhh'_3,aaa'_3,ppp'_3))),CRT(pk(k_5))),CKE(rsa_enc(pk(k_5),e2b(BadElement)))).
Using the function tls12_prf the attacker may obtain tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,(((CH(cr_18,o'_5),SH(sr_12,nego(TLS12,RSA(StrongRSADecryption),hhh'_3,aaa'_3,ppp'_3))),CRT(pk(k_5))),CKE(rsa_enc(pk(k_5),e2b(BadElement))))).
attacker(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,(((CH(cr_18,o'_5),SH(sr_12,nego(TLS12,RSA(StrongRSADecryption),hhh'_3,aaa'_3,ppp'_3))),CRT(pk(k_5))),CKE(rsa_enc(pk(k_5),e2b(BadElement)))))).

74. By 73, the attacker may know tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,(((CH(cr_18,o'_5),SH(sr_12,nego(TLS12,RSA(StrongRSADecryption),hhh'_3,aaa'_3,ppp'_3))),CRT(pk(k_5))),CKE(rsa_enc(pk(k_5),e2b(BadElement))))).
Using the function FIN the attacker may obtain FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,(((CH(cr_18,o'_5),SH(sr_12,nego(TLS12,RSA(StrongRSADecryption),hhh'_3,aaa'_3,ppp'_3))),CRT(pk(k_5))),CKE(rsa_enc(pk(k_5),e2b(BadElement)))))).
attacker(FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,(((CH(cr_18,o'_5),SH(sr_12,nego(TLS12,RSA(StrongRSADecryption),hhh'_3,aaa'_3,ppp'_3))),CRT(pk(k_5))),CKE(rsa_enc(pk(k_5),e2b(BadElement))))))).

75. The message CH(cr_18,o'_5) that the attacker may have by 13 may be received at input {47}.
The message SH(xxx_2,nego(TLS12,RSA(StrongRSADecryption),hhh'_3,aaa'_3,ppp'_3)) that the attacker may have by 21 may be received at input {48}.
The entry longTermKeys_tbl(sn_3,k_5,pk(k_5)) that may be in a table by 65 may be read at get {101}.
The message CKE(rsa_enc(pk(k_5),e2b(BadElement))) that the attacker may have by 68 may be received at input {84}.
The message FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,(((CH(cr_18,o'_5),SH(sr_12,nego(TLS12,RSA(StrongRSADecryption),hhh'_3,aaa'_3,ppp'_3))),CRT(pk(k_5))),CKE(rsa_enc(pk(k_5),e2b(BadElement)))))) that the attacker may have by 74 may be received at input {89}.
So the entry serverSession(cr_18,sr_12,NoPSK,pk(k_5),o'_5,nego(TLS12,RSA(StrongRSADecryption),hhh'_3,aaa'_3,ppp'_3),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_key_expansion,(sr_12,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),server_key_expansion,(sr_12,cr_18))),tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,(((CH(cr_18,o'_5),SH(sr_12,nego(TLS12,RSA(StrongRSADecryption),hhh'_3,aaa'_3,ppp'_3))),CRT(pk(k_5))),CKE(rsa_enc(pk(k_5),e2b(BadElement))))),tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12))) may be inserted in a table at insert {97}.
table(serverSession(cr_18,sr_12,NoPSK,pk(k_5),o'_5,nego(TLS12,RSA(StrongRSADecryption),hhh'_3,aaa'_3,ppp'_3),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_key_expansion,(sr_12,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),server_key_expansion,(sr_12,cr_18))),tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,(((CH(cr_18,o'_5),SH(sr_12,nego(TLS12,RSA(StrongRSADecryption),hhh'_3,aaa'_3,ppp'_3))),CRT(pk(k_5))),CKE(rsa_enc(pk(k_5),e2b(BadElement))))),tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)))).

76. The entry clientSession(cr_18,sr_12,NoPSK,pk(k_4),o_16,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_key_expansion,(sr_12,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),server_key_expansion,(sr_12,cr_18))),tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement)))),tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12))) that may be in a table by 61 may be read at get {200}.
The entry serverSession(cr_18,sr_12,NoPSK,pk(k_5),o'_5,nego(TLS12,RSA(StrongRSADecryption),hhh'_3,aaa'_3,ppp'_3),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_key_expansion,(sr_12,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),server_key_expansion,(sr_12,cr_18))),tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,(((CH(cr_18,o'_5),SH(sr_12,nego(TLS12,RSA(StrongRSADecryption),hhh'_3,aaa'_3,ppp'_3))),CRT(pk(k_5))),CKE(rsa_enc(pk(k_5),e2b(BadElement))))),tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12))) that may be in a table by 75 may be read at get {199}.
We have pk(k_4) ≠ pk(k_5).
So event MatchingAEKey(TLS12,cr_18,sr_12,pk(k_4),TLS12,cr_18,sr_12,pk(k_5)) may be executed at {198}.
end(MatchingAEKey(TLS12,cr_18,sr_12,pk(k_4),TLS12,cr_18,sr_12,pk(k_5))).

77. By 76, end(MatchingAEKey(TLS12,cr_18,sr_12,pk(k_4),TLS12,cr_18,sr_12,pk(k_5))).
The goal is reached, represented in the following fact:
end(MatchingAEKey(TLS12,cr_18,sr_12,pk(k_4),TLS12,cr_18,sr_12,pk(k_5))).


Unified offer_2 with o_16
Iterating unifyDerivation.
Fixpoint reached: nothing more to unify.
The clause after unifyDerivation is
k_4 ≠ k_2[a_2 = sn_2,!1 = @sid] && attacker(o'_5) && attacker(ppp'_3) && attacker(aaa'_3) && attacker(hhh'_3) && attacker(xxx_2) && attacker(sn_2) && attacker(k_4) -> end(MatchingAEKey(TLS12,cr[!1 = @sid_1],sr_1[mode_1 = nego(TLS12,RSA(StrongRSADecryption),hhh'_3,aaa'_3,ppp'_3),xxx_1 = xxx_2,offer_1 = o'_5,cr_1 = cr[!1 = @sid_1],!1 = @sid_2],pk(k_2[a_2 = sn_2,!1 = @sid]),TLS12,cr[!1 = @sid_1],sr_1[mode_1 = nego(TLS12,RSA(StrongRSADecryption),hhh'_3,aaa'_3,ppp'_3),xxx_1 = xxx_2,offer_1 = o'_5,cr_1 = cr[!1 = @sid_1],!1 = @sid_2],pk(k_4)))
This clause still contradicts the query.
A more detailed output of the traces is available with
  set traceDisplay = long.

event WeakOrCompromisedKey(NoPubKey) at {103} in copy a_13

event WeakOrCompromisedKey(NoPubKey) at {103} in copy a_14

new cr: random creating cr_18 at {2} in copy a_15

in(io, a_16) at {3} in copy a_15

out(io, CH(~M,~M_1)) with ~M = cr_18, ~M_1 = a_16 at {4} in copy a_15

in(io, CH(a_17,a_18)) at {47} in copy a_19

in(io, SH(a_20,nego(TLS12,DHE(StrongDH),WeakHash,a_21,a_22))) at {48} in copy a_19

new sr_1: random creating sr_12 at {51} in copy a_19

out(io, SH(~M_2,nego(~M_3,DHE(StrongDH),WeakHash,~M_4,~M_5))) with ~M_2 = sr_12, ~M_3 = TLS12, ~M_4 = a_21, ~M_5 = a_22 at {52} in copy a_19

in(io, CH(~M,a_23)) with ~M = cr_18 at {47} in copy a_24

in(io, SH(a_25,nego(TLS12,RSA(StrongRSADecryption),a_26,a_27,a_28))) at {48} in copy a_24

new sr_1: random creating sr_13 at {51} in copy a_24

out(io, SH(~M_6,nego(~M_7,RSA(~M_8),~M_9,~M_10,~M_11))) with ~M_6 = sr_13, ~M_7 = TLS12, ~M_8 = StrongRSADecryption, ~M_9 = a_26, ~M_10 = a_27, ~M_11 = a_28 at {52} in copy a_24

in(io, SH(~M_6,nego(TLS12,DHE(WeakDH),WeakHash,a_29,a_30))) with ~M_6 = sr_13 at {5} in copy a_15

in(io, (a_31,a_32)) at {108} in copy a_14

event WeakOrCompromisedKey(pk(a_32)) at {109} in copy a_14

insert longTermKeys_tbl(a_31,a_32,pk(a_32)) at {110} in copy a_14

get longTermKeys_tbl(a_31,a_32,pk(a_32)) at {101} in copy a_24

event ServerChoosesVersion(cr_18,sr_13,pk(a_32),TLS12) at {54} in copy a_24

event ServerChoosesKEX(cr_18,sr_13,pk(a_32),TLS12,RSA(StrongRSADecryption)) at {55} in copy a_24

event ServerChoosesAE(cr_18,sr_13,pk(a_32),TLS12,a_27) at {56} in copy a_24

event ServerChoosesHash(cr_18,sr_13,pk(a_32),TLS12,a_26) at {57} in copy a_24

out(io, CRT(~M_12)) with ~M_12 = pk(a_32) at {58} in copy a_24

in(io, CKE(rsa_enc(pk(a_32),e2b(BadElement)))) at {84} in copy a_24

out(io, ~M_13) with ~M_13 = zero at {87} in copy a_24

in(io, FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(~M,~M_6)),client_finished,(((CH(~M,a_23),SH(~M_6,nego(TLS12,RSA(StrongRSADecryption),a_26,a_27,a_28))),CRT(pk(a_32))),CKE(rsa_enc(pk(a_32),e2b(BadElement))))))) with tls12_prf(tls12_prf(e2b(BadElement),master_secret,(~M,~M_6)),client_finished,(((CH(~M,a_23),SH(~M_6,nego(TLS12,RSA(StrongRSADecryption),a_26,a_27,a_28))),CRT(pk(a_32))),CKE(rsa_enc(pk(a_32),e2b(BadElement))))) = tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_finished,(((CH(cr_18,a_23),SH(sr_13,nego(TLS12,RSA(StrongRSADecryption),a_26,a_27,a_28))),CRT(pk(a_32))),CKE(rsa_enc(pk(a_32),e2b(BadElement))))) at {89} in copy a_24

event ServerFinished(TLS12,cr_18,sr_13,NoPSK,pk(a_32),a_23,nego(TLS12,RSA(StrongRSADecryption),a_26,a_27,a_28),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_key_expansion,(sr_13,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),server_key_expansion,(sr_13,cr_18))),tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_finished,(((CH(cr_18,a_23),SH(sr_13,nego(TLS12,RSA(StrongRSADecryption),a_26,a_27,a_28))),CRT(pk(a_32))),CKE(rsa_enc(pk(a_32),e2b(BadElement))))),tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13))) at {95} in copy a_24

out(io, FIN(~M_14)) with ~M_14 = tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),server_finished,((((CH(cr_18,a_23),SH(sr_13,nego(TLS12,RSA(StrongRSADecryption),a_26,a_27,a_28))),CRT(pk(a_32))),CKE(rsa_enc(pk(a_32),e2b(BadElement)))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_finished,(((CH(cr_18,a_23),SH(sr_13,nego(TLS12,RSA(StrongRSADecryption),a_26,a_27,a_28))),CRT(pk(a_32))),CKE(rsa_enc(pk(a_32),e2b(BadElement)))))))) at {96} in copy a_24

insert serverSession(cr_18,sr_13,NoPSK,pk(a_32),a_23,nego(TLS12,RSA(StrongRSADecryption),a_26,a_27,a_28),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_key_expansion,(sr_13,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),server_key_expansion,(sr_13,cr_18))),tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_finished,(((CH(cr_18,a_23),SH(sr_13,nego(TLS12,RSA(StrongRSADecryption),a_26,a_27,a_28))),CRT(pk(a_32))),CKE(rsa_enc(pk(a_32),e2b(BadElement))))),tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13))) at {97} in copy a_24

in(io, a_33) at {104} in copy a_13

new k_2: privkey creating k_5 at {105} in copy a_13

insert longTermKeys_tbl(a_33,k_5,pk(k_5)) at {106} in copy a_13

out(io, ~M_15) with ~M_15 = pk(k_5) at {107} in copy a_13

in(io, CRT(~M_15)) with ~M_15 = pk(k_5) at {9} in copy a_15

get longTermKeys_tbl(a_33,k_5,pk(k_5)) at {45} in copy a_15

get longTermKeys_tbl(a_33,k_5,pk(k_5)) at {101} in copy a_19

event ServerChoosesVersion(a_17,sr_12,pk(k_5),TLS12) at {54} in copy a_19

event ServerChoosesKEX(a_17,sr_12,pk(k_5),TLS12,DHE(StrongDH)) at {55} in copy a_19

event ServerChoosesAE(a_17,sr_12,pk(k_5),TLS12,a_21) at {56} in copy a_19

event ServerChoosesHash(a_17,sr_12,pk(k_5),TLS12,WeakHash) at {57} in copy a_19

out(io, CRT(~M_16)) with ~M_16 = pk(k_5) at {58} in copy a_19

new x_3: bitstring creating x_4 at {61} in copy a_19

out(io, SKE(StrongDH,~M_17,~M_18)) with ~M_17 = dh_ideal(G,x_4), ~M_18 = sign(k_5,collision) at {65} in copy a_19

in(io, SKE(WeakDH,a_34,~M_18)) with ~M_18 = sign(k_5,collision) at {12} in copy a_15

new x_1: bitstring creating x_5 at {15} in copy a_15

out(io, CKE(e2b(BadElement))) at {20} in copy a_15

out(io, FIN(~M_19)) with ~M_19 = tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_finished,((((CH(cr_18,a_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,a_29,a_30))),CRT(pk(k_5))),SKE(WeakDH,a_34,sign(k_5,collision))),CKE(e2b(BadElement)))) at {23} in copy a_15

in(io, FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(~M,~M_6)),server_finished,(((((CH(~M,a_16),SH(~M_6,nego(TLS12,DHE(WeakDH),WeakHash,a_29,a_30))),CRT(~M_15)),SKE(WeakDH,a_34,~M_18)),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(~M,~M_6)),client_finished,((((CH(~M,a_16),SH(~M_6,nego(TLS12,DHE(WeakDH),WeakHash,a_29,a_30))),CRT(~M_15)),SKE(WeakDH,a_34,~M_18)),CKE(e2b(BadElement))))))))) with tls12_prf(tls12_prf(e2b(BadElement),master_secret,(~M,~M_6)),server_finished,(((((CH(~M,a_16),SH(~M_6,nego(TLS12,DHE(WeakDH),WeakHash,a_29,a_30))),CRT(~M_15)),SKE(WeakDH,a_34,~M_18)),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(~M,~M_6)),client_finished,((((CH(~M,a_16),SH(~M_6,nego(TLS12,DHE(WeakDH),WeakHash,a_29,a_30))),CRT(~M_15)),SKE(WeakDH,a_34,~M_18)),CKE(e2b(BadElement))))))) = tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),server_finished,(((((CH(cr_18,a_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,a_29,a_30))),CRT(pk(k_5))),SKE(WeakDH,a_34,sign(k_5,collision))),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_finished,((((CH(cr_18,a_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,a_29,a_30))),CRT(pk(k_5))),SKE(WeakDH,a_34,sign(k_5,collision))),CKE(e2b(BadElement))))))) at {25} in copy a_15

event ClientFinished(TLS12,cr_18,sr_13,NoPSK,pk(k_5),a_16,nego(TLS12,DHE(WeakDH),WeakHash,a_29,a_30),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_key_expansion,(sr_13,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),server_key_expansion,(sr_13,cr_18))),tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_finished,((((CH(cr_18,a_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,a_29,a_30))),CRT(pk(k_5))),SKE(WeakDH,a_34,sign(k_5,collision))),CKE(e2b(BadElement)))),tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13))) at {29} in copy a_15

insert clientSession(cr_18,sr_13,NoPSK,pk(k_5),a_16,nego(TLS12,DHE(WeakDH),WeakHash,a_29,a_30),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_key_expansion,(sr_13,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),server_key_expansion,(sr_13,cr_18))),tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_finished,((((CH(cr_18,a_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,a_29,a_30))),CRT(pk(k_5))),SKE(WeakDH,a_34,sign(k_5,collision))),CKE(e2b(BadElement)))),tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13))) at {30} in copy a_15

get clientSession(cr_18,sr_13,NoPSK,pk(k_5),a_16,nego(TLS12,DHE(WeakDH),WeakHash,a_29,a_30),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_key_expansion,(sr_13,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),server_key_expansion,(sr_13,cr_18))),tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_finished,((((CH(cr_18,a_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,a_29,a_30))),CRT(pk(k_5))),SKE(WeakDH,a_34,sign(k_5,collision))),CKE(e2b(BadElement)))),tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13))) at {200} in copy a_35

get serverSession(cr_18,sr_13,NoPSK,pk(a_32),a_23,nego(TLS12,RSA(StrongRSADecryption),a_26,a_27,a_28),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_key_expansion,(sr_13,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),server_key_expansion,(sr_13,cr_18))),tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_finished,(((CH(cr_18,a_23),SH(sr_13,nego(TLS12,RSA(StrongRSADecryption),a_26,a_27,a_28))),CRT(pk(a_32))),CKE(rsa_enc(pk(a_32),e2b(BadElement))))),tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13))) at {199} in copy a_35

event MatchingAEKey(TLS12,cr_18,sr_13,pk(k_5),TLS12,cr_18,sr_13,pk(a_32)) at {198} in copy a_35 (goal)

The event MatchingAEKey(TLS12,cr_18,sr_13,pk(k_5),TLS12,cr_18,sr_13,pk(a_32)) is executed at {198} in copy a_35.
A trace has been found.
RESULT not event(MatchingAEKey(TLS12,cr_18,sr_12,p_7,TLS12,cr'_5,sr'_3,p'_3)) is false.
-- Query event(ClientAEKeyLeaked(TLS12,cr_18,sr_12,psk_16,p_7)) ==> event(WeakOrCompromisedKey(p_7)) || event(ServerChoosesKEX(cr_18,sr_12,p_7,TLS12,DHE(WeakDH))) || event(ServerChoosesKEX(cr'_5,sr'_3,p_7,TLS12,RSA(WeakRSADecryption))) in process 0.
Completing...
200 rules inserted. The rule base contains 200 rules. 132 rules in the queue.
400 rules inserted. The rule base contains 389 rules. 75 rules in the queue.
600 rules inserted. The rule base contains 507 rules. 184 rules in the queue.
800 rules inserted. The rule base contains 576 rules. 187 rules in the queue.
1000 rules inserted. The rule base contains 623 rules. 232 rules in the queue.
1200 rules inserted. The rule base contains 684 rules. 264 rules in the queue.
1400 rules inserted. The rule base contains 765 rules. 317 rules in the queue.
1600 rules inserted. The rule base contains 817 rules. 311 rules in the queue.
1800 rules inserted. The rule base contains 870 rules. 301 rules in the queue.
2000 rules inserted. The rule base contains 914 rules. 314 rules in the queue.
2200 rules inserted. The rule base contains 982 rules. 305 rules in the queue.
2400 rules inserted. The rule base contains 1054 rules. 305 rules in the queue.
2600 rules inserted. The rule base contains 1143 rules. 312 rules in the queue.
2800 rules inserted. The rule base contains 1242 rules. 334 rules in the queue.
3000 rules inserted. The rule base contains 1338 rules. 317 rules in the queue.
3200 rules inserted. The rule base contains 1443 rules. 302 rules in the queue.
3400 rules inserted. The rule base contains 1550 rules. 281 rules in the queue.
3600 rules inserted. The rule base contains 1666 rules. 257 rules in the queue.
3800 rules inserted. The rule base contains 1767 rules. 207 rules in the queue.
4000 rules inserted. The rule base contains 1845 rules. 147 rules in the queue.
4200 rules inserted. The rule base contains 1863 rules. 93 rules in the queue.
4400 rules inserted. The rule base contains 1906 rules. 40 rules in the queue.
4600 rules inserted. The rule base contains 2055 rules. 26 rules in the queue.
Starting query event(ClientAEKeyLeaked(TLS12,cr_18,sr_12,psk_16,p_7)) ==> event(WeakOrCompromisedKey(p_7)) || event(ServerChoosesKEX(cr_18,sr_12,p_7,TLS12,DHE(WeakDH))) || event(ServerChoosesKEX(cr'_5,sr'_3,p_7,TLS12,RSA(WeakRSADecryption)))
goal reachable: begin(ServerChoosesKEX(cr_18,sr_12,pk(k_4),TLS12,DHE(WeakDH))) && attacker(xxx_2) && attacker(a_13) && attacker(pt_9) && attacker(cr_18) && attacker(offer_2) && attacker(sn_2) && attacker(sr_13) -> end(ClientAEKeyLeaked(TLS12,cr_19,sr_13,NoPSK,pk(k_4)))
Abbreviations:
cr_19 = cr[!1 = @sid]
k_4 = k_2[a_2 = sn_2,!1 = @sid_1]
sr_12 = sr_1[mode_1 = nego(TLS12,DHE(WeakDH),WeakHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = offer_2,cr_1 = cr_18,!1 = @sid_2]

Derivation:
Abbreviations:
cr_18 = cr[!1 = @sid]
k_4 = k_2[a_2 = sn_2,!1 = @sid_1]
sr_12 = sr_1[mode_1 = nego(TLS12,DHE(WeakDH),WeakHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = offer_2,cr_1 = cr_19,!1 = @sid_2]

1. The attacker has some term o_16.
attacker(o_16).

2. The attacker has some term ppp_5.
attacker(ppp_5).

3. The attacker has some term aaa_5.
attacker(aaa_5).

4. Using the function WeakHash the attacker may obtain WeakHash.
attacker(WeakHash).

5. Using the function WeakDH the attacker may obtain WeakDH.
attacker(WeakDH).

6. By 5, the attacker may know WeakDH.
Using the function DHE the attacker may obtain DHE(WeakDH).
attacker(DHE(WeakDH)).

7. Using the function TLS12 the attacker may obtain TLS12.
attacker(TLS12).

8. By 7, the attacker may know TLS12.
By 6, the attacker may know DHE(WeakDH).
By 4, the attacker may know WeakHash.
By 3, the attacker may know aaa_5.
By 2, the attacker may know ppp_5.
Using the function nego the attacker may obtain nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5).
attacker(nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5)).

9. We assume as hypothesis that
attacker(sr_13).

10. By 9, the attacker may know sr_13.
By 8, the attacker may know nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5).
Using the function SH the attacker may obtain SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5)).
attacker(SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))).

11. We assume as hypothesis that
attacker(sn_2).

12. The message sn_2 that the attacker may have by 11 may be received at input {104}.
So the message pk(k_4) may be sent to the attacker at output {107}.
attacker(pk(k_4)).

13. By 12, the attacker may know pk(k_4).
Using the function CRT the attacker may obtain CRT(pk(k_4)).
attacker(CRT(pk(k_4))).

14. The message sn_2 that the attacker may have by 11 may be received at input {104}.
So the entry longTermKeys_tbl(sn_2,k_4,pk(k_4)) may be inserted in a table at insert {106}.
table(longTermKeys_tbl(sn_2,k_4,pk(k_4))).

15. We assume as hypothesis that
attacker(offer_2).

16. We assume as hypothesis that
attacker(cr_19).

17. By 16, the attacker may know cr_19.
By 15, the attacker may know offer_2.
Using the function CH the attacker may obtain CH(cr_19,offer_2).
attacker(CH(cr_19,offer_2)).

18. We assume as hypothesis that
attacker(pt_9).

19. We assume as hypothesis that
attacker(a_13).

20. By 7, the attacker may know TLS12.
By 6, the attacker may know DHE(WeakDH).
By 4, the attacker may know WeakHash.
By 19, the attacker may know a_13.
By 18, the attacker may know pt_9.
Using the function nego the attacker may obtain nego(TLS12,DHE(WeakDH),WeakHash,a_13,pt_9).
attacker(nego(TLS12,DHE(WeakDH),WeakHash,a_13,pt_9)).

21. We assume as hypothesis that
attacker(xxx_2).

22. By 21, the attacker may know xxx_2.
By 20, the attacker may know nego(TLS12,DHE(WeakDH),WeakHash,a_13,pt_9).
Using the function SH the attacker may obtain SH(xxx_2,nego(TLS12,DHE(WeakDH),WeakHash,a_13,pt_9)).
attacker(SH(xxx_2,nego(TLS12,DHE(WeakDH),WeakHash,a_13,pt_9))).

23. The message CH(cr_19,offer_2) that the attacker may have by 17 may be received at input {47}.
The message SH(xxx_2,nego(TLS12,DHE(WeakDH),WeakHash,a_13,pt_9)) that the attacker may have by 22 may be received at input {48}.
The entry longTermKeys_tbl(sn_2,k_4,pk(k_4)) that may be in a table by 14 may be read at get {101}.
The event ServerChoosesKEX(cr_19,sr_12,pk(k_4),TLS12,DHE(WeakDH)) may be executed at {55}.
So the message SKE(WeakDH,BadElement,sign(k_4,collision)) may be sent to the attacker at output {65}.
attacker(SKE(WeakDH,BadElement,sign(k_4,collision))).

24. By 23, the attacker may know SKE(WeakDH,BadElement,sign(k_4,collision)).
Using the function 3-proj-SKE the attacker may obtain sign(k_4,collision).
attacker(sign(k_4,collision)).

25. The attacker has some term e_1.
attacker(e_1).

26. By 5, the attacker may know WeakDH.
By 25, the attacker may know e_1.
By 24, the attacker may know sign(k_4,collision).
Using the function SKE the attacker may obtain SKE(WeakDH,e_1,sign(k_4,collision)).
attacker(SKE(WeakDH,e_1,sign(k_4,collision))).

27. Using the function BadElement the attacker may obtain BadElement.
attacker(BadElement).

28. By 27, the attacker may know BadElement.
Using the function e2b the attacker may obtain e2b(BadElement).
attacker(e2b(BadElement)).

29. By 28, the attacker may know e2b(BadElement).
Using the function CKE the attacker may obtain CKE(e2b(BadElement)).
attacker(CKE(e2b(BadElement))).

30. The attacker has some term offer_3.
attacker(offer_3).

31. The message offer_3 that the attacker may have by 30 may be received at input {3}.
So the message CH(cr_18,offer_3) may be sent to the attacker at output {4}.
attacker(CH(cr_18,offer_3)).

32. By 31, the attacker may know CH(cr_18,offer_3).
Using the function 1-proj-CH the attacker may obtain cr_18.
attacker(cr_18).

33. By 32, the attacker may know cr_18.
By 1, the attacker may know o_16.
Using the function CH the attacker may obtain CH(cr_18,o_16).
attacker(CH(cr_18,o_16)).

34. By 33, the attacker may know CH(cr_18,o_16).
By 10, the attacker may know SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5)).
Using the function 2-tuple the attacker may obtain (CH(cr_18,o_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))).
attacker((CH(cr_18,o_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5)))).

35. By 34, the attacker may know (CH(cr_18,o_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))).
By 13, the attacker may know CRT(pk(k_4)).
Using the function 2-tuple the attacker may obtain ((CH(cr_18,o_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))).
attacker(((CH(cr_18,o_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4)))).

36. By 35, the attacker may know ((CH(cr_18,o_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))).
By 26, the attacker may know SKE(WeakDH,e_1,sign(k_4,collision)).
Using the function 2-tuple the attacker may obtain (((CH(cr_18,o_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))).
attacker((((CH(cr_18,o_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision)))).

37. By 36, the attacker may know (((CH(cr_18,o_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))).
By 29, the attacker may know CKE(e2b(BadElement)).
Using the function 2-tuple the attacker may obtain ((((CH(cr_18,o_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))).
attacker(((((CH(cr_18,o_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement)))).

38. Using the function client_finished the attacker may obtain client_finished.
attacker(client_finished).

39. By 32, the attacker may know cr_18.
By 9, the attacker may know sr_13.
Using the function 2-tuple the attacker may obtain (cr_18,sr_13).
attacker((cr_18,sr_13)).

40. Using the function master_secret the attacker may obtain master_secret.
attacker(master_secret).

41. By 28, the attacker may know e2b(BadElement).
By 40, the attacker may know master_secret.
By 39, the attacker may know (cr_18,sr_13).
Using the function tls12_prf the attacker may obtain tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)).
attacker(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13))).

42. By 41, the attacker may know tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)).
By 38, the attacker may know client_finished.
By 37, the attacker may know ((((CH(cr_18,o_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))).
Using the function tls12_prf the attacker may obtain tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_finished,((((CH(cr_18,o_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement)))).
attacker(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_finished,((((CH(cr_18,o_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))))).

43. By 42, the attacker may know tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_finished,((((CH(cr_18,o_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement)))).
Using the function FIN the attacker may obtain FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_finished,((((CH(cr_18,o_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))))).
attacker(FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_finished,((((CH(cr_18,o_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement)))))).

44. By 37, the attacker may know ((((CH(cr_18,o_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))).
By 43, the attacker may know FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_finished,((((CH(cr_18,o_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))))).
Using the function 2-tuple the attacker may obtain (((((CH(cr_18,o_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_finished,((((CH(cr_18,o_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement)))))).
attacker((((((CH(cr_18,o_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_finished,((((CH(cr_18,o_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))))))).

45. Using the function server_finished the attacker may obtain server_finished.
attacker(server_finished).

46. By 41, the attacker may know tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)).
By 45, the attacker may know server_finished.
By 44, the attacker may know (((((CH(cr_18,o_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_finished,((((CH(cr_18,o_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement)))))).
Using the function tls12_prf the attacker may obtain tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),server_finished,(((((CH(cr_18,o_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_finished,((((CH(cr_18,o_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))))))).
attacker(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),server_finished,(((((CH(cr_18,o_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_finished,((((CH(cr_18,o_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement)))))))).

47. By 46, the attacker may know tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),server_finished,(((((CH(cr_18,o_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_finished,((((CH(cr_18,o_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))))))).
Using the function FIN the attacker may obtain FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),server_finished,(((((CH(cr_18,o_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_finished,((((CH(cr_18,o_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement)))))))).
attacker(FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),server_finished,(((((CH(cr_18,o_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_finished,((((CH(cr_18,o_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))))))))).

48. The message o_16 that the attacker may have by 1 may be received at input {3}.
The message SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5)) that the attacker may have by 10 may be received at input {5}.
The message CRT(pk(k_4)) that the attacker may have by 13 may be received at input {9}.
The entry longTermKeys_tbl(sn_2,k_4,pk(k_4)) that may be in a table by 14 may be read at get {45}.
The message SKE(WeakDH,e_1,sign(k_4,collision)) that the attacker may have by 26 may be received at input {12}.
The message FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),server_finished,(((((CH(cr_18,o_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_finished,((((CH(cr_18,o_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement)))))))) that the attacker may have by 47 may be received at input {25}.
So the entry clientSession(cr_18,sr_13,NoPSK,pk(k_4),o_16,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_key_expansion,(sr_13,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),server_key_expansion,(sr_13,cr_18))),tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_finished,((((CH(cr_18,o_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement)))),tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13))) may be inserted in a table at insert {30}.
table(clientSession(cr_18,sr_13,NoPSK,pk(k_4),o_16,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_key_expansion,(sr_13,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),server_key_expansion,(sr_13,cr_18))),tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_finished,((((CH(cr_18,o_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement)))),tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)))).

49. By 9, the attacker may know sr_13.
By 32, the attacker may know cr_18.
Using the function 2-tuple the attacker may obtain (sr_13,cr_18).
attacker((sr_13,cr_18)).

50. Using the function client_key_expansion the attacker may obtain client_key_expansion.
attacker(client_key_expansion).

51. By 41, the attacker may know tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)).
By 50, the attacker may know client_key_expansion.
By 49, the attacker may know (sr_13,cr_18).
Using the function tls12_prf the attacker may obtain tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_key_expansion,(sr_13,cr_18)).
attacker(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_key_expansion,(sr_13,cr_18))).

52. By 51, the attacker may know tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_key_expansion,(sr_13,cr_18)).
Using the function b2ae the attacker may obtain b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_key_expansion,(sr_13,cr_18))).
attacker(b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_key_expansion,(sr_13,cr_18)))).

53. The entry clientSession(cr_18,sr_13,NoPSK,pk(k_4),o_16,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_key_expansion,(sr_13,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),server_key_expansion,(sr_13,cr_18))),tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_finished,((((CH(cr_18,o_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement)))),tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13))) that may be in a table by 48 may be read at get {163}.
The message b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_key_expansion,(sr_13,cr_18))) that the attacker may have by 52 may be received at input {161}.
So event ClientAEKeyLeaked(TLS12,cr_18,sr_13,NoPSK,pk(k_4)) may be executed at {162}.
end(ClientAEKeyLeaked(TLS12,cr_18,sr_13,NoPSK,pk(k_4))).

54. By 53, end(ClientAEKeyLeaked(TLS12,cr_18,sr_13,NoPSK,pk(k_4))).
The goal is reached, represented in the following fact:
end(ClientAEKeyLeaked(TLS12,cr_18,sr_13,NoPSK,pk(k_4))).


Unified offer_2 with o_16
Iterating unifyDerivation.
Fixpoint reached: nothing more to unify.
The clause after unifyDerivation is
attacker(sr_12) && attacker(sn_2) && attacker(offer_3) && attacker(cr_18) && attacker(pt_9) && attacker(a_13) && attacker(xxx_2) && begin(ServerChoosesKEX(cr_18,sr_1[mode_1 = nego(TLS12,DHE(WeakDH),WeakHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = offer_3,cr_1 = cr_18,!1 = @sid],pk(k_2[a_2 = sn_2,!1 = @sid_1]),TLS12,DHE(WeakDH))) -> end(ClientAEKeyLeaked(TLS12,cr[!1 = @sid_2],sr_12,NoPSK,pk(k_2[a_2 = sn_2,!1 = @sid_1])))
This clause still contradicts the query.
A more detailed output of the traces is available with
  set traceDisplay = long.

new cr: random creating cr_19 at {2} in copy a_14

in(io, a_15) at {3} in copy a_14

out(io, CH(~M,~M_1)) with ~M = cr_19, ~M_1 = a_15 at {4} in copy a_14

in(io, SH(a_16,nego(TLS12,DHE(WeakDH),WeakHash,a_17,a_18))) at {5} in copy a_14

in(io, CH(a_19,a_20)) at {47} in copy a_21

in(io, SH(a_22,nego(TLS12,DHE(WeakDH),WeakHash,a_23,a_24))) at {48} in copy a_21

new sr_1: random creating sr_13 at {51} in copy a_21

out(io, SH(~M_2,nego(~M_3,DHE(WeakDH),WeakHash,~M_4,~M_5))) with ~M_2 = sr_13, ~M_3 = TLS12, ~M_4 = a_23, ~M_5 = a_24 at {52} in copy a_21

in(io, a_25) at {104} in copy a_26

new k_2: privkey creating k_4 at {105} in copy a_26

insert longTermKeys_tbl(a_25,k_4,pk(k_4)) at {106} in copy a_26

out(io, ~M_6) with ~M_6 = pk(k_4) at {107} in copy a_26

in(io, CRT(~M_6)) with ~M_6 = pk(k_4) at {9} in copy a_14

get longTermKeys_tbl(a_25,k_4,pk(k_4)) at {45} in copy a_14

get longTermKeys_tbl(a_25,k_4,pk(k_4)) at {101} in copy a_21

event ServerChoosesVersion(a_19,sr_13,pk(k_4),TLS12) at {54} in copy a_21

event ServerChoosesKEX(a_19,sr_13,pk(k_4),TLS12,DHE(WeakDH)) at {55} in copy a_21

event ServerChoosesAE(a_19,sr_13,pk(k_4),TLS12,a_23) at {56} in copy a_21

event ServerChoosesHash(a_19,sr_13,pk(k_4),TLS12,WeakHash) at {57} in copy a_21

out(io, CRT(~M_7)) with ~M_7 = pk(k_4) at {58} in copy a_21

new x_3: bitstring creating x_4 at {61} in copy a_21

out(io, SKE(WeakDH,BadElement,~M_8)) with ~M_8 = sign(k_4,collision) at {65} in copy a_21

in(io, SKE(WeakDH,a_27,~M_8)) with ~M_8 = sign(k_4,collision) at {12} in copy a_14

new x_1: bitstring creating x_5 at {15} in copy a_14

out(io, CKE(e2b(BadElement))) at {20} in copy a_14

out(io, FIN(~M_9)) with ~M_9 = tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_19,a_16)),client_finished,((((CH(cr_19,a_15),SH(a_16,nego(TLS12,DHE(WeakDH),WeakHash,a_17,a_18))),CRT(pk(k_4))),SKE(WeakDH,a_27,sign(k_4,collision))),CKE(e2b(BadElement)))) at {23} in copy a_14

in(io, FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(~M,a_16)),server_finished,(((((CH(~M,a_15),SH(a_16,nego(TLS12,DHE(WeakDH),WeakHash,a_17,a_18))),CRT(~M_6)),SKE(WeakDH,a_27,~M_8)),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(~M,a_16)),client_finished,((((CH(~M,a_15),SH(a_16,nego(TLS12,DHE(WeakDH),WeakHash,a_17,a_18))),CRT(~M_6)),SKE(WeakDH,a_27,~M_8)),CKE(e2b(BadElement))))))))) with tls12_prf(tls12_prf(e2b(BadElement),master_secret,(~M,a_16)),server_finished,(((((CH(~M,a_15),SH(a_16,nego(TLS12,DHE(WeakDH),WeakHash,a_17,a_18))),CRT(~M_6)),SKE(WeakDH,a_27,~M_8)),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(~M,a_16)),client_finished,((((CH(~M,a_15),SH(a_16,nego(TLS12,DHE(WeakDH),WeakHash,a_17,a_18))),CRT(~M_6)),SKE(WeakDH,a_27,~M_8)),CKE(e2b(BadElement))))))) = tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_19,a_16)),server_finished,(((((CH(cr_19,a_15),SH(a_16,nego(TLS12,DHE(WeakDH),WeakHash,a_17,a_18))),CRT(pk(k_4))),SKE(WeakDH,a_27,sign(k_4,collision))),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_19,a_16)),client_finished,((((CH(cr_19,a_15),SH(a_16,nego(TLS12,DHE(WeakDH),WeakHash,a_17,a_18))),CRT(pk(k_4))),SKE(WeakDH,a_27,sign(k_4,collision))),CKE(e2b(BadElement))))))) at {25} in copy a_14

event ClientFinished(TLS12,cr_19,a_16,NoPSK,pk(k_4),a_15,nego(TLS12,DHE(WeakDH),WeakHash,a_17,a_18),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_19,a_16)),client_key_expansion,(a_16,cr_19))),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_19,a_16)),server_key_expansion,(a_16,cr_19))),tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_19,a_16)),client_finished,((((CH(cr_19,a_15),SH(a_16,nego(TLS12,DHE(WeakDH),WeakHash,a_17,a_18))),CRT(pk(k_4))),SKE(WeakDH,a_27,sign(k_4,collision))),CKE(e2b(BadElement)))),tls12_prf(e2b(BadElement),master_secret,(cr_19,a_16))) at {29} in copy a_14

insert clientSession(cr_19,a_16,NoPSK,pk(k_4),a_15,nego(TLS12,DHE(WeakDH),WeakHash,a_17,a_18),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_19,a_16)),client_key_expansion,(a_16,cr_19))),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_19,a_16)),server_key_expansion,(a_16,cr_19))),tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_19,a_16)),client_finished,((((CH(cr_19,a_15),SH(a_16,nego(TLS12,DHE(WeakDH),WeakHash,a_17,a_18))),CRT(pk(k_4))),SKE(WeakDH,a_27,sign(k_4,collision))),CKE(e2b(BadElement)))),tls12_prf(e2b(BadElement),master_secret,(cr_19,a_16))) at {30} in copy a_14

get clientSession(cr_19,a_16,NoPSK,pk(k_4),a_15,nego(TLS12,DHE(WeakDH),WeakHash,a_17,a_18),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_19,a_16)),client_key_expansion,(a_16,cr_19))),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_19,a_16)),server_key_expansion,(a_16,cr_19))),tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_19,a_16)),client_finished,((((CH(cr_19,a_15),SH(a_16,nego(TLS12,DHE(WeakDH),WeakHash,a_17,a_18))),CRT(pk(k_4))),SKE(WeakDH,a_27,sign(k_4,collision))),CKE(e2b(BadElement)))),tls12_prf(e2b(BadElement),master_secret,(cr_19,a_16))) at {163} in copy a_28

in(io, b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(~M,a_16)),client_key_expansion,(a_16,~M)))) with tls12_prf(tls12_prf(e2b(BadElement),master_secret,(~M,a_16)),client_key_expansion,(a_16,~M)) = tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_19,a_16)),client_key_expansion,(a_16,cr_19)) at {161} in copy a_28

event ClientAEKeyLeaked(TLS12,cr_19,a_16,NoPSK,pk(k_4)) at {162} in copy a_28 (goal)

The event ClientAEKeyLeaked(TLS12,cr_19,a_16,NoPSK,pk(k_4)) is executed at {162} in copy a_28.
A trace has been found.
RESULT event(ClientAEKeyLeaked(TLS12,cr_18,sr_12,psk_16,p_7)) ==> event(WeakOrCompromisedKey(p_7)) || event(ServerChoosesKEX(cr_18,sr_12,p_7,TLS12,DHE(WeakDH))) || event(ServerChoosesKEX(cr'_5,sr'_3,p_7,TLS12,RSA(WeakRSADecryption))) is false.
-- Query event(ClientAEKeyLeaked(TLS12,cr_18,sr_12,psk_16,p_7)) ==> event(WeakOrCompromisedKey(p_7)) || event(ServerChoosesKEX(cr_18,sr_12,p_7,TLS12,DHE(WeakDH))) || event(ServerChoosesHash(cr'_5,sr'_3,p_7,TLS12,WeakHash)) in process 0.
Completing...
200 rules inserted. The rule base contains 200 rules. 132 rules in the queue.
400 rules inserted. The rule base contains 389 rules. 75 rules in the queue.
600 rules inserted. The rule base contains 507 rules. 184 rules in the queue.
800 rules inserted. The rule base contains 576 rules. 187 rules in the queue.
1000 rules inserted. The rule base contains 623 rules. 232 rules in the queue.
1200 rules inserted. The rule base contains 684 rules. 264 rules in the queue.
1400 rules inserted. The rule base contains 765 rules. 317 rules in the queue.
1600 rules inserted. The rule base contains 817 rules. 311 rules in the queue.
1800 rules inserted. The rule base contains 870 rules. 301 rules in the queue.
2000 rules inserted. The rule base contains 914 rules. 314 rules in the queue.
2200 rules inserted. The rule base contains 982 rules. 305 rules in the queue.
2400 rules inserted. The rule base contains 1054 rules. 305 rules in the queue.
2600 rules inserted. The rule base contains 1143 rules. 312 rules in the queue.
2800 rules inserted. The rule base contains 1242 rules. 334 rules in the queue.
3000 rules inserted. The rule base contains 1338 rules. 317 rules in the queue.
3200 rules inserted. The rule base contains 1443 rules. 302 rules in the queue.
3400 rules inserted. The rule base contains 1550 rules. 281 rules in the queue.
3600 rules inserted. The rule base contains 1666 rules. 257 rules in the queue.
3800 rules inserted. The rule base contains 1767 rules. 207 rules in the queue.
4000 rules inserted. The rule base contains 1845 rules. 147 rules in the queue.
4200 rules inserted. The rule base contains 1863 rules. 93 rules in the queue.
4400 rules inserted. The rule base contains 1906 rules. 40 rules in the queue.
4600 rules inserted. The rule base contains 2055 rules. 26 rules in the queue.
Starting query event(ClientAEKeyLeaked(TLS12,cr_18,sr_12,psk_16,p_7)) ==> event(WeakOrCompromisedKey(p_7)) || event(ServerChoosesKEX(cr_18,sr_12,p_7,TLS12,DHE(WeakDH))) || event(ServerChoosesHash(cr'_5,sr'_3,p_7,TLS12,WeakHash))
goal reachable: begin(ServerChoosesHash(cr_18,sr_12,pk(k_4),TLS12,h_2)) && begin(ServerChoosesKEX(cr_18,sr_12,pk(k_4),TLS12,RSA(WeakRSADecryption))) && attacker(xxx_2) && attacker(h_2) && attacker(a_13) && attacker(pt_9) && attacker(cr_18) && attacker(offer_2) && attacker(a_14) && attacker(sr_13) -> end(ClientAEKeyLeaked(TLS12,cr_19,sr_13,NoPSK,pk(k_4)))
Abbreviations:
cr_19 = cr[!1 = @sid]
k_4 = k_2[a_2 = a_14,!1 = @sid_1]
sr_12 = sr_1[mode_1 = nego(TLS12,RSA(WeakRSADecryption),h_2,a_13,pt_9),xxx_1 = xxx_2,offer_1 = offer_2,cr_1 = cr_18,!1 = @sid_2]

Derivation:
Abbreviations:
cr_18 = cr[!1 = @sid]
k_4 = k_2[a_2 = a_13,!1 = @sid_1]
sr_12 = sr_1[mode_1 = nego(TLS12,RSA(WeakRSADecryption),h_2,a_14,pt_9),xxx_1 = xxx_2,offer_1 = offer_2,cr_1 = cr_19,!1 = @sid_2]

1. The attacker has some term o_16.
attacker(o_16).

2. The attacker has some term ppp_5.
attacker(ppp_5).

3. The attacker has some term aaa_5.
attacker(aaa_5).

4. Using the function WeakHash the attacker may obtain WeakHash.
attacker(WeakHash).

5. Using the function WeakDH the attacker may obtain WeakDH.
attacker(WeakDH).

6. By 5, the attacker may know WeakDH.
Using the function DHE the attacker may obtain DHE(WeakDH).
attacker(DHE(WeakDH)).

7. Using the function TLS12 the attacker may obtain TLS12.
attacker(TLS12).

8. By 7, the attacker may know TLS12.
By 6, the attacker may know DHE(WeakDH).
By 4, the attacker may know WeakHash.
By 3, the attacker may know aaa_5.
By 2, the attacker may know ppp_5.
Using the function nego the attacker may obtain nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5).
attacker(nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5)).

9. We assume as hypothesis that
attacker(sr_13).

10. By 9, the attacker may know sr_13.
By 8, the attacker may know nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5).
Using the function SH the attacker may obtain SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5)).
attacker(SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))).

11. We assume as hypothesis that
attacker(a_13).

12. The message a_13 that the attacker may have by 11 may be received at input {104}.
So the message pk(k_4) may be sent to the attacker at output {107}.
attacker(pk(k_4)).

13. By 12, the attacker may know pk(k_4).
Using the function CRT the attacker may obtain CRT(pk(k_4)).
attacker(CRT(pk(k_4))).

14. The message a_13 that the attacker may have by 11 may be received at input {104}.
So the entry longTermKeys_tbl(a_13,k_4,pk(k_4)) may be inserted in a table at insert {106}.
table(longTermKeys_tbl(a_13,k_4,pk(k_4))).

15. We assume as hypothesis that
attacker(offer_2).

16. We assume as hypothesis that
attacker(cr_19).

17. By 16, the attacker may know cr_19.
By 15, the attacker may know offer_2.
Using the function CH the attacker may obtain CH(cr_19,offer_2).
attacker(CH(cr_19,offer_2)).

18. We assume as hypothesis that
attacker(pt_9).

19. We assume as hypothesis that
attacker(a_14).

20. We assume as hypothesis that
attacker(h_2).

21. Using the function WeakRSADecryption the attacker may obtain WeakRSADecryption.
attacker(WeakRSADecryption).

22. By 21, the attacker may know WeakRSADecryption.
Using the function RSA the attacker may obtain RSA(WeakRSADecryption).
attacker(RSA(WeakRSADecryption)).

23. By 7, the attacker may know TLS12.
By 22, the attacker may know RSA(WeakRSADecryption).
By 20, the attacker may know h_2.
By 19, the attacker may know a_14.
By 18, the attacker may know pt_9.
Using the function nego the attacker may obtain nego(TLS12,RSA(WeakRSADecryption),h_2,a_14,pt_9).
attacker(nego(TLS12,RSA(WeakRSADecryption),h_2,a_14,pt_9)).

24. We assume as hypothesis that
attacker(xxx_2).

25. By 24, the attacker may know xxx_2.
By 23, the attacker may know nego(TLS12,RSA(WeakRSADecryption),h_2,a_14,pt_9).
Using the function SH the attacker may obtain SH(xxx_2,nego(TLS12,RSA(WeakRSADecryption),h_2,a_14,pt_9)).
attacker(SH(xxx_2,nego(TLS12,RSA(WeakRSADecryption),h_2,a_14,pt_9))).

26. Using the function collision the attacker may obtain collision.
attacker(collision).

27. By 12, the attacker may know pk(k_4).
By 26, the attacker may know collision.
Using the function rsa_enc the attacker may obtain rsa_enc(pk(k_4),collision).
attacker(rsa_enc(pk(k_4),collision)).

28. By 27, the attacker may know rsa_enc(pk(k_4),collision).
Using the function CKE the attacker may obtain CKE(rsa_enc(pk(k_4),collision)).
attacker(CKE(rsa_enc(pk(k_4),collision))).

29. The message CH(cr_19,offer_2) that the attacker may have by 17 may be received at input {47}.
The message SH(xxx_2,nego(TLS12,RSA(WeakRSADecryption),h_2,a_14,pt_9)) that the attacker may have by 25 may be received at input {48}.
The entry longTermKeys_tbl(a_13,k_4,pk(k_4)) that may be in a table by 14 may be read at get {101}.
The event ServerChoosesKEX(cr_19,sr_12,pk(k_4),TLS12,RSA(WeakRSADecryption)) may be executed at {55}.
The event ServerChoosesHash(cr_19,sr_12,pk(k_4),TLS12,h_2) may be executed at {57}.
The message CKE(rsa_enc(pk(k_4),collision)) that the attacker may have by 28 may be received at input {84}.
So the message (collision,sign(k_4,collision)) may be sent to the attacker at output {87}.
attacker((collision,sign(k_4,collision))).

30. By 29, the attacker may know (collision,sign(k_4,collision)).
Using the function 2-proj-2-tuple the attacker may obtain sign(k_4,collision).
attacker(sign(k_4,collision)).

31. The attacker has some term e_1.
attacker(e_1).

32. By 5, the attacker may know WeakDH.
By 31, the attacker may know e_1.
By 30, the attacker may know sign(k_4,collision).
Using the function SKE the attacker may obtain SKE(WeakDH,e_1,sign(k_4,collision)).
attacker(SKE(WeakDH,e_1,sign(k_4,collision))).

33. Using the function BadElement the attacker may obtain BadElement.
attacker(BadElement).

34. By 33, the attacker may know BadElement.
Using the function e2b the attacker may obtain e2b(BadElement).
attacker(e2b(BadElement)).

35. By 34, the attacker may know e2b(BadElement).
Using the function CKE the attacker may obtain CKE(e2b(BadElement)).
attacker(CKE(e2b(BadElement))).

36. The attacker has some term offer_3.
attacker(offer_3).

37. The message offer_3 that the attacker may have by 36 may be received at input {3}.
So the message CH(cr_18,offer_3) may be sent to the attacker at output {4}.
attacker(CH(cr_18,offer_3)).

38. By 37, the attacker may know CH(cr_18,offer_3).
Using the function 1-proj-CH the attacker may obtain cr_18.
attacker(cr_18).

39. By 38, the attacker may know cr_18.
By 1, the attacker may know o_16.
Using the function CH the attacker may obtain CH(cr_18,o_16).
attacker(CH(cr_18,o_16)).

40. By 39, the attacker may know CH(cr_18,o_16).
By 10, the attacker may know SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5)).
Using the function 2-tuple the attacker may obtain (CH(cr_18,o_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))).
attacker((CH(cr_18,o_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5)))).

41. By 40, the attacker may know (CH(cr_18,o_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))).
By 13, the attacker may know CRT(pk(k_4)).
Using the function 2-tuple the attacker may obtain ((CH(cr_18,o_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))).
attacker(((CH(cr_18,o_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4)))).

42. By 41, the attacker may know ((CH(cr_18,o_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))).
By 32, the attacker may know SKE(WeakDH,e_1,sign(k_4,collision)).
Using the function 2-tuple the attacker may obtain (((CH(cr_18,o_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))).
attacker((((CH(cr_18,o_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision)))).

43. By 42, the attacker may know (((CH(cr_18,o_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))).
By 35, the attacker may know CKE(e2b(BadElement)).
Using the function 2-tuple the attacker may obtain ((((CH(cr_18,o_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))).
attacker(((((CH(cr_18,o_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement)))).

44. Using the function client_finished the attacker may obtain client_finished.
attacker(client_finished).

45. By 38, the attacker may know cr_18.
By 9, the attacker may know sr_13.
Using the function 2-tuple the attacker may obtain (cr_18,sr_13).
attacker((cr_18,sr_13)).

46. Using the function master_secret the attacker may obtain master_secret.
attacker(master_secret).

47. By 34, the attacker may know e2b(BadElement).
By 46, the attacker may know master_secret.
By 45, the attacker may know (cr_18,sr_13).
Using the function tls12_prf the attacker may obtain tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)).
attacker(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13))).

48. By 47, the attacker may know tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)).
By 44, the attacker may know client_finished.
By 43, the attacker may know ((((CH(cr_18,o_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))).
Using the function tls12_prf the attacker may obtain tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_finished,((((CH(cr_18,o_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement)))).
attacker(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_finished,((((CH(cr_18,o_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))))).

49. By 48, the attacker may know tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_finished,((((CH(cr_18,o_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement)))).
Using the function FIN the attacker may obtain FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_finished,((((CH(cr_18,o_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))))).
attacker(FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_finished,((((CH(cr_18,o_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement)))))).

50. By 43, the attacker may know ((((CH(cr_18,o_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))).
By 49, the attacker may know FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_finished,((((CH(cr_18,o_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))))).
Using the function 2-tuple the attacker may obtain (((((CH(cr_18,o_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_finished,((((CH(cr_18,o_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement)))))).
attacker((((((CH(cr_18,o_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_finished,((((CH(cr_18,o_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))))))).

51. Using the function server_finished the attacker may obtain server_finished.
attacker(server_finished).

52. By 47, the attacker may know tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)).
By 51, the attacker may know server_finished.
By 50, the attacker may know (((((CH(cr_18,o_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_finished,((((CH(cr_18,o_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement)))))).
Using the function tls12_prf the attacker may obtain tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),server_finished,(((((CH(cr_18,o_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_finished,((((CH(cr_18,o_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))))))).
attacker(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),server_finished,(((((CH(cr_18,o_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_finished,((((CH(cr_18,o_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement)))))))).

53. By 52, the attacker may know tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),server_finished,(((((CH(cr_18,o_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_finished,((((CH(cr_18,o_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))))))).
Using the function FIN the attacker may obtain FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),server_finished,(((((CH(cr_18,o_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_finished,((((CH(cr_18,o_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement)))))))).
attacker(FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),server_finished,(((((CH(cr_18,o_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_finished,((((CH(cr_18,o_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))))))))).

54. The message o_16 that the attacker may have by 1 may be received at input {3}.
The message SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5)) that the attacker may have by 10 may be received at input {5}.
The message CRT(pk(k_4)) that the attacker may have by 13 may be received at input {9}.
The entry longTermKeys_tbl(a_13,k_4,pk(k_4)) that may be in a table by 14 may be read at get {45}.
The message SKE(WeakDH,e_1,sign(k_4,collision)) that the attacker may have by 32 may be received at input {12}.
The message FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),server_finished,(((((CH(cr_18,o_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_finished,((((CH(cr_18,o_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement)))))))) that the attacker may have by 53 may be received at input {25}.
So the entry clientSession(cr_18,sr_13,NoPSK,pk(k_4),o_16,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_key_expansion,(sr_13,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),server_key_expansion,(sr_13,cr_18))),tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_finished,((((CH(cr_18,o_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement)))),tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13))) may be inserted in a table at insert {30}.
table(clientSession(cr_18,sr_13,NoPSK,pk(k_4),o_16,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_key_expansion,(sr_13,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),server_key_expansion,(sr_13,cr_18))),tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_finished,((((CH(cr_18,o_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement)))),tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)))).

55. By 9, the attacker may know sr_13.
By 38, the attacker may know cr_18.
Using the function 2-tuple the attacker may obtain (sr_13,cr_18).
attacker((sr_13,cr_18)).

56. Using the function client_key_expansion the attacker may obtain client_key_expansion.
attacker(client_key_expansion).

57. By 47, the attacker may know tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)).
By 56, the attacker may know client_key_expansion.
By 55, the attacker may know (sr_13,cr_18).
Using the function tls12_prf the attacker may obtain tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_key_expansion,(sr_13,cr_18)).
attacker(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_key_expansion,(sr_13,cr_18))).

58. By 57, the attacker may know tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_key_expansion,(sr_13,cr_18)).
Using the function b2ae the attacker may obtain b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_key_expansion,(sr_13,cr_18))).
attacker(b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_key_expansion,(sr_13,cr_18)))).

59. The entry clientSession(cr_18,sr_13,NoPSK,pk(k_4),o_16,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_key_expansion,(sr_13,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),server_key_expansion,(sr_13,cr_18))),tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_finished,((((CH(cr_18,o_16),SH(sr_13,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement)))),tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13))) that may be in a table by 54 may be read at get {163}.
The message b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_13)),client_key_expansion,(sr_13,cr_18))) that the attacker may have by 58 may be received at input {161}.
So event ClientAEKeyLeaked(TLS12,cr_18,sr_13,NoPSK,pk(k_4)) may be executed at {162}.
end(ClientAEKeyLeaked(TLS12,cr_18,sr_13,NoPSK,pk(k_4))).

60. By 59, end(ClientAEKeyLeaked(TLS12,cr_18,sr_13,NoPSK,pk(k_4))).
The goal is reached, represented in the following fact:
end(ClientAEKeyLeaked(TLS12,cr_18,sr_13,NoPSK,pk(k_4))).


Unified offer_2 with o_16
Iterating unifyDerivation.
Fixpoint reached: nothing more to unify.
The clause after unifyDerivation is
attacker(sr_12) && attacker(a_13) && attacker(offer_3) && attacker(cr_18) && attacker(pt_9) && attacker(a_14) && attacker(h_2) && attacker(xxx_2) && begin(ServerChoosesKEX(cr_18,sr_1[mode_1 = nego(TLS12,RSA(WeakRSADecryption),h_2,a_14,pt_9),xxx_1 = xxx_2,offer_1 = offer_3,cr_1 = cr_18,!1 = @sid],pk(k_2[a_2 = a_13,!1 = @sid_1]),TLS12,RSA(WeakRSADecryption))) && begin(ServerChoosesHash(cr_18,sr_1[mode_1 = nego(TLS12,RSA(WeakRSADecryption),h_2,a_14,pt_9),xxx_1 = xxx_2,offer_1 = offer_3,cr_1 = cr_18,!1 = @sid],pk(k_2[a_2 = a_13,!1 = @sid_1]),TLS12,h_2)) -> end(ClientAEKeyLeaked(TLS12,cr[!1 = @sid_2],sr_12,NoPSK,pk(k_2[a_2 = a_13,!1 = @sid_1])))
This clause still contradicts the query.
A more detailed output of the traces is available with
  set traceDisplay = long.

new cr: random creating cr_19 at {2} in copy a_15

in(io, a_16) at {3} in copy a_15

out(io, CH(~M,~M_1)) with ~M = cr_19, ~M_1 = a_16 at {4} in copy a_15

in(io, SH(a_17,nego(TLS12,DHE(WeakDH),WeakHash,a_18,a_19))) at {5} in copy a_15

in(io, CH(a_20,a_21)) at {47} in copy a_22

in(io, SH(a_23,nego(TLS12,RSA(WeakRSADecryption),a_24,a_25,a_26))) at {48} in copy a_22

new sr_1: random creating sr_13 at {51} in copy a_22

out(io, SH(~M_2,nego(~M_3,RSA(~M_4),~M_5,~M_6,~M_7))) with ~M_2 = sr_13, ~M_3 = TLS12, ~M_4 = WeakRSADecryption, ~M_5 = a_24, ~M_6 = a_25, ~M_7 = a_26 at {52} in copy a_22

in(io, a_27) at {104} in copy a_28

new k_2: privkey creating k_4 at {105} in copy a_28

insert longTermKeys_tbl(a_27,k_4,pk(k_4)) at {106} in copy a_28

out(io, ~M_8) with ~M_8 = pk(k_4) at {107} in copy a_28

in(io, CRT(~M_8)) with ~M_8 = pk(k_4) at {9} in copy a_15

get longTermKeys_tbl(a_27,k_4,pk(k_4)) at {45} in copy a_15

get longTermKeys_tbl(a_27,k_4,pk(k_4)) at {101} in copy a_22

event ServerChoosesVersion(a_20,sr_13,pk(k_4),TLS12) at {54} in copy a_22

event ServerChoosesKEX(a_20,sr_13,pk(k_4),TLS12,RSA(WeakRSADecryption)) at {55} in copy a_22

event ServerChoosesAE(a_20,sr_13,pk(k_4),TLS12,a_25) at {56} in copy a_22

event ServerChoosesHash(a_20,sr_13,pk(k_4),TLS12,a_24) at {57} in copy a_22

out(io, CRT(~M_9)) with ~M_9 = pk(k_4) at {58} in copy a_22

in(io, CKE(rsa_enc(~M_8,collision))) with rsa_enc(~M_8,collision) = rsa_enc(pk(k_4),collision) at {84} in copy a_22

out(io, (collision,~M_10)) with ~M_10 = sign(k_4,collision) at {87} in copy a_22

in(io, SKE(WeakDH,a_29,~M_10)) with ~M_10 = sign(k_4,collision) at {12} in copy a_15

new x_1: bitstring creating x_4 at {15} in copy a_15

out(io, CKE(e2b(BadElement))) at {20} in copy a_15

out(io, FIN(~M_11)) with ~M_11 = tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_19,a_17)),client_finished,((((CH(cr_19,a_16),SH(a_17,nego(TLS12,DHE(WeakDH),WeakHash,a_18,a_19))),CRT(pk(k_4))),SKE(WeakDH,a_29,sign(k_4,collision))),CKE(e2b(BadElement)))) at {23} in copy a_15

in(io, FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(~M,a_17)),server_finished,(((((CH(~M,a_16),SH(a_17,nego(TLS12,DHE(WeakDH),WeakHash,a_18,a_19))),CRT(~M_8)),SKE(WeakDH,a_29,~M_10)),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(~M,a_17)),client_finished,((((CH(~M,a_16),SH(a_17,nego(TLS12,DHE(WeakDH),WeakHash,a_18,a_19))),CRT(~M_8)),SKE(WeakDH,a_29,~M_10)),CKE(e2b(BadElement))))))))) with tls12_prf(tls12_prf(e2b(BadElement),master_secret,(~M,a_17)),server_finished,(((((CH(~M,a_16),SH(a_17,nego(TLS12,DHE(WeakDH),WeakHash,a_18,a_19))),CRT(~M_8)),SKE(WeakDH,a_29,~M_10)),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(~M,a_17)),client_finished,((((CH(~M,a_16),SH(a_17,nego(TLS12,DHE(WeakDH),WeakHash,a_18,a_19))),CRT(~M_8)),SKE(WeakDH,a_29,~M_10)),CKE(e2b(BadElement))))))) = tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_19,a_17)),server_finished,(((((CH(cr_19,a_16),SH(a_17,nego(TLS12,DHE(WeakDH),WeakHash,a_18,a_19))),CRT(pk(k_4))),SKE(WeakDH,a_29,sign(k_4,collision))),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_19,a_17)),client_finished,((((CH(cr_19,a_16),SH(a_17,nego(TLS12,DHE(WeakDH),WeakHash,a_18,a_19))),CRT(pk(k_4))),SKE(WeakDH,a_29,sign(k_4,collision))),CKE(e2b(BadElement))))))) at {25} in copy a_15

event ClientFinished(TLS12,cr_19,a_17,NoPSK,pk(k_4),a_16,nego(TLS12,DHE(WeakDH),WeakHash,a_18,a_19),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_19,a_17)),client_key_expansion,(a_17,cr_19))),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_19,a_17)),server_key_expansion,(a_17,cr_19))),tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_19,a_17)),client_finished,((((CH(cr_19,a_16),SH(a_17,nego(TLS12,DHE(WeakDH),WeakHash,a_18,a_19))),CRT(pk(k_4))),SKE(WeakDH,a_29,sign(k_4,collision))),CKE(e2b(BadElement)))),tls12_prf(e2b(BadElement),master_secret,(cr_19,a_17))) at {29} in copy a_15

insert clientSession(cr_19,a_17,NoPSK,pk(k_4),a_16,nego(TLS12,DHE(WeakDH),WeakHash,a_18,a_19),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_19,a_17)),client_key_expansion,(a_17,cr_19))),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_19,a_17)),server_key_expansion,(a_17,cr_19))),tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_19,a_17)),client_finished,((((CH(cr_19,a_16),SH(a_17,nego(TLS12,DHE(WeakDH),WeakHash,a_18,a_19))),CRT(pk(k_4))),SKE(WeakDH,a_29,sign(k_4,collision))),CKE(e2b(BadElement)))),tls12_prf(e2b(BadElement),master_secret,(cr_19,a_17))) at {30} in copy a_15

get clientSession(cr_19,a_17,NoPSK,pk(k_4),a_16,nego(TLS12,DHE(WeakDH),WeakHash,a_18,a_19),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_19,a_17)),client_key_expansion,(a_17,cr_19))),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_19,a_17)),server_key_expansion,(a_17,cr_19))),tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_19,a_17)),client_finished,((((CH(cr_19,a_16),SH(a_17,nego(TLS12,DHE(WeakDH),WeakHash,a_18,a_19))),CRT(pk(k_4))),SKE(WeakDH,a_29,sign(k_4,collision))),CKE(e2b(BadElement)))),tls12_prf(e2b(BadElement),master_secret,(cr_19,a_17))) at {163} in copy a_30

in(io, b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(~M,a_17)),client_key_expansion,(a_17,~M)))) with tls12_prf(tls12_prf(e2b(BadElement),master_secret,(~M,a_17)),client_key_expansion,(a_17,~M)) = tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_19,a_17)),client_key_expansion,(a_17,cr_19)) at {161} in copy a_30

event ClientAEKeyLeaked(TLS12,cr_19,a_17,NoPSK,pk(k_4)) at {162} in copy a_30 (goal)

The event ClientAEKeyLeaked(TLS12,cr_19,a_17,NoPSK,pk(k_4)) is executed at {162} in copy a_30.
A trace has been found.
RESULT event(ClientAEKeyLeaked(TLS12,cr_18,sr_12,psk_16,p_7)) ==> event(WeakOrCompromisedKey(p_7)) || event(ServerChoosesKEX(cr_18,sr_12,p_7,TLS12,DHE(WeakDH))) || event(ServerChoosesHash(cr'_5,sr'_3,p_7,TLS12,WeakHash)) is false.
-- Query event(ClientAEKeyLeaked(TLS12,cr_18,sr_12,psk_16,p_7)) ==> event(WeakOrCompromisedKey(p_7)) || event(ServerChoosesKEX(cr'_5,sr'_3,p_7,TLS12,RSA(WeakRSADecryption))) || event(ServerChoosesHash(cr'_5,sr'_3,p_7,TLS12,WeakHash)) in process 0.
Completing...
200 rules inserted. The rule base contains 200 rules. 132 rules in the queue.
400 rules inserted. The rule base contains 389 rules. 75 rules in the queue.
600 rules inserted. The rule base contains 507 rules. 184 rules in the queue.
800 rules inserted. The rule base contains 576 rules. 187 rules in the queue.
1000 rules inserted. The rule base contains 623 rules. 232 rules in the queue.
1200 rules inserted. The rule base contains 684 rules. 264 rules in the queue.
1400 rules inserted. The rule base contains 765 rules. 317 rules in the queue.
1600 rules inserted. The rule base contains 817 rules. 311 rules in the queue.
1800 rules inserted. The rule base contains 870 rules. 301 rules in the queue.
2000 rules inserted. The rule base contains 914 rules. 314 rules in the queue.
2200 rules inserted. The rule base contains 982 rules. 305 rules in the queue.
2400 rules inserted. The rule base contains 1054 rules. 305 rules in the queue.
2600 rules inserted. The rule base contains 1143 rules. 312 rules in the queue.
2800 rules inserted. The rule base contains 1242 rules. 334 rules in the queue.
3000 rules inserted. The rule base contains 1338 rules. 317 rules in the queue.
3200 rules inserted. The rule base contains 1443 rules. 302 rules in the queue.
3400 rules inserted. The rule base contains 1550 rules. 281 rules in the queue.
3600 rules inserted. The rule base contains 1666 rules. 257 rules in the queue.
3800 rules inserted. The rule base contains 1767 rules. 207 rules in the queue.
4000 rules inserted. The rule base contains 1845 rules. 147 rules in the queue.
4200 rules inserted. The rule base contains 1863 rules. 93 rules in the queue.
4400 rules inserted. The rule base contains 1906 rules. 40 rules in the queue.
4600 rules inserted. The rule base contains 2055 rules. 26 rules in the queue.
Starting query event(ClientAEKeyLeaked(TLS12,cr_18,sr_12,psk_16,p_7)) ==> event(WeakOrCompromisedKey(p_7)) || event(ServerChoosesKEX(cr'_5,sr'_3,p_7,TLS12,RSA(WeakRSADecryption))) || event(ServerChoosesHash(cr'_5,sr'_3,p_7,TLS12,WeakHash))
goal reachable: begin(ServerChoosesHash(cr_18,sr_12,pk(k_4),TLS12,StrongHash)) && begin(ServerChoosesKEX(cr_18,sr_12,pk(k_4),TLS12,DHE(WeakDH))) && attacker(sn_2) && attacker(xxx_2) && attacker(a_13) && attacker(pt_9) && attacker(offer_2) -> end(ClientAEKeyLeaked(TLS12,cr_18,sr_12,NoPSK,pk(k_4)))
Abbreviations:
cr_18 = cr[!1 = @sid]
sr_12 = sr_1[mode_1 = nego(TLS12,DHE(WeakDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = offer_2,cr_1 = cr_18,!1 = @sid_1]
k_4 = k_2[a_2 = sn_2,!1 = @sid_2]

Derivation:
Abbreviations:
cr_18 = cr[!1 = @sid]
sr_12 = sr_1[mode_1 = nego(TLS12,DHE(WeakDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = offer_2,cr_1 = cr_18,!1 = @sid_1]
k_4 = k_2[a_2 = sn_2,!1 = @sid_2]

1. The attacker has some term o_16.
attacker(o_16).

2. The attacker has some term ppp_5.
attacker(ppp_5).

3. The attacker has some term aaa_5.
attacker(aaa_5).

4. Using the function StrongHash the attacker may obtain StrongHash.
attacker(StrongHash).

5. Using the function WeakDH the attacker may obtain WeakDH.
attacker(WeakDH).

6. By 5, the attacker may know WeakDH.
Using the function DHE the attacker may obtain DHE(WeakDH).
attacker(DHE(WeakDH)).

7. Using the function TLS12 the attacker may obtain TLS12.
attacker(TLS12).

8. By 7, the attacker may know TLS12.
By 6, the attacker may know DHE(WeakDH).
By 4, the attacker may know StrongHash.
By 3, the attacker may know aaa_5.
By 2, the attacker may know ppp_5.
Using the function nego the attacker may obtain nego(TLS12,DHE(WeakDH),StrongHash,aaa_5,ppp_5).
attacker(nego(TLS12,DHE(WeakDH),StrongHash,aaa_5,ppp_5)).

9. We assume as hypothesis that
attacker(offer_2).

10. The attacker has some term offer_3.
attacker(offer_3).

11. The message offer_3 that the attacker may have by 10 may be received at input {3}.
So the message CH(cr_18,offer_3) may be sent to the attacker at output {4}.
attacker(CH(cr_18,offer_3)).

12. By 11, the attacker may know CH(cr_18,offer_3).
Using the function 1-proj-CH the attacker may obtain cr_18.
attacker(cr_18).

13. By 12, the attacker may know cr_18.
By 9, the attacker may know offer_2.
Using the function CH the attacker may obtain CH(cr_18,offer_2).
attacker(CH(cr_18,offer_2)).

14. We assume as hypothesis that
attacker(pt_9).

15. We assume as hypothesis that
attacker(a_13).

16. By 7, the attacker may know TLS12.
By 6, the attacker may know DHE(WeakDH).
By 4, the attacker may know StrongHash.
By 15, the attacker may know a_13.
By 14, the attacker may know pt_9.
Using the function nego the attacker may obtain nego(TLS12,DHE(WeakDH),StrongHash,a_13,pt_9).
attacker(nego(TLS12,DHE(WeakDH),StrongHash,a_13,pt_9)).

17. We assume as hypothesis that
attacker(xxx_2).

18. By 17, the attacker may know xxx_2.
By 16, the attacker may know nego(TLS12,DHE(WeakDH),StrongHash,a_13,pt_9).
Using the function SH the attacker may obtain SH(xxx_2,nego(TLS12,DHE(WeakDH),StrongHash,a_13,pt_9)).
attacker(SH(xxx_2,nego(TLS12,DHE(WeakDH),StrongHash,a_13,pt_9))).

19. The message CH(cr_18,offer_2) that the attacker may have by 13 may be received at input {47}.
The message SH(xxx_2,nego(TLS12,DHE(WeakDH),StrongHash,a_13,pt_9)) that the attacker may have by 18 may be received at input {48}.
So the message SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,a_13,pt_9)) may be sent to the attacker at output {52}.
attacker(SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,a_13,pt_9))).

20. By 19, the attacker may know SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,a_13,pt_9)).
Using the function 1-proj-SH the attacker may obtain sr_12.
attacker(sr_12).

21. By 20, the attacker may know sr_12.
By 8, the attacker may know nego(TLS12,DHE(WeakDH),StrongHash,aaa_5,ppp_5).
Using the function SH the attacker may obtain SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,aaa_5,ppp_5)).
attacker(SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,aaa_5,ppp_5))).

22. We assume as hypothesis that
attacker(sn_2).

23. The message sn_2 that the attacker may have by 22 may be received at input {104}.
So the message pk(k_4) may be sent to the attacker at output {107}.
attacker(pk(k_4)).

24. By 23, the attacker may know pk(k_4).
Using the function CRT the attacker may obtain CRT(pk(k_4)).
attacker(CRT(pk(k_4))).

25. The message sn_2 that the attacker may have by 22 may be received at input {104}.
So the entry longTermKeys_tbl(sn_2,k_4,pk(k_4)) may be inserted in a table at insert {106}.
table(longTermKeys_tbl(sn_2,k_4,pk(k_4))).

26. The message CH(cr_18,offer_2) that the attacker may have by 13 may be received at input {47}.
The message SH(xxx_2,nego(TLS12,DHE(WeakDH),StrongHash,a_13,pt_9)) that the attacker may have by 18 may be received at input {48}.
The entry longTermKeys_tbl(sn_2,k_4,pk(k_4)) that may be in a table by 25 may be read at get {101}.
The event ServerChoosesKEX(cr_18,sr_12,pk(k_4),TLS12,DHE(WeakDH)) may be executed at {55}.
The event ServerChoosesHash(cr_18,sr_12,pk(k_4),TLS12,StrongHash) may be executed at {57}.
So the message SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement)))) may be sent to the attacker at output {65}.
attacker(SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))))).

27. By 26, the attacker may know SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement)))).
Using the function 3-proj-SKE the attacker may obtain sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))).
attacker(sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement)))).

28. Using the function BadElement the attacker may obtain BadElement.
attacker(BadElement).

29. By 5, the attacker may know WeakDH.
By 28, the attacker may know BadElement.
By 27, the attacker may know sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))).
Using the function SKE the attacker may obtain SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement)))).
attacker(SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))))).

30. By 28, the attacker may know BadElement.
Using the function e2b the attacker may obtain e2b(BadElement).
attacker(e2b(BadElement)).

31. By 30, the attacker may know e2b(BadElement).
Using the function CKE the attacker may obtain CKE(e2b(BadElement)).
attacker(CKE(e2b(BadElement))).

32. By 12, the attacker may know cr_18.
By 1, the attacker may know o_16.
Using the function CH the attacker may obtain CH(cr_18,o_16).
attacker(CH(cr_18,o_16)).

33. By 32, the attacker may know CH(cr_18,o_16).
By 21, the attacker may know SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,aaa_5,ppp_5)).
Using the function 2-tuple the attacker may obtain (CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,aaa_5,ppp_5))).
attacker((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,aaa_5,ppp_5)))).

34. By 33, the attacker may know (CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,aaa_5,ppp_5))).
By 24, the attacker may know CRT(pk(k_4)).
Using the function 2-tuple the attacker may obtain ((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,aaa_5,ppp_5))),CRT(pk(k_4))).
attacker(((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,aaa_5,ppp_5))),CRT(pk(k_4)))).

35. By 34, the attacker may know ((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,aaa_5,ppp_5))),CRT(pk(k_4))).
By 29, the attacker may know SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement)))).
Using the function 2-tuple the attacker may obtain (((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))))).
attacker((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement)))))).

36. By 35, the attacker may know (((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))))).
By 31, the attacker may know CKE(e2b(BadElement)).
Using the function 2-tuple the attacker may obtain ((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))))),CKE(e2b(BadElement))).
attacker(((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))))),CKE(e2b(BadElement)))).

37. Using the function client_finished the attacker may obtain client_finished.
attacker(client_finished).

38. By 12, the attacker may know cr_18.
By 20, the attacker may know sr_12.
Using the function 2-tuple the attacker may obtain (cr_18,sr_12).
attacker((cr_18,sr_12)).

39. Using the function master_secret the attacker may obtain master_secret.
attacker(master_secret).

40. By 30, the attacker may know e2b(BadElement).
By 39, the attacker may know master_secret.
By 38, the attacker may know (cr_18,sr_12).
Using the function tls12_prf the attacker may obtain tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)).
attacker(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12))).

41. By 40, the attacker may know tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)).
By 37, the attacker may know client_finished.
By 36, the attacker may know ((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))))),CKE(e2b(BadElement))).
Using the function tls12_prf the attacker may obtain tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))))),CKE(e2b(BadElement)))).
attacker(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))))),CKE(e2b(BadElement))))).

42. By 41, the attacker may know tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))))),CKE(e2b(BadElement)))).
Using the function FIN the attacker may obtain FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))))),CKE(e2b(BadElement))))).
attacker(FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))))),CKE(e2b(BadElement)))))).

43. By 36, the attacker may know ((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))))),CKE(e2b(BadElement))).
By 42, the attacker may know FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))))),CKE(e2b(BadElement))))).
Using the function 2-tuple the attacker may obtain (((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))))),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))))),CKE(e2b(BadElement)))))).
attacker((((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))))),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))))),CKE(e2b(BadElement))))))).

44. Using the function server_finished the attacker may obtain server_finished.
attacker(server_finished).

45. By 40, the attacker may know tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)).
By 44, the attacker may know server_finished.
By 43, the attacker may know (((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))))),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))))),CKE(e2b(BadElement)))))).
Using the function tls12_prf the attacker may obtain tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),server_finished,(((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))))),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))))),CKE(e2b(BadElement))))))).
attacker(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),server_finished,(((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))))),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))))),CKE(e2b(BadElement)))))))).

46. By 45, the attacker may know tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),server_finished,(((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))))),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))))),CKE(e2b(BadElement))))))).
Using the function FIN the attacker may obtain FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),server_finished,(((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))))),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))))),CKE(e2b(BadElement)))))))).
attacker(FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),server_finished,(((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))))),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))))),CKE(e2b(BadElement))))))))).

47. The message o_16 that the attacker may have by 1 may be received at input {3}.
The message SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,aaa_5,ppp_5)) that the attacker may have by 21 may be received at input {5}.
The message CRT(pk(k_4)) that the attacker may have by 24 may be received at input {9}.
The entry longTermKeys_tbl(sn_2,k_4,pk(k_4)) that may be in a table by 25 may be read at get {45}.
The message SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement)))) that the attacker may have by 29 may be received at input {12}.
The message FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),server_finished,(((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))))),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))))),CKE(e2b(BadElement)))))))) that the attacker may have by 46 may be received at input {25}.
So the entry clientSession(cr_18,sr_12,NoPSK,pk(k_4),o_16,nego(TLS12,DHE(WeakDH),StrongHash,aaa_5,ppp_5),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_key_expansion,(sr_12,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),server_key_expansion,(sr_12,cr_18))),tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))))),CKE(e2b(BadElement)))),tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12))) may be inserted in a table at insert {30}.
table(clientSession(cr_18,sr_12,NoPSK,pk(k_4),o_16,nego(TLS12,DHE(WeakDH),StrongHash,aaa_5,ppp_5),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_key_expansion,(sr_12,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),server_key_expansion,(sr_12,cr_18))),tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))))),CKE(e2b(BadElement)))),tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)))).

48. By 20, the attacker may know sr_12.
By 12, the attacker may know cr_18.
Using the function 2-tuple the attacker may obtain (sr_12,cr_18).
attacker((sr_12,cr_18)).

49. Using the function client_key_expansion the attacker may obtain client_key_expansion.
attacker(client_key_expansion).

50. By 40, the attacker may know tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)).
By 49, the attacker may know client_key_expansion.
By 48, the attacker may know (sr_12,cr_18).
Using the function tls12_prf the attacker may obtain tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_key_expansion,(sr_12,cr_18)).
attacker(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_key_expansion,(sr_12,cr_18))).

51. By 50, the attacker may know tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_key_expansion,(sr_12,cr_18)).
Using the function b2ae the attacker may obtain b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_key_expansion,(sr_12,cr_18))).
attacker(b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_key_expansion,(sr_12,cr_18)))).

52. The entry clientSession(cr_18,sr_12,NoPSK,pk(k_4),o_16,nego(TLS12,DHE(WeakDH),StrongHash,aaa_5,ppp_5),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_key_expansion,(sr_12,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),server_key_expansion,(sr_12,cr_18))),tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))))),CKE(e2b(BadElement)))),tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12))) that may be in a table by 47 may be read at get {163}.
The message b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_key_expansion,(sr_12,cr_18))) that the attacker may have by 51 may be received at input {161}.
So event ClientAEKeyLeaked(TLS12,cr_18,sr_12,NoPSK,pk(k_4)) may be executed at {162}.
end(ClientAEKeyLeaked(TLS12,cr_18,sr_12,NoPSK,pk(k_4))).

53. By 52, end(ClientAEKeyLeaked(TLS12,cr_18,sr_12,NoPSK,pk(k_4))).
The goal is reached, represented in the following fact:
end(ClientAEKeyLeaked(TLS12,cr_18,sr_12,NoPSK,pk(k_4))).


Unified offer_2 with o_16
Iterating unifyDerivation.
Fixpoint reached: nothing more to unify.
The clause after unifyDerivation is
attacker(offer_3) && attacker(pt_9) && attacker(a_13) && attacker(xxx_2) && attacker(sn_2) && begin(ServerChoosesKEX(cr[!1 = @sid],sr_1[mode_1 = nego(TLS12,DHE(WeakDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = offer_3,cr_1 = cr[!1 = @sid],!1 = @sid_1],pk(k_2[a_2 = sn_2,!1 = @sid_2]),TLS12,DHE(WeakDH))) && begin(ServerChoosesHash(cr[!1 = @sid],sr_1[mode_1 = nego(TLS12,DHE(WeakDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = offer_3,cr_1 = cr[!1 = @sid],!1 = @sid_1],pk(k_2[a_2 = sn_2,!1 = @sid_2]),TLS12,StrongHash)) -> end(ClientAEKeyLeaked(TLS12,cr[!1 = @sid],sr_1[mode_1 = nego(TLS12,DHE(WeakDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = offer_3,cr_1 = cr[!1 = @sid],!1 = @sid_1],NoPSK,pk(k_2[a_2 = sn_2,!1 = @sid_2])))
This clause still contradicts the query.
A more detailed output of the traces is available with
  set traceDisplay = long.

new cr: random creating cr_18 at {2} in copy a_14

in(io, a_15) at {3} in copy a_14

out(io, CH(~M,~M_1)) with ~M = cr_18, ~M_1 = a_15 at {4} in copy a_14

in(io, CH(~M,a_16)) with ~M = cr_18 at {47} in copy a_17

in(io, SH(a_18,nego(TLS12,DHE(WeakDH),StrongHash,a_19,a_20))) at {48} in copy a_17

new sr_1: random creating sr_12 at {51} in copy a_17

out(io, SH(~M_2,nego(~M_3,DHE(WeakDH),StrongHash,~M_4,~M_5))) with ~M_2 = sr_12, ~M_3 = TLS12, ~M_4 = a_19, ~M_5 = a_20 at {52} in copy a_17

in(io, SH(~M_2,nego(TLS12,DHE(WeakDH),StrongHash,a_21,a_22))) with ~M_2 = sr_12 at {5} in copy a_14

in(io, a_23) at {104} in copy a_24

new k_2: privkey creating k_4 at {105} in copy a_24

insert longTermKeys_tbl(a_23,k_4,pk(k_4)) at {106} in copy a_24

out(io, ~M_6) with ~M_6 = pk(k_4) at {107} in copy a_24

in(io, CRT(~M_6)) with ~M_6 = pk(k_4) at {9} in copy a_14

get longTermKeys_tbl(a_23,k_4,pk(k_4)) at {45} in copy a_14

get longTermKeys_tbl(a_23,k_4,pk(k_4)) at {101} in copy a_17

event ServerChoosesVersion(cr_18,sr_12,pk(k_4),TLS12) at {54} in copy a_17

event ServerChoosesKEX(cr_18,sr_12,pk(k_4),TLS12,DHE(WeakDH)) at {55} in copy a_17

event ServerChoosesAE(cr_18,sr_12,pk(k_4),TLS12,a_19) at {56} in copy a_17

event ServerChoosesHash(cr_18,sr_12,pk(k_4),TLS12,StrongHash) at {57} in copy a_17

out(io, CRT(~M_7)) with ~M_7 = pk(k_4) at {58} in copy a_17

new x_3: bitstring creating x_4 at {61} in copy a_17

out(io, SKE(WeakDH,BadElement,~M_8)) with ~M_8 = sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))) at {65} in copy a_17

in(io, SKE(WeakDH,BadElement,~M_8)) with ~M_8 = sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))) at {12} in copy a_14

new x_1: bitstring creating x_5 at {15} in copy a_14

out(io, CKE(e2b(BadElement))) at {20} in copy a_14

out(io, FIN(~M_9)) with ~M_9 = tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,a_15),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,a_21,a_22))),CRT(pk(k_4))),SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))))),CKE(e2b(BadElement)))) at {23} in copy a_14

in(io, FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(~M,~M_2)),server_finished,(((((CH(~M,a_15),SH(~M_2,nego(TLS12,DHE(WeakDH),StrongHash,a_21,a_22))),CRT(~M_6)),SKE(WeakDH,BadElement,~M_8)),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(~M,~M_2)),client_finished,((((CH(~M,a_15),SH(~M_2,nego(TLS12,DHE(WeakDH),StrongHash,a_21,a_22))),CRT(~M_6)),SKE(WeakDH,BadElement,~M_8)),CKE(e2b(BadElement))))))))) with tls12_prf(tls12_prf(e2b(BadElement),master_secret,(~M,~M_2)),server_finished,(((((CH(~M,a_15),SH(~M_2,nego(TLS12,DHE(WeakDH),StrongHash,a_21,a_22))),CRT(~M_6)),SKE(WeakDH,BadElement,~M_8)),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(~M,~M_2)),client_finished,((((CH(~M,a_15),SH(~M_2,nego(TLS12,DHE(WeakDH),StrongHash,a_21,a_22))),CRT(~M_6)),SKE(WeakDH,BadElement,~M_8)),CKE(e2b(BadElement))))))) = tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),server_finished,(((((CH(cr_18,a_15),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,a_21,a_22))),CRT(pk(k_4))),SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))))),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,a_15),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,a_21,a_22))),CRT(pk(k_4))),SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))))),CKE(e2b(BadElement))))))) at {25} in copy a_14

event ClientFinished(TLS12,cr_18,sr_12,NoPSK,pk(k_4),a_15,nego(TLS12,DHE(WeakDH),StrongHash,a_21,a_22),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_key_expansion,(sr_12,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),server_key_expansion,(sr_12,cr_18))),tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,a_15),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,a_21,a_22))),CRT(pk(k_4))),SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))))),CKE(e2b(BadElement)))),tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12))) at {29} in copy a_14

insert clientSession(cr_18,sr_12,NoPSK,pk(k_4),a_15,nego(TLS12,DHE(WeakDH),StrongHash,a_21,a_22),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_key_expansion,(sr_12,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),server_key_expansion,(sr_12,cr_18))),tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,a_15),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,a_21,a_22))),CRT(pk(k_4))),SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))))),CKE(e2b(BadElement)))),tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12))) at {30} in copy a_14

get clientSession(cr_18,sr_12,NoPSK,pk(k_4),a_15,nego(TLS12,DHE(WeakDH),StrongHash,a_21,a_22),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_key_expansion,(sr_12,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),server_key_expansion,(sr_12,cr_18))),tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,a_15),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,a_21,a_22))),CRT(pk(k_4))),SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))))),CKE(e2b(BadElement)))),tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12))) at {163} in copy a_25

in(io, b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(~M,~M_2)),client_key_expansion,(~M_2,~M)))) with tls12_prf(tls12_prf(e2b(BadElement),master_secret,(~M,~M_2)),client_key_expansion,(~M_2,~M)) = tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_key_expansion,(sr_12,cr_18)) at {161} in copy a_25

event ClientAEKeyLeaked(TLS12,cr_18,sr_12,NoPSK,pk(k_4)) at {162} in copy a_25 (goal)

The event ClientAEKeyLeaked(TLS12,cr_18,sr_12,NoPSK,pk(k_4)) is executed at {162} in copy a_25.
A trace has been found.
RESULT event(ClientAEKeyLeaked(TLS12,cr_18,sr_12,psk_16,p_7)) ==> event(WeakOrCompromisedKey(p_7)) || event(ServerChoosesKEX(cr'_5,sr'_3,p_7,TLS12,RSA(WeakRSADecryption))) || event(ServerChoosesHash(cr'_5,sr'_3,p_7,TLS12,WeakHash)) is false.
-- Query event(ClientAEKeyLeaked(TLS12,cr_18,sr_12,psk_16,p_7)) ==> event(ServerChoosesKEX(cr_18,sr_12,p_7,TLS12,DHE(WeakDH))) || event(ServerChoosesKEX(cr'_5,sr'_3,p_7,TLS12,RSA(WeakRSADecryption))) || event(ServerChoosesHash(cr'_5,sr'_3,p_7,TLS12,WeakHash)) in process 0.
Completing...
200 rules inserted. The rule base contains 200 rules. 132 rules in the queue.
400 rules inserted. The rule base contains 388 rules. 70 rules in the queue.
600 rules inserted. The rule base contains 504 rules. 176 rules in the queue.
800 rules inserted. The rule base contains 570 rules. 185 rules in the queue.
1000 rules inserted. The rule base contains 608 rules. 220 rules in the queue.
1200 rules inserted. The rule base contains 667 rules. 247 rules in the queue.
1400 rules inserted. The rule base contains 755 rules. 306 rules in the queue.
1600 rules inserted. The rule base contains 798 rules. 298 rules in the queue.
1800 rules inserted. The rule base contains 856 rules. 299 rules in the queue.
2000 rules inserted. The rule base contains 896 rules. 298 rules in the queue.
2200 rules inserted. The rule base contains 964 rules. 285 rules in the queue.
2400 rules inserted. The rule base contains 1036 rules. 318 rules in the queue.
2600 rules inserted. The rule base contains 1148 rules. 302 rules in the queue.
2800 rules inserted. The rule base contains 1251 rules. 330 rules in the queue.
3000 rules inserted. The rule base contains 1336 rules. 295 rules in the queue.
3200 rules inserted. The rule base contains 1449 rules. 293 rules in the queue.
3400 rules inserted. The rule base contains 1541 rules. 267 rules in the queue.
3600 rules inserted. The rule base contains 1647 rules. 238 rules in the queue.
3800 rules inserted. The rule base contains 1744 rules. 176 rules in the queue.
4000 rules inserted. The rule base contains 1799 rules. 119 rules in the queue.
4200 rules inserted. The rule base contains 1800 rules. 71 rules in the queue.
4400 rules inserted. The rule base contains 1929 rules. 32 rules in the queue.
Starting query event(ClientAEKeyLeaked(TLS12,cr_18,sr_12,psk_16,p_7)) ==> event(ServerChoosesKEX(cr_18,sr_12,p_7,TLS12,DHE(WeakDH))) || event(ServerChoosesKEX(cr'_5,sr'_3,p_7,TLS12,RSA(WeakRSADecryption))) || event(ServerChoosesHash(cr'_5,sr'_3,p_7,TLS12,WeakHash))
goal reachable: attacker(k_4) && attacker(sr_12) -> end(ClientAEKeyLeaked(TLS12,cr_18,sr_12,NoPSK,pk(k_4)))
Abbreviations:
cr_18 = cr[!1 = @sid]

Derivation:
Abbreviations:
cr_18 = cr[!1 = @sid]

1. The attacker has some term o_16.
attacker(o_16).

2. The attacker has some term ppp_5.
attacker(ppp_5).

3. The attacker has some term aaa_5.
attacker(aaa_5).

4. Using the function WeakHash the attacker may obtain WeakHash.
attacker(WeakHash).

5. Using the function WeakDH the attacker may obtain WeakDH.
attacker(WeakDH).

6. By 5, the attacker may know WeakDH.
Using the function DHE the attacker may obtain DHE(WeakDH).
attacker(DHE(WeakDH)).

7. Using the function TLS12 the attacker may obtain TLS12.
attacker(TLS12).

8. By 7, the attacker may know TLS12.
By 6, the attacker may know DHE(WeakDH).
By 4, the attacker may know WeakHash.
By 3, the attacker may know aaa_5.
By 2, the attacker may know ppp_5.
Using the function nego the attacker may obtain nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5).
attacker(nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5)).

9. We assume as hypothesis that
attacker(sr_12).

10. By 9, the attacker may know sr_12.
By 8, the attacker may know nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5).
Using the function SH the attacker may obtain SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5)).
attacker(SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))).

11. We assume as hypothesis that
attacker(k_4).

12. By 11, the attacker may know k_4.
Using the function pk the attacker may obtain pk(k_4).
attacker(pk(k_4)).

13. By 12, the attacker may know pk(k_4).
Using the function CRT the attacker may obtain CRT(pk(k_4)).
attacker(CRT(pk(k_4))).

14. The attacker has some term sn_2.
attacker(sn_2).

15. By 14, the attacker may know sn_2.
By 11, the attacker may know k_4.
Using the function 2-tuple the attacker may obtain (sn_2,k_4).
attacker((sn_2,k_4)).

16. The message (sn_2,k_4) that the attacker may have by 15 may be received at input {108}.
So the entry longTermKeys_tbl(sn_2,k_4,pk(k_4)) may be inserted in a table at insert {110}.
table(longTermKeys_tbl(sn_2,k_4,pk(k_4))).

17. Using the function collision the attacker may obtain collision.
attacker(collision).

18. By 11, the attacker may know k_4.
By 17, the attacker may know collision.
Using the function sign the attacker may obtain sign(k_4,collision).
attacker(sign(k_4,collision)).

19. The attacker has some term e_1.
attacker(e_1).

20. By 5, the attacker may know WeakDH.
By 19, the attacker may know e_1.
By 18, the attacker may know sign(k_4,collision).
Using the function SKE the attacker may obtain SKE(WeakDH,e_1,sign(k_4,collision)).
attacker(SKE(WeakDH,e_1,sign(k_4,collision))).

21. Using the function BadElement the attacker may obtain BadElement.
attacker(BadElement).

22. By 21, the attacker may know BadElement.
Using the function e2b the attacker may obtain e2b(BadElement).
attacker(e2b(BadElement)).

23. By 22, the attacker may know e2b(BadElement).
Using the function CKE the attacker may obtain CKE(e2b(BadElement)).
attacker(CKE(e2b(BadElement))).

24. The attacker has some term offer_2.
attacker(offer_2).

25. The message offer_2 that the attacker may have by 24 may be received at input {3}.
So the message CH(cr_18,offer_2) may be sent to the attacker at output {4}.
attacker(CH(cr_18,offer_2)).

26. By 25, the attacker may know CH(cr_18,offer_2).
Using the function 1-proj-CH the attacker may obtain cr_18.
attacker(cr_18).

27. By 26, the attacker may know cr_18.
By 1, the attacker may know o_16.
Using the function CH the attacker may obtain CH(cr_18,o_16).
attacker(CH(cr_18,o_16)).

28. By 27, the attacker may know CH(cr_18,o_16).
By 10, the attacker may know SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5)).
Using the function 2-tuple the attacker may obtain (CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))).
attacker((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5)))).

29. By 28, the attacker may know (CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))).
By 13, the attacker may know CRT(pk(k_4)).
Using the function 2-tuple the attacker may obtain ((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))).
attacker(((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4)))).

30. By 29, the attacker may know ((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))).
By 20, the attacker may know SKE(WeakDH,e_1,sign(k_4,collision)).
Using the function 2-tuple the attacker may obtain (((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))).
attacker((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision)))).

31. By 30, the attacker may know (((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))).
By 23, the attacker may know CKE(e2b(BadElement)).
Using the function 2-tuple the attacker may obtain ((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))).
attacker(((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement)))).

32. Using the function client_finished the attacker may obtain client_finished.
attacker(client_finished).

33. By 26, the attacker may know cr_18.
By 9, the attacker may know sr_12.
Using the function 2-tuple the attacker may obtain (cr_18,sr_12).
attacker((cr_18,sr_12)).

34. Using the function master_secret the attacker may obtain master_secret.
attacker(master_secret).

35. By 22, the attacker may know e2b(BadElement).
By 34, the attacker may know master_secret.
By 33, the attacker may know (cr_18,sr_12).
Using the function tls12_prf the attacker may obtain tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)).
attacker(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12))).

36. By 35, the attacker may know tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)).
By 32, the attacker may know client_finished.
By 31, the attacker may know ((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))).
Using the function tls12_prf the attacker may obtain tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement)))).
attacker(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))))).

37. By 36, the attacker may know tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement)))).
Using the function FIN the attacker may obtain FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))))).
attacker(FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement)))))).

38. By 31, the attacker may know ((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))).
By 37, the attacker may know FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))))).
Using the function 2-tuple the attacker may obtain (((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement)))))).
attacker((((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))))))).

39. Using the function server_finished the attacker may obtain server_finished.
attacker(server_finished).

40. By 35, the attacker may know tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)).
By 39, the attacker may know server_finished.
By 38, the attacker may know (((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement)))))).
Using the function tls12_prf the attacker may obtain tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),server_finished,(((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))))))).
attacker(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),server_finished,(((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement)))))))).

41. By 40, the attacker may know tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),server_finished,(((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))))))).
Using the function FIN the attacker may obtain FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),server_finished,(((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement)))))))).
attacker(FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),server_finished,(((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))))))))).

42. The message o_16 that the attacker may have by 1 may be received at input {3}.
The message SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5)) that the attacker may have by 10 may be received at input {5}.
The message CRT(pk(k_4)) that the attacker may have by 13 may be received at input {9}.
The entry longTermKeys_tbl(sn_2,k_4,pk(k_4)) that may be in a table by 16 may be read at get {45}.
The message SKE(WeakDH,e_1,sign(k_4,collision)) that the attacker may have by 20 may be received at input {12}.
The message FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),server_finished,(((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement)))))))) that the attacker may have by 41 may be received at input {25}.
So the entry clientSession(cr_18,sr_12,NoPSK,pk(k_4),o_16,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_key_expansion,(sr_12,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),server_key_expansion,(sr_12,cr_18))),tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement)))),tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12))) may be inserted in a table at insert {30}.
table(clientSession(cr_18,sr_12,NoPSK,pk(k_4),o_16,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_key_expansion,(sr_12,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),server_key_expansion,(sr_12,cr_18))),tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement)))),tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)))).

43. By 9, the attacker may know sr_12.
By 26, the attacker may know cr_18.
Using the function 2-tuple the attacker may obtain (sr_12,cr_18).
attacker((sr_12,cr_18)).

44. Using the function client_key_expansion the attacker may obtain client_key_expansion.
attacker(client_key_expansion).

45. By 35, the attacker may know tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)).
By 44, the attacker may know client_key_expansion.
By 43, the attacker may know (sr_12,cr_18).
Using the function tls12_prf the attacker may obtain tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_key_expansion,(sr_12,cr_18)).
attacker(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_key_expansion,(sr_12,cr_18))).

46. By 45, the attacker may know tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_key_expansion,(sr_12,cr_18)).
Using the function b2ae the attacker may obtain b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_key_expansion,(sr_12,cr_18))).
attacker(b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_key_expansion,(sr_12,cr_18)))).

47. The entry clientSession(cr_18,sr_12,NoPSK,pk(k_4),o_16,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_key_expansion,(sr_12,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),server_key_expansion,(sr_12,cr_18))),tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),WeakHash,aaa_5,ppp_5))),CRT(pk(k_4))),SKE(WeakDH,e_1,sign(k_4,collision))),CKE(e2b(BadElement)))),tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12))) that may be in a table by 42 may be read at get {163}.
The message b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_key_expansion,(sr_12,cr_18))) that the attacker may have by 46 may be received at input {161}.
So event ClientAEKeyLeaked(TLS12,cr_18,sr_12,NoPSK,pk(k_4)) may be executed at {162}.
end(ClientAEKeyLeaked(TLS12,cr_18,sr_12,NoPSK,pk(k_4))).

48. By 47, end(ClientAEKeyLeaked(TLS12,cr_18,sr_12,NoPSK,pk(k_4))).
The goal is reached, represented in the following fact:
end(ClientAEKeyLeaked(TLS12,cr_18,sr_12,NoPSK,pk(k_4))).


Unified offer_2 with o_16
Iterating unifyDerivation.
Fixpoint reached: nothing more to unify.
The clause after unifyDerivation is
attacker(sr_12) && attacker(k_4) -> end(ClientAEKeyLeaked(TLS12,cr[!1 = @sid],sr_12,NoPSK,pk(k_4)))
This clause still contradicts the query.
A more detailed output of the traces is available with
  set traceDisplay = long.

event WeakOrCompromisedKey(NoPubKey) at {103} in copy a_13

new cr: random creating cr_18 at {2} in copy a_14

in(io, a_15) at {3} in copy a_14

out(io, CH(~M,~M_1)) with ~M = cr_18, ~M_1 = a_15 at {4} in copy a_14

in(io, SH(a_16,nego(TLS12,DHE(WeakDH),WeakHash,a_17,a_18))) at {5} in copy a_14

in(io, CRT(pk(a_19))) at {9} in copy a_14

in(io, (a_20,a_19)) at {108} in copy a_13

event WeakOrCompromisedKey(pk(a_19)) at {109} in copy a_13

insert longTermKeys_tbl(a_20,a_19,pk(a_19)) at {110} in copy a_13

get longTermKeys_tbl(a_20,a_19,pk(a_19)) at {45} in copy a_14

in(io, SKE(WeakDH,a_21,sign(a_19,collision))) at {12} in copy a_14

new x_1: bitstring creating x_4 at {15} in copy a_14

out(io, CKE(e2b(BadElement))) at {20} in copy a_14

out(io, FIN(~M_2)) with ~M_2 = tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,a_16)),client_finished,((((CH(cr_18,a_15),SH(a_16,nego(TLS12,DHE(WeakDH),WeakHash,a_17,a_18))),CRT(pk(a_19))),SKE(WeakDH,a_21,sign(a_19,collision))),CKE(e2b(BadElement)))) at {23} in copy a_14

in(io, FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(~M,a_16)),server_finished,(((((CH(~M,a_15),SH(a_16,nego(TLS12,DHE(WeakDH),WeakHash,a_17,a_18))),CRT(pk(a_19))),SKE(WeakDH,a_21,sign(a_19,collision))),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(~M,a_16)),client_finished,((((CH(~M,a_15),SH(a_16,nego(TLS12,DHE(WeakDH),WeakHash,a_17,a_18))),CRT(pk(a_19))),SKE(WeakDH,a_21,sign(a_19,collision))),CKE(e2b(BadElement))))))))) with tls12_prf(tls12_prf(e2b(BadElement),master_secret,(~M,a_16)),server_finished,(((((CH(~M,a_15),SH(a_16,nego(TLS12,DHE(WeakDH),WeakHash,a_17,a_18))),CRT(pk(a_19))),SKE(WeakDH,a_21,sign(a_19,collision))),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(~M,a_16)),client_finished,((((CH(~M,a_15),SH(a_16,nego(TLS12,DHE(WeakDH),WeakHash,a_17,a_18))),CRT(pk(a_19))),SKE(WeakDH,a_21,sign(a_19,collision))),CKE(e2b(BadElement))))))) = tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,a_16)),server_finished,(((((CH(cr_18,a_15),SH(a_16,nego(TLS12,DHE(WeakDH),WeakHash,a_17,a_18))),CRT(pk(a_19))),SKE(WeakDH,a_21,sign(a_19,collision))),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,a_16)),client_finished,((((CH(cr_18,a_15),SH(a_16,nego(TLS12,DHE(WeakDH),WeakHash,a_17,a_18))),CRT(pk(a_19))),SKE(WeakDH,a_21,sign(a_19,collision))),CKE(e2b(BadElement))))))) at {25} in copy a_14

event ClientFinished(TLS12,cr_18,a_16,NoPSK,pk(a_19),a_15,nego(TLS12,DHE(WeakDH),WeakHash,a_17,a_18),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,a_16)),client_key_expansion,(a_16,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,a_16)),server_key_expansion,(a_16,cr_18))),tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,a_16)),client_finished,((((CH(cr_18,a_15),SH(a_16,nego(TLS12,DHE(WeakDH),WeakHash,a_17,a_18))),CRT(pk(a_19))),SKE(WeakDH,a_21,sign(a_19,collision))),CKE(e2b(BadElement)))),tls12_prf(e2b(BadElement),master_secret,(cr_18,a_16))) at {29} in copy a_14

insert clientSession(cr_18,a_16,NoPSK,pk(a_19),a_15,nego(TLS12,DHE(WeakDH),WeakHash,a_17,a_18),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,a_16)),client_key_expansion,(a_16,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,a_16)),server_key_expansion,(a_16,cr_18))),tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,a_16)),client_finished,((((CH(cr_18,a_15),SH(a_16,nego(TLS12,DHE(WeakDH),WeakHash,a_17,a_18))),CRT(pk(a_19))),SKE(WeakDH,a_21,sign(a_19,collision))),CKE(e2b(BadElement)))),tls12_prf(e2b(BadElement),master_secret,(cr_18,a_16))) at {30} in copy a_14

get clientSession(cr_18,a_16,NoPSK,pk(a_19),a_15,nego(TLS12,DHE(WeakDH),WeakHash,a_17,a_18),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,a_16)),client_key_expansion,(a_16,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,a_16)),server_key_expansion,(a_16,cr_18))),tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,a_16)),client_finished,((((CH(cr_18,a_15),SH(a_16,nego(TLS12,DHE(WeakDH),WeakHash,a_17,a_18))),CRT(pk(a_19))),SKE(WeakDH,a_21,sign(a_19,collision))),CKE(e2b(BadElement)))),tls12_prf(e2b(BadElement),master_secret,(cr_18,a_16))) at {163} in copy a_22

in(io, b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(~M,a_16)),client_key_expansion,(a_16,~M)))) with tls12_prf(tls12_prf(e2b(BadElement),master_secret,(~M,a_16)),client_key_expansion,(a_16,~M)) = tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,a_16)),client_key_expansion,(a_16,cr_18)) at {161} in copy a_22

event ClientAEKeyLeaked(TLS12,cr_18,a_16,NoPSK,pk(a_19)) at {162} in copy a_22 (goal)

The event ClientAEKeyLeaked(TLS12,cr_18,a_16,NoPSK,pk(a_19)) is executed at {162} in copy a_22.
A trace has been found.
RESULT event(ClientAEKeyLeaked(TLS12,cr_18,sr_12,psk_16,p_7)) ==> event(ServerChoosesKEX(cr_18,sr_12,p_7,TLS12,DHE(WeakDH))) || event(ServerChoosesKEX(cr'_5,sr'_3,p_7,TLS12,RSA(WeakRSADecryption))) || event(ServerChoosesHash(cr'_5,sr'_3,p_7,TLS12,WeakHash)) is false.
-- Query event(ClientFinished(TLS12,cr_18,sr_12,NoPSK,p_7,o_16,m_10,ck_12,sk_8,cb_5,ms_9)) ==> event(ServerFinished(TLS12,cr_18,sr_12,NoPSK,p_7,o_16,m_10,ck_12,sk_8,cb_5,ms_9)) || event(WeakOrCompromisedKey(p_7)) || event(ServerChoosesKEX(cr_18,sr_12,p_7,TLS12,DHE(WeakDH))) || event(ServerChoosesKEX(cr'_5,sr'_3,p_7,TLS12,RSA(WeakRSADecryption))) in process 0.
Completing...
200 rules inserted. The rule base contains 200 rules. 140 rules in the queue.
400 rules inserted. The rule base contains 397 rules. 86 rules in the queue.
600 rules inserted. The rule base contains 511 rules. 142 rules in the queue.
800 rules inserted. The rule base contains 596 rules. 228 rules in the queue.
1000 rules inserted. The rule base contains 659 rules. 277 rules in the queue.
1200 rules inserted. The rule base contains 705 rules. 271 rules in the queue.
1400 rules inserted. The rule base contains 771 rules. 318 rules in the queue.
1600 rules inserted. The rule base contains 858 rules. 413 rules in the queue.
1800 rules inserted. The rule base contains 908 rules. 398 rules in the queue.
2000 rules inserted. The rule base contains 947 rules. 415 rules in the queue.
2200 rules inserted. The rule base contains 1009 rules. 429 rules in the queue.
2400 rules inserted. The rule base contains 1057 rules. 437 rules in the queue.
2600 rules inserted. The rule base contains 1152 rules. 389 rules in the queue.
2800 rules inserted. The rule base contains 1207 rules. 393 rules in the queue.
3000 rules inserted. The rule base contains 1289 rules. 429 rules in the queue.
3200 rules inserted. The rule base contains 1370 rules. 452 rules in the queue.
3400 rules inserted. The rule base contains 1476 rules. 444 rules in the queue.
3600 rules inserted. The rule base contains 1569 rules. 488 rules in the queue.
3800 rules inserted. The rule base contains 1643 rules. 455 rules in the queue.
4000 rules inserted. The rule base contains 1747 rules. 437 rules in the queue.
4200 rules inserted. The rule base contains 1862 rules. 417 rules in the queue.
4400 rules inserted. The rule base contains 1957 rules. 424 rules in the queue.
4600 rules inserted. The rule base contains 2052 rules. 407 rules in the queue.
4800 rules inserted. The rule base contains 2142 rules. 365 rules in the queue.
5000 rules inserted. The rule base contains 2281 rules. 316 rules in the queue.
5200 rules inserted. The rule base contains 2402 rules. 312 rules in the queue.
5400 rules inserted. The rule base contains 2467 rules. 370 rules in the queue.
5600 rules inserted. The rule base contains 2534 rules. 364 rules in the queue.
5800 rules inserted. The rule base contains 2574 rules. 278 rules in the queue.
6000 rules inserted. The rule base contains 2620 rules. 217 rules in the queue.
6200 rules inserted. The rule base contains 2601 rules. 163 rules in the queue.
6400 rules inserted. The rule base contains 2621 rules. 82 rules in the queue.
6600 rules inserted. The rule base contains 2693 rules. 29 rules in the queue.
Starting query event(ClientFinished(TLS12,cr_18,sr_12,NoPSK,p_7,o_16,m_10,ck_12,sk_8,cb_5,ms_9)) ==> event(ServerFinished(TLS12,cr_18,sr_12,NoPSK,p_7,o_16,m_10,ck_12,sk_8,cb_5,ms_9)) || event(WeakOrCompromisedKey(p_7)) || event(ServerChoosesKEX(cr_18,sr_12,p_7,TLS12,DHE(WeakDH))) || event(ServerChoosesKEX(cr'_5,sr'_3,p_7,TLS12,RSA(WeakRSADecryption)))
goal reachable: begin(ServerChoosesKEX(cr_18,sr_12,pk(k_4),TLS12,DHE(StrongDH))) && attacker(xxx_2) && attacker(a_13) && attacker(pt_9) && attacker(cr_18) && attacker(offer_2) && attacker(sn_2) && attacker(sr_13) && attacker(a_14) && attacker(pt_10) && attacker(o_16) -> end(ClientFinished(TLS12,cr_19,sr_13,NoPSK,pk(k_4),o_16,nego(TLS12,DHE(StrongDH),WeakHash,a_14,pt_10),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_19,sr_13)),client_key_expansion,(sr_13,cr_19))),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_19,sr_13)),server_key_expansion,(sr_13,cr_19))),tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_19,sr_13)),client_finished,((((CH(cr_19,o_16),SH(sr_13,nego(TLS12,DHE(StrongDH),WeakHash,a_14,pt_10))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,collision))),CKE(e2b(dh_ideal(G,x_4))))),tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_19,sr_13))))
Abbreviations:
cr_19 = cr[!1 = @sid]
k_4 = k_2[a_2 = sn_2,!1 = @sid_1]
x_4 = x_1[s = sign(k_4,collision),e = G,xxx = k_4,sn = sn_2,p = pk(k_4),mode = nego(TLS12,DHE(StrongDH),WeakHash,a_14,pt_10),sr = sr_13,offer = o_16,!1 = @sid]
sr_12 = sr_1[mode_1 = nego(TLS12,DHE(StrongDH),WeakHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = offer_2,cr_1 = cr_18,!1 = @sid_2]

Derivation:
Abbreviations:
cr_18 = cr[!1 = @sid]
k_4 = k_2[a_2 = sn_2,!1 = @sid_1]
x_4 = x_1[s = sign(k_4,collision),e = G,xxx = k_4,sn = sn_2,p = pk(k_4),mode = nego(TLS12,DHE(StrongDH),WeakHash,a_13,pt_9),sr = sr_12,offer = o_16,!1 = @sid]
x_5 = x_3[p_1 = pk(k_4),sk_2 = k_4,sn_1 = sn_2,mode_1 = nego(TLS12,DHE(StrongDH),WeakHash,a_14,pt_10),xxx_1 = xxx_2,offer_1 = offer_2,cr_1 = cr_19,!1 = @sid_2]
sr_13 = sr_1[mode_1 = nego(TLS12,DHE(StrongDH),WeakHash,a_14,pt_10),xxx_1 = xxx_2,offer_1 = offer_2,cr_1 = cr_19,!1 = @sid_2]

1. We assume as hypothesis that
attacker(o_16).

2. We assume as hypothesis that
attacker(pt_9).

3. We assume as hypothesis that
attacker(a_13).

4. Using the function WeakHash the attacker may obtain WeakHash.
attacker(WeakHash).

5. Using the function StrongDH the attacker may obtain StrongDH.
attacker(StrongDH).

6. By 5, the attacker may know StrongDH.
Using the function DHE the attacker may obtain DHE(StrongDH).
attacker(DHE(StrongDH)).

7. Using the function TLS12 the attacker may obtain TLS12.
attacker(TLS12).

8. By 7, the attacker may know TLS12.
By 6, the attacker may know DHE(StrongDH).
By 4, the attacker may know WeakHash.
By 3, the attacker may know a_13.
By 2, the attacker may know pt_9.
Using the function nego the attacker may obtain nego(TLS12,DHE(StrongDH),WeakHash,a_13,pt_9).
attacker(nego(TLS12,DHE(StrongDH),WeakHash,a_13,pt_9)).

9. We assume as hypothesis that
attacker(sr_12).

10. By 9, the attacker may know sr_12.
By 8, the attacker may know nego(TLS12,DHE(StrongDH),WeakHash,a_13,pt_9).
Using the function SH the attacker may obtain SH(sr_12,nego(TLS12,DHE(StrongDH),WeakHash,a_13,pt_9)).
attacker(SH(sr_12,nego(TLS12,DHE(StrongDH),WeakHash,a_13,pt_9))).

11. We assume as hypothesis that
attacker(sn_2).

12. The message sn_2 that the attacker may have by 11 may be received at input {104}.
So the message pk(k_4) may be sent to the attacker at output {107}.
attacker(pk(k_4)).

13. By 12, the attacker may know pk(k_4).
Using the function CRT the attacker may obtain CRT(pk(k_4)).
attacker(CRT(pk(k_4))).

14. The message sn_2 that the attacker may have by 11 may be received at input {104}.
So the entry longTermKeys_tbl(sn_2,k_4,pk(k_4)) may be inserted in a table at insert {106}.
table(longTermKeys_tbl(sn_2,k_4,pk(k_4))).

15. We assume as hypothesis that
attacker(offer_2).

16. We assume as hypothesis that
attacker(cr_19).

17. By 16, the attacker may know cr_19.
By 15, the attacker may know offer_2.
Using the function CH the attacker may obtain CH(cr_19,offer_2).
attacker(CH(cr_19,offer_2)).

18. We assume as hypothesis that
attacker(pt_10).

19. We assume as hypothesis that
attacker(a_14).

20. By 7, the attacker may know TLS12.
By 6, the attacker may know DHE(StrongDH).
By 4, the attacker may know WeakHash.
By 19, the attacker may know a_14.
By 18, the attacker may know pt_10.
Using the function nego the attacker may obtain nego(TLS12,DHE(StrongDH),WeakHash,a_14,pt_10).
attacker(nego(TLS12,DHE(StrongDH),WeakHash,a_14,pt_10)).

21. We assume as hypothesis that
attacker(xxx_2).

22. By 21, the attacker may know xxx_2.
By 20, the attacker may know nego(TLS12,DHE(StrongDH),WeakHash,a_14,pt_10).
Using the function SH the attacker may obtain SH(xxx_2,nego(TLS12,DHE(StrongDH),WeakHash,a_14,pt_10)).
attacker(SH(xxx_2,nego(TLS12,DHE(StrongDH),WeakHash,a_14,pt_10))).

23. The message CH(cr_19,offer_2) that the attacker may have by 17 may be received at input {47}.
The message SH(xxx_2,nego(TLS12,DHE(StrongDH),WeakHash,a_14,pt_10)) that the attacker may have by 22 may be received at input {48}.
The entry longTermKeys_tbl(sn_2,k_4,pk(k_4)) that may be in a table by 14 may be read at get {101}.
The event ServerChoosesKEX(cr_19,sr_13,pk(k_4),TLS12,DHE(StrongDH)) may be executed at {55}.
So the message SKE(StrongDH,dh_ideal(G,x_5),sign(k_4,collision)) may be sent to the attacker at output {65}.
attacker(SKE(StrongDH,dh_ideal(G,x_5),sign(k_4,collision))).

24. By 23, the attacker may know SKE(StrongDH,dh_ideal(G,x_5),sign(k_4,collision)).
Using the function 3-proj-SKE the attacker may obtain sign(k_4,collision).
attacker(sign(k_4,collision)).

25. Using the function G the attacker may obtain G.
attacker(G).

26. By 5, the attacker may know StrongDH.
By 25, the attacker may know G.
By 24, the attacker may know sign(k_4,collision).
Using the function SKE the attacker may obtain SKE(StrongDH,G,sign(k_4,collision)).
attacker(SKE(StrongDH,G,sign(k_4,collision))).

27. The message o_16 that the attacker may have by 1 may be received at input {3}.
The message SH(sr_12,nego(TLS12,DHE(StrongDH),WeakHash,a_13,pt_9)) that the attacker may have by 10 may be received at input {5}.
The message CRT(pk(k_4)) that the attacker may have by 13 may be received at input {9}.
The entry longTermKeys_tbl(sn_2,k_4,pk(k_4)) that may be in a table by 14 may be read at get {45}.
The message SKE(StrongDH,G,sign(k_4,collision)) that the attacker may have by 26 may be received at input {12}.
We have G ≠ BadElement.
So the message CKE(e2b(dh_ideal(G,x_4))) may be sent to the attacker at output {20}.
attacker(CKE(e2b(dh_ideal(G,x_4)))).

28. By 27, the attacker may know CKE(e2b(dh_ideal(G,x_4))).
Using the function 1-proj-CKE the attacker may obtain e2b(dh_ideal(G,x_4)).
attacker(e2b(dh_ideal(G,x_4))).

29. By 28, the attacker may know e2b(dh_ideal(G,x_4)).
Using the function 1-proj-e2b the attacker may obtain dh_ideal(G,x_4).
attacker(dh_ideal(G,x_4)).

30. By 29, the attacker may know dh_ideal(G,x_4).
Using the function e2b the attacker may obtain e2b(dh_ideal(G,x_4)).
attacker(e2b(dh_ideal(G,x_4))).

31. By 30, the attacker may know e2b(dh_ideal(G,x_4)).
Using the function CKE the attacker may obtain CKE(e2b(dh_ideal(G,x_4))).
attacker(CKE(e2b(dh_ideal(G,x_4)))).

32. The attacker has some term offer_3.
attacker(offer_3).

33. The message offer_3 that the attacker may have by 32 may be received at input {3}.
So the message CH(cr_18,offer_3) may be sent to the attacker at output {4}.
attacker(CH(cr_18,offer_3)).

34. By 33, the attacker may know CH(cr_18,offer_3).
Using the function 1-proj-CH the attacker may obtain cr_18.
attacker(cr_18).

35. By 34, the attacker may know cr_18.
By 1, the attacker may know o_16.
Using the function CH the attacker may obtain CH(cr_18,o_16).
attacker(CH(cr_18,o_16)).

36. By 35, the attacker may know CH(cr_18,o_16).
By 10, the attacker may know SH(sr_12,nego(TLS12,DHE(StrongDH),WeakHash,a_13,pt_9)).
Using the function 2-tuple the attacker may obtain (CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),WeakHash,a_13,pt_9))).
attacker((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),WeakHash,a_13,pt_9)))).

37. By 36, the attacker may know (CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),WeakHash,a_13,pt_9))).
By 13, the attacker may know CRT(pk(k_4)).
Using the function 2-tuple the attacker may obtain ((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),WeakHash,a_13,pt_9))),CRT(pk(k_4))).
attacker(((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),WeakHash,a_13,pt_9))),CRT(pk(k_4)))).

38. By 37, the attacker may know ((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),WeakHash,a_13,pt_9))),CRT(pk(k_4))).
By 26, the attacker may know SKE(StrongDH,G,sign(k_4,collision)).
Using the function 2-tuple the attacker may obtain (((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),WeakHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,collision))).
attacker((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),WeakHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,collision)))).

39. By 38, the attacker may know (((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),WeakHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,collision))).
By 31, the attacker may know CKE(e2b(dh_ideal(G,x_4))).
Using the function 2-tuple the attacker may obtain ((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),WeakHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,collision))),CKE(e2b(dh_ideal(G,x_4)))).
attacker(((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),WeakHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,collision))),CKE(e2b(dh_ideal(G,x_4))))).

40. Using the function client_finished the attacker may obtain client_finished.
attacker(client_finished).

41. By 34, the attacker may know cr_18.
By 9, the attacker may know sr_12.
Using the function 2-tuple the attacker may obtain (cr_18,sr_12).
attacker((cr_18,sr_12)).

42. Using the function master_secret the attacker may obtain master_secret.
attacker(master_secret).

43. By 30, the attacker may know e2b(dh_ideal(G,x_4)).
By 42, the attacker may know master_secret.
By 41, the attacker may know (cr_18,sr_12).
Using the function tls12_prf the attacker may obtain tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)).
attacker(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12))).

44. By 43, the attacker may know tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)).
By 40, the attacker may know client_finished.
By 39, the attacker may know ((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),WeakHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,collision))),CKE(e2b(dh_ideal(G,x_4)))).
Using the function tls12_prf the attacker may obtain tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),WeakHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,collision))),CKE(e2b(dh_ideal(G,x_4))))).
attacker(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),WeakHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,collision))),CKE(e2b(dh_ideal(G,x_4)))))).

45. By 44, the attacker may know tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),WeakHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,collision))),CKE(e2b(dh_ideal(G,x_4))))).
Using the function FIN the attacker may obtain FIN(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),WeakHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,collision))),CKE(e2b(dh_ideal(G,x_4)))))).
attacker(FIN(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),WeakHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,collision))),CKE(e2b(dh_ideal(G,x_4))))))).

46. By 39, the attacker may know ((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),WeakHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,collision))),CKE(e2b(dh_ideal(G,x_4)))).
By 45, the attacker may know FIN(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),WeakHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,collision))),CKE(e2b(dh_ideal(G,x_4)))))).
Using the function 2-tuple the attacker may obtain (((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),WeakHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,collision))),CKE(e2b(dh_ideal(G,x_4)))),FIN(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),WeakHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,collision))),CKE(e2b(dh_ideal(G,x_4))))))).
attacker((((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),WeakHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,collision))),CKE(e2b(dh_ideal(G,x_4)))),FIN(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),WeakHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,collision))),CKE(e2b(dh_ideal(G,x_4)))))))).

47. Using the function server_finished the attacker may obtain server_finished.
attacker(server_finished).

48. By 43, the attacker may know tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)).
By 47, the attacker may know server_finished.
By 46, the attacker may know (((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),WeakHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,collision))),CKE(e2b(dh_ideal(G,x_4)))),FIN(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),WeakHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,collision))),CKE(e2b(dh_ideal(G,x_4))))))).
Using the function tls12_prf the attacker may obtain tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),server_finished,(((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),WeakHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,collision))),CKE(e2b(dh_ideal(G,x_4)))),FIN(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),WeakHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,collision))),CKE(e2b(dh_ideal(G,x_4)))))))).
attacker(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),server_finished,(((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),WeakHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,collision))),CKE(e2b(dh_ideal(G,x_4)))),FIN(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),WeakHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,collision))),CKE(e2b(dh_ideal(G,x_4))))))))).

49. By 48, the attacker may know tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),server_finished,(((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),WeakHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,collision))),CKE(e2b(dh_ideal(G,x_4)))),FIN(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),WeakHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,collision))),CKE(e2b(dh_ideal(G,x_4)))))))).
Using the function FIN the attacker may obtain FIN(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),server_finished,(((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),WeakHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,collision))),CKE(e2b(dh_ideal(G,x_4)))),FIN(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),WeakHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,collision))),CKE(e2b(dh_ideal(G,x_4))))))))).
attacker(FIN(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),server_finished,(((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),WeakHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,collision))),CKE(e2b(dh_ideal(G,x_4)))),FIN(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),WeakHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,collision))),CKE(e2b(dh_ideal(G,x_4)))))))))).

50. The message o_16 that the attacker may have by 1 may be received at input {3}.
The message SH(sr_12,nego(TLS12,DHE(StrongDH),WeakHash,a_13,pt_9)) that the attacker may have by 10 may be received at input {5}.
The message CRT(pk(k_4)) that the attacker may have by 13 may be received at input {9}.
The entry longTermKeys_tbl(sn_2,k_4,pk(k_4)) that may be in a table by 14 may be read at get {45}.
The message SKE(StrongDH,G,sign(k_4,collision)) that the attacker may have by 26 may be received at input {12}.
The message FIN(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),server_finished,(((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),WeakHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,collision))),CKE(e2b(dh_ideal(G,x_4)))),FIN(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),WeakHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,collision))),CKE(e2b(dh_ideal(G,x_4))))))))) that the attacker may have by 49 may be received at input {25}.
We have G ≠ BadElement.
So event ClientFinished(TLS12,cr_18,sr_12,NoPSK,pk(k_4),o_16,nego(TLS12,DHE(StrongDH),WeakHash,a_13,pt_9),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),client_key_expansion,(sr_12,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),server_key_expansion,(sr_12,cr_18))),tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),WeakHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,collision))),CKE(e2b(dh_ideal(G,x_4))))),tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12))) may be executed at {29}.
end(ClientFinished(TLS12,cr_18,sr_12,NoPSK,pk(k_4),o_16,nego(TLS12,DHE(StrongDH),WeakHash,a_13,pt_9),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),client_key_expansion,(sr_12,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),server_key_expansion,(sr_12,cr_18))),tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),WeakHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,collision))),CKE(e2b(dh_ideal(G,x_4))))),tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)))).

51. By 50, end(ClientFinished(TLS12,cr_18,sr_12,NoPSK,pk(k_4),o_16,nego(TLS12,DHE(StrongDH),WeakHash,a_13,pt_9),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),client_key_expansion,(sr_12,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),server_key_expansion,(sr_12,cr_18))),tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),WeakHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,collision))),CKE(e2b(dh_ideal(G,x_4))))),tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)))).
The goal is reached, represented in the following fact:
end(ClientFinished(TLS12,cr_18,sr_12,NoPSK,pk(k_4),o_16,nego(TLS12,DHE(StrongDH),WeakHash,a_13,pt_9),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),client_key_expansion,(sr_12,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),server_key_expansion,(sr_12,cr_18))),tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),WeakHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,collision))),CKE(e2b(dh_ideal(G,x_4))))),tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)))).


Unified offer_2 with o_16
Iterating unifyDerivation.
Fixpoint reached: nothing more to unify.
The clause after unifyDerivation is
attacker(o_17) && attacker(pt_9) && attacker(a_13) && attacker(sr_12) && attacker(sn_2) && attacker(offer_3) && attacker(cr_18) && attacker(pt_10) && attacker(a_14) && attacker(xxx_2) && begin(ServerChoosesKEX(cr_18,sr_1[mode_1 = nego(TLS12,DHE(StrongDH),WeakHash,a_14,pt_10),xxx_1 = xxx_2,offer_1 = offer_3,cr_1 = cr_18,!1 = @sid],pk(k_2[a_2 = sn_2,!1 = @sid_1]),TLS12,DHE(StrongDH))) -> end(ClientFinished(TLS12,cr[!1 = @sid_2],sr_12,NoPSK,pk(k_2[a_2 = sn_2,!1 = @sid_1]),o_17,nego(TLS12,DHE(StrongDH),WeakHash,a_13,pt_9),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_1[s = sign(k_2[a_2 = sn_2,!1 = @sid_1],collision),e = G,xxx = k_2[a_2 = sn_2,!1 = @sid_1],sn = sn_2,p = pk(k_2[a_2 = sn_2,!1 = @sid_1]),mode = nego(TLS12,DHE(StrongDH),WeakHash,a_13,pt_9),sr = sr_12,offer = o_17,!1 = @sid_2])),master_secret,(cr[!1 = @sid_2],sr_12)),client_key_expansion,(sr_12,cr[!1 = @sid_2]))),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_1[s = sign(k_2[a_2 = sn_2,!1 = @sid_1],collision),e = G,xxx = k_2[a_2 = sn_2,!1 = @sid_1],sn = sn_2,p = pk(k_2[a_2 = sn_2,!1 = @sid_1]),mode = nego(TLS12,DHE(StrongDH),WeakHash,a_13,pt_9),sr = sr_12,offer = o_17,!1 = @sid_2])),master_secret,(cr[!1 = @sid_2],sr_12)),server_key_expansion,(sr_12,cr[!1 = @sid_2]))),tls12_prf(tls12_prf(e2b(dh_ideal(G,x_1[s = sign(k_2[a_2 = sn_2,!1 = @sid_1],collision),e = G,xxx = k_2[a_2 = sn_2,!1 = @sid_1],sn = sn_2,p = pk(k_2[a_2 = sn_2,!1 = @sid_1]),mode = nego(TLS12,DHE(StrongDH),WeakHash,a_13,pt_9),sr = sr_12,offer = o_17,!1 = @sid_2])),master_secret,(cr[!1 = @sid_2],sr_12)),client_finished,((((CH(cr[!1 = @sid_2],o_17),SH(sr_12,nego(TLS12,DHE(StrongDH),WeakHash,a_13,pt_9))),CRT(pk(k_2[a_2 = sn_2,!1 = @sid_1]))),SKE(StrongDH,G,sign(k_2[a_2 = sn_2,!1 = @sid_1],collision))),CKE(e2b(dh_ideal(G,x_1[s = sign(k_2[a_2 = sn_2,!1 = @sid_1],collision),e = G,xxx = k_2[a_2 = sn_2,!1 = @sid_1],sn = sn_2,p = pk(k_2[a_2 = sn_2,!1 = @sid_1]),mode = nego(TLS12,DHE(StrongDH),WeakHash,a_13,pt_9),sr = sr_12,offer = o_17,!1 = @sid_2]))))),tls12_prf(e2b(dh_ideal(G,x_1[s = sign(k_2[a_2 = sn_2,!1 = @sid_1],collision),e = G,xxx = k_2[a_2 = sn_2,!1 = @sid_1],sn = sn_2,p = pk(k_2[a_2 = sn_2,!1 = @sid_1]),mode = nego(TLS12,DHE(StrongDH),WeakHash,a_13,pt_9),sr = sr_12,offer = o_17,!1 = @sid_2])),master_secret,(cr[!1 = @sid_2],sr_12))))
This clause still contradicts the query.
A more detailed output of the traces is available with
  set traceDisplay = long.

new cr: random creating cr_19 at {2} in copy a_15

in(io, a_16) at {3} in copy a_15

out(io, CH(~M,~M_1)) with ~M = cr_19, ~M_1 = a_16 at {4} in copy a_15

in(io, SH(a_17,nego(TLS12,DHE(StrongDH),WeakHash,a_18,a_19))) at {5} in copy a_15

in(io, CH(a_20,a_21)) at {47} in copy a_22

in(io, SH(a_23,nego(TLS12,DHE(StrongDH),WeakHash,a_24,a_25))) at {48} in copy a_22

new sr_1: random creating sr_13 at {51} in copy a_22

out(io, SH(~M_2,nego(~M_3,DHE(StrongDH),WeakHash,~M_4,~M_5))) with ~M_2 = sr_13, ~M_3 = TLS12, ~M_4 = a_24, ~M_5 = a_25 at {52} in copy a_22

in(io, a_26) at {104} in copy a_27

new k_2: privkey creating k_4 at {105} in copy a_27

insert longTermKeys_tbl(a_26,k_4,pk(k_4)) at {106} in copy a_27

out(io, ~M_6) with ~M_6 = pk(k_4) at {107} in copy a_27

in(io, CRT(~M_6)) with ~M_6 = pk(k_4) at {9} in copy a_15

get longTermKeys_tbl(a_26,k_4,pk(k_4)) at {45} in copy a_15

get longTermKeys_tbl(a_26,k_4,pk(k_4)) at {101} in copy a_22

event ServerChoosesVersion(a_20,sr_13,pk(k_4),TLS12) at {54} in copy a_22

event ServerChoosesKEX(a_20,sr_13,pk(k_4),TLS12,DHE(StrongDH)) at {55} in copy a_22

event ServerChoosesAE(a_20,sr_13,pk(k_4),TLS12,a_24) at {56} in copy a_22

event ServerChoosesHash(a_20,sr_13,pk(k_4),TLS12,WeakHash) at {57} in copy a_22

out(io, CRT(~M_7)) with ~M_7 = pk(k_4) at {58} in copy a_22

new x_3: bitstring creating x_4 at {61} in copy a_22

out(io, SKE(StrongDH,~M_8,~M_9)) with ~M_8 = dh_ideal(G,x_4), ~M_9 = sign(k_4,collision) at {65} in copy a_22

in(io, SKE(StrongDH,G,~M_9)) with ~M_9 = sign(k_4,collision) at {12} in copy a_15

new x_1: bitstring creating x_5 at {15} in copy a_15

out(io, CKE(e2b(~M_10))) with ~M_10 = dh_ideal(G,x_5) at {20} in copy a_15

out(io, FIN(~M_11)) with ~M_11 = tls12_prf(tls12_prf(e2b(dh_ideal(G,x_5)),master_secret,(cr_19,a_17)),client_finished,((((CH(cr_19,a_16),SH(a_17,nego(TLS12,DHE(StrongDH),WeakHash,a_18,a_19))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,collision))),CKE(e2b(dh_ideal(G,x_5))))) at {23} in copy a_15

in(io, FIN(tls12_prf(tls12_prf(e2b(~M_10),master_secret,(~M,a_17)),server_finished,(((((CH(~M,a_16),SH(a_17,nego(TLS12,DHE(StrongDH),WeakHash,a_18,a_19))),CRT(~M_6)),SKE(StrongDH,G,~M_9)),CKE(e2b(~M_10))),FIN(tls12_prf(tls12_prf(e2b(~M_10),master_secret,(~M,a_17)),client_finished,((((CH(~M,a_16),SH(a_17,nego(TLS12,DHE(StrongDH),WeakHash,a_18,a_19))),CRT(~M_6)),SKE(StrongDH,G,~M_9)),CKE(e2b(~M_10))))))))) with tls12_prf(tls12_prf(e2b(~M_10),master_secret,(~M,a_17)),server_finished,(((((CH(~M,a_16),SH(a_17,nego(TLS12,DHE(StrongDH),WeakHash,a_18,a_19))),CRT(~M_6)),SKE(StrongDH,G,~M_9)),CKE(e2b(~M_10))),FIN(tls12_prf(tls12_prf(e2b(~M_10),master_secret,(~M,a_17)),client_finished,((((CH(~M,a_16),SH(a_17,nego(TLS12,DHE(StrongDH),WeakHash,a_18,a_19))),CRT(~M_6)),SKE(StrongDH,G,~M_9)),CKE(e2b(~M_10))))))) = tls12_prf(tls12_prf(e2b(dh_ideal(G,x_5)),master_secret,(cr_19,a_17)),server_finished,(((((CH(cr_19,a_16),SH(a_17,nego(TLS12,DHE(StrongDH),WeakHash,a_18,a_19))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,collision))),CKE(e2b(dh_ideal(G,x_5)))),FIN(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_5)),master_secret,(cr_19,a_17)),client_finished,((((CH(cr_19,a_16),SH(a_17,nego(TLS12,DHE(StrongDH),WeakHash,a_18,a_19))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,collision))),CKE(e2b(dh_ideal(G,x_5)))))))) at {25} in copy a_15

event ClientFinished(TLS12,cr_19,a_17,NoPSK,pk(k_4),a_16,nego(TLS12,DHE(StrongDH),WeakHash,a_18,a_19),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_5)),master_secret,(cr_19,a_17)),client_key_expansion,(a_17,cr_19))),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_5)),master_secret,(cr_19,a_17)),server_key_expansion,(a_17,cr_19))),tls12_prf(tls12_prf(e2b(dh_ideal(G,x_5)),master_secret,(cr_19,a_17)),client_finished,((((CH(cr_19,a_16),SH(a_17,nego(TLS12,DHE(StrongDH),WeakHash,a_18,a_19))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,collision))),CKE(e2b(dh_ideal(G,x_5))))),tls12_prf(e2b(dh_ideal(G,x_5)),master_secret,(cr_19,a_17))) at {29} in copy a_15 (goal)

The event ClientFinished(TLS12,cr_19,a_17,NoPSK,pk(k_4),a_16,nego(TLS12,DHE(StrongDH),WeakHash,a_18,a_19),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_5)),master_secret,(cr_19,a_17)),client_key_expansion,(a_17,cr_19))),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_5)),master_secret,(cr_19,a_17)),server_key_expansion,(a_17,cr_19))),tls12_prf(tls12_prf(e2b(dh_ideal(G,x_5)),master_secret,(cr_19,a_17)),client_finished,((((CH(cr_19,a_16),SH(a_17,nego(TLS12,DHE(StrongDH),WeakHash,a_18,a_19))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,collision))),CKE(e2b(dh_ideal(G,x_5))))),tls12_prf(e2b(dh_ideal(G,x_5)),master_secret,(cr_19,a_17))) is executed at {29} in copy a_15.
A trace has been found.
RESULT event(ClientFinished(TLS12,cr_18,sr_12,NoPSK,p_7,o_16,m_10,ck_12,sk_8,cb_5,ms_9)) ==> event(ServerFinished(TLS12,cr_18,sr_12,NoPSK,p_7,o_16,m_10,ck_12,sk_8,cb_5,ms_9)) || event(WeakOrCompromisedKey(p_7)) || event(ServerChoosesKEX(cr_18,sr_12,p_7,TLS12,DHE(WeakDH))) || event(ServerChoosesKEX(cr'_5,sr'_3,p_7,TLS12,RSA(WeakRSADecryption))) is false.
-- Query event(ClientFinished(TLS12,cr_18,sr_12,NoPSK,p_7,o_16,m_10,ck_12,sk_8,cb_5,ms_9)) ==> event(ServerFinished(TLS12,cr_18,sr_12,NoPSK,p_7,o_16,m_10,ck_12,sk_8,cb_5,ms_9)) || event(WeakOrCompromisedKey(p_7)) || event(ServerChoosesKEX(cr_18,sr_12,p_7,TLS12,DHE(WeakDH))) || event(ServerChoosesHash(cr'_5,sr'_3,p_7,TLS12,WeakHash)) in process 0.
Completing...
200 rules inserted. The rule base contains 200 rules. 140 rules in the queue.
400 rules inserted. The rule base contains 397 rules. 86 rules in the queue.
600 rules inserted. The rule base contains 511 rules. 142 rules in the queue.
800 rules inserted. The rule base contains 596 rules. 228 rules in the queue.
1000 rules inserted. The rule base contains 659 rules. 277 rules in the queue.
1200 rules inserted. The rule base contains 705 rules. 271 rules in the queue.
1400 rules inserted. The rule base contains 771 rules. 318 rules in the queue.
1600 rules inserted. The rule base contains 858 rules. 413 rules in the queue.
1800 rules inserted. The rule base contains 908 rules. 398 rules in the queue.
2000 rules inserted. The rule base contains 947 rules. 415 rules in the queue.
2200 rules inserted. The rule base contains 1009 rules. 429 rules in the queue.
2400 rules inserted. The rule base contains 1057 rules. 437 rules in the queue.
2600 rules inserted. The rule base contains 1152 rules. 389 rules in the queue.
2800 rules inserted. The rule base contains 1207 rules. 393 rules in the queue.
3000 rules inserted. The rule base contains 1289 rules. 429 rules in the queue.
3200 rules inserted. The rule base contains 1370 rules. 452 rules in the queue.
3400 rules inserted. The rule base contains 1476 rules. 444 rules in the queue.
3600 rules inserted. The rule base contains 1569 rules. 488 rules in the queue.
3800 rules inserted. The rule base contains 1643 rules. 455 rules in the queue.
4000 rules inserted. The rule base contains 1747 rules. 437 rules in the queue.
4200 rules inserted. The rule base contains 1862 rules. 417 rules in the queue.
4400 rules inserted. The rule base contains 1957 rules. 424 rules in the queue.
4600 rules inserted. The rule base contains 2052 rules. 407 rules in the queue.
4800 rules inserted. The rule base contains 2142 rules. 365 rules in the queue.
5000 rules inserted. The rule base contains 2281 rules. 316 rules in the queue.
5200 rules inserted. The rule base contains 2402 rules. 312 rules in the queue.
5400 rules inserted. The rule base contains 2467 rules. 370 rules in the queue.
5600 rules inserted. The rule base contains 2534 rules. 364 rules in the queue.
5800 rules inserted. The rule base contains 2574 rules. 278 rules in the queue.
6000 rules inserted. The rule base contains 2620 rules. 217 rules in the queue.
6200 rules inserted. The rule base contains 2601 rules. 163 rules in the queue.
6400 rules inserted. The rule base contains 2621 rules. 82 rules in the queue.
6600 rules inserted. The rule base contains 2693 rules. 29 rules in the queue.
Starting query event(ClientFinished(TLS12,cr_18,sr_12,NoPSK,p_7,o_16,m_10,ck_12,sk_8,cb_5,ms_9)) ==> event(ServerFinished(TLS12,cr_18,sr_12,NoPSK,p_7,o_16,m_10,ck_12,sk_8,cb_5,ms_9)) || event(WeakOrCompromisedKey(p_7)) || event(ServerChoosesKEX(cr_18,sr_12,p_7,TLS12,DHE(WeakDH))) || event(ServerChoosesHash(cr'_5,sr'_3,p_7,TLS12,WeakHash))
goal reachable: begin(ServerChoosesHash(cr_18,sr_12,pk(k_4),TLS12,h_2)) && begin(ServerChoosesKEX(cr_18,sr_12,pk(k_4),TLS12,RSA(WeakRSADecryption))) && attacker(xxx_2) && attacker(h_2) && attacker(a_13) && attacker(pt_9) && attacker(cr_18) && attacker(offer_2) && attacker(sn_2) && attacker(sr_13) && attacker(a_14) && attacker(pt_10) && attacker(o_16) -> end(ClientFinished(TLS12,cr_19,sr_13,NoPSK,pk(k_4),o_16,nego(TLS12,DHE(StrongDH),StrongHash,a_14,pt_10),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_19,sr_13)),client_key_expansion,(sr_13,cr_19))),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_19,sr_13)),server_key_expansion,(sr_13,cr_19))),tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_19,sr_13)),client_finished,((((CH(cr_19,o_16),SH(sr_13,nego(TLS12,DHE(StrongDH),StrongHash,a_14,pt_10))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,hash_ideal((cr_19,sr_13,StrongDH,G))))),CKE(e2b(dh_ideal(G,x_4))))),tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_19,sr_13))))
Abbreviations:
cr_19 = cr[!1 = @sid]
k_4 = k_2[a_2 = sn_2,!1 = @sid_1]
x_4 = x_1[s = sign(k_4,hash_ideal((cr_19,sr_13,StrongDH,G))),e = G,xxx = k_4,sn = sn_2,p = pk(k_4),mode = nego(TLS12,DHE(StrongDH),StrongHash,a_14,pt_10),sr = sr_13,offer = o_16,!1 = @sid]
sr_12 = sr_1[mode_1 = nego(TLS12,RSA(WeakRSADecryption),h_2,a_13,pt_9),xxx_1 = xxx_2,offer_1 = offer_2,cr_1 = cr_18,!1 = @sid_2]

Derivation:
Abbreviations:
cr_18 = cr[!1 = @sid]
k_4 = k_2[a_2 = sn_2,!1 = @sid_1]
x_4 = x_1[s = sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G))),e = G,xxx = k_4,sn = sn_2,p = pk(k_4),mode = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),sr = sr_12,offer = o_16,!1 = @sid]
sr_13 = sr_1[mode_1 = nego(TLS12,RSA(WeakRSADecryption),h_2,a_14,pt_10),xxx_1 = xxx_2,offer_1 = offer_2,cr_1 = cr_19,!1 = @sid_2]

1. We assume as hypothesis that
attacker(o_16).

2. We assume as hypothesis that
attacker(pt_9).

3. We assume as hypothesis that
attacker(a_13).

4. Using the function StrongHash the attacker may obtain StrongHash.
attacker(StrongHash).

5. Using the function StrongDH the attacker may obtain StrongDH.
attacker(StrongDH).

6. By 5, the attacker may know StrongDH.
Using the function DHE the attacker may obtain DHE(StrongDH).
attacker(DHE(StrongDH)).

7. Using the function TLS12 the attacker may obtain TLS12.
attacker(TLS12).

8. By 7, the attacker may know TLS12.
By 6, the attacker may know DHE(StrongDH).
By 4, the attacker may know StrongHash.
By 3, the attacker may know a_13.
By 2, the attacker may know pt_9.
Using the function nego the attacker may obtain nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9).
attacker(nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9)).

9. We assume as hypothesis that
attacker(sr_12).

10. By 9, the attacker may know sr_12.
By 8, the attacker may know nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9).
Using the function SH the attacker may obtain SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9)).
attacker(SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))).

11. We assume as hypothesis that
attacker(sn_2).

12. The message sn_2 that the attacker may have by 11 may be received at input {104}.
So the message pk(k_4) may be sent to the attacker at output {107}.
attacker(pk(k_4)).

13. By 12, the attacker may know pk(k_4).
Using the function CRT the attacker may obtain CRT(pk(k_4)).
attacker(CRT(pk(k_4))).

14. The message sn_2 that the attacker may have by 11 may be received at input {104}.
So the entry longTermKeys_tbl(sn_2,k_4,pk(k_4)) may be inserted in a table at insert {106}.
table(longTermKeys_tbl(sn_2,k_4,pk(k_4))).

15. We assume as hypothesis that
attacker(offer_2).

16. We assume as hypothesis that
attacker(cr_19).

17. By 16, the attacker may know cr_19.
By 15, the attacker may know offer_2.
Using the function CH the attacker may obtain CH(cr_19,offer_2).
attacker(CH(cr_19,offer_2)).

18. We assume as hypothesis that
attacker(pt_10).

19. We assume as hypothesis that
attacker(a_14).

20. We assume as hypothesis that
attacker(h_2).

21. Using the function WeakRSADecryption the attacker may obtain WeakRSADecryption.
attacker(WeakRSADecryption).

22. By 21, the attacker may know WeakRSADecryption.
Using the function RSA the attacker may obtain RSA(WeakRSADecryption).
attacker(RSA(WeakRSADecryption)).

23. By 7, the attacker may know TLS12.
By 22, the attacker may know RSA(WeakRSADecryption).
By 20, the attacker may know h_2.
By 19, the attacker may know a_14.
By 18, the attacker may know pt_10.
Using the function nego the attacker may obtain nego(TLS12,RSA(WeakRSADecryption),h_2,a_14,pt_10).
attacker(nego(TLS12,RSA(WeakRSADecryption),h_2,a_14,pt_10)).

24. We assume as hypothesis that
attacker(xxx_2).

25. By 24, the attacker may know xxx_2.
By 23, the attacker may know nego(TLS12,RSA(WeakRSADecryption),h_2,a_14,pt_10).
Using the function SH the attacker may obtain SH(xxx_2,nego(TLS12,RSA(WeakRSADecryption),h_2,a_14,pt_10)).
attacker(SH(xxx_2,nego(TLS12,RSA(WeakRSADecryption),h_2,a_14,pt_10))).

26. Using the function G the attacker may obtain G.
attacker(G).

27. The attacker has some term offer_3.
attacker(offer_3).

28. The message offer_3 that the attacker may have by 27 may be received at input {3}.
So the message CH(cr_18,offer_3) may be sent to the attacker at output {4}.
attacker(CH(cr_18,offer_3)).

29. By 28, the attacker may know CH(cr_18,offer_3).
Using the function 1-proj-CH the attacker may obtain cr_18.
attacker(cr_18).

30. By 29, the attacker may know cr_18.
By 9, the attacker may know sr_12.
By 5, the attacker may know StrongDH.
By 26, the attacker may know G.
Using the function 4-tuple the attacker may obtain (cr_18,sr_12,StrongDH,G).
attacker((cr_18,sr_12,StrongDH,G)).

31. By 30, the attacker may know (cr_18,sr_12,StrongDH,G).
Using the function hash_ideal the attacker may obtain hash_ideal((cr_18,sr_12,StrongDH,G)).
attacker(hash_ideal((cr_18,sr_12,StrongDH,G))).

32. By 12, the attacker may know pk(k_4).
By 31, the attacker may know hash_ideal((cr_18,sr_12,StrongDH,G)).
Using the function rsa_enc the attacker may obtain rsa_enc(pk(k_4),hash_ideal((cr_18,sr_12,StrongDH,G))).
attacker(rsa_enc(pk(k_4),hash_ideal((cr_18,sr_12,StrongDH,G)))).

33. By 32, the attacker may know rsa_enc(pk(k_4),hash_ideal((cr_18,sr_12,StrongDH,G))).
Using the function CKE the attacker may obtain CKE(rsa_enc(pk(k_4),hash_ideal((cr_18,sr_12,StrongDH,G)))).
attacker(CKE(rsa_enc(pk(k_4),hash_ideal((cr_18,sr_12,StrongDH,G))))).

34. The message CH(cr_19,offer_2) that the attacker may have by 17 may be received at input {47}.
The message SH(xxx_2,nego(TLS12,RSA(WeakRSADecryption),h_2,a_14,pt_10)) that the attacker may have by 25 may be received at input {48}.
The entry longTermKeys_tbl(sn_2,k_4,pk(k_4)) that may be in a table by 14 may be read at get {101}.
The event ServerChoosesKEX(cr_19,sr_13,pk(k_4),TLS12,RSA(WeakRSADecryption)) may be executed at {55}.
The event ServerChoosesHash(cr_19,sr_13,pk(k_4),TLS12,h_2) may be executed at {57}.
The message CKE(rsa_enc(pk(k_4),hash_ideal((cr_18,sr_12,StrongDH,G)))) that the attacker may have by 33 may be received at input {84}.
So the message (hash_ideal((cr_18,sr_12,StrongDH,G)),sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G)))) may be sent to the attacker at output {87}.
attacker((hash_ideal((cr_18,sr_12,StrongDH,G)),sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G))))).

35. By 34, the attacker may know (hash_ideal((cr_18,sr_12,StrongDH,G)),sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G)))).
Using the function 2-proj-2-tuple the attacker may obtain sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G))).
attacker(sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G)))).

36. By 5, the attacker may know StrongDH.
By 26, the attacker may know G.
By 35, the attacker may know sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G))).
Using the function SKE the attacker may obtain SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G)))).
attacker(SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G))))).

37. The message o_16 that the attacker may have by 1 may be received at input {3}.
The message SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9)) that the attacker may have by 10 may be received at input {5}.
The message CRT(pk(k_4)) that the attacker may have by 13 may be received at input {9}.
The entry longTermKeys_tbl(sn_2,k_4,pk(k_4)) that may be in a table by 14 may be read at get {45}.
The message SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G)))) that the attacker may have by 36 may be received at input {12}.
We have G ≠ BadElement.
So the message CKE(e2b(dh_ideal(G,x_4))) may be sent to the attacker at output {20}.
attacker(CKE(e2b(dh_ideal(G,x_4)))).

38. By 37, the attacker may know CKE(e2b(dh_ideal(G,x_4))).
Using the function 1-proj-CKE the attacker may obtain e2b(dh_ideal(G,x_4)).
attacker(e2b(dh_ideal(G,x_4))).

39. By 38, the attacker may know e2b(dh_ideal(G,x_4)).
Using the function 1-proj-e2b the attacker may obtain dh_ideal(G,x_4).
attacker(dh_ideal(G,x_4)).

40. By 39, the attacker may know dh_ideal(G,x_4).
Using the function e2b the attacker may obtain e2b(dh_ideal(G,x_4)).
attacker(e2b(dh_ideal(G,x_4))).

41. By 40, the attacker may know e2b(dh_ideal(G,x_4)).
Using the function CKE the attacker may obtain CKE(e2b(dh_ideal(G,x_4))).
attacker(CKE(e2b(dh_ideal(G,x_4)))).

42. By 29, the attacker may know cr_18.
By 1, the attacker may know o_16.
Using the function CH the attacker may obtain CH(cr_18,o_16).
attacker(CH(cr_18,o_16)).

43. By 42, the attacker may know CH(cr_18,o_16).
By 10, the attacker may know SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9)).
Using the function 2-tuple the attacker may obtain (CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))).
attacker((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9)))).

44. By 43, the attacker may know (CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))).
By 13, the attacker may know CRT(pk(k_4)).
Using the function 2-tuple the attacker may obtain ((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))).
attacker(((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4)))).

45. By 44, the attacker may know ((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))).
By 36, the attacker may know SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G)))).
Using the function 2-tuple the attacker may obtain (((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G))))).
attacker((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G)))))).

46. By 45, the attacker may know (((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G))))).
By 41, the attacker may know CKE(e2b(dh_ideal(G,x_4))).
Using the function 2-tuple the attacker may obtain ((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G))))),CKE(e2b(dh_ideal(G,x_4)))).
attacker(((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G))))),CKE(e2b(dh_ideal(G,x_4))))).

47. Using the function client_finished the attacker may obtain client_finished.
attacker(client_finished).

48. By 29, the attacker may know cr_18.
By 9, the attacker may know sr_12.
Using the function 2-tuple the attacker may obtain (cr_18,sr_12).
attacker((cr_18,sr_12)).

49. Using the function master_secret the attacker may obtain master_secret.
attacker(master_secret).

50. By 40, the attacker may know e2b(dh_ideal(G,x_4)).
By 49, the attacker may know master_secret.
By 48, the attacker may know (cr_18,sr_12).
Using the function tls12_prf the attacker may obtain tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)).
attacker(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12))).

51. By 50, the attacker may know tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)).
By 47, the attacker may know client_finished.
By 46, the attacker may know ((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G))))),CKE(e2b(dh_ideal(G,x_4)))).
Using the function tls12_prf the attacker may obtain tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G))))),CKE(e2b(dh_ideal(G,x_4))))).
attacker(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G))))),CKE(e2b(dh_ideal(G,x_4)))))).

52. By 51, the attacker may know tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G))))),CKE(e2b(dh_ideal(G,x_4))))).
Using the function FIN the attacker may obtain FIN(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G))))),CKE(e2b(dh_ideal(G,x_4)))))).
attacker(FIN(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G))))),CKE(e2b(dh_ideal(G,x_4))))))).

53. By 46, the attacker may know ((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G))))),CKE(e2b(dh_ideal(G,x_4)))).
By 52, the attacker may know FIN(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G))))),CKE(e2b(dh_ideal(G,x_4)))))).
Using the function 2-tuple the attacker may obtain (((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G))))),CKE(e2b(dh_ideal(G,x_4)))),FIN(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G))))),CKE(e2b(dh_ideal(G,x_4))))))).
attacker((((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G))))),CKE(e2b(dh_ideal(G,x_4)))),FIN(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G))))),CKE(e2b(dh_ideal(G,x_4)))))))).

54. Using the function server_finished the attacker may obtain server_finished.
attacker(server_finished).

55. By 50, the attacker may know tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)).
By 54, the attacker may know server_finished.
By 53, the attacker may know (((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G))))),CKE(e2b(dh_ideal(G,x_4)))),FIN(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G))))),CKE(e2b(dh_ideal(G,x_4))))))).
Using the function tls12_prf the attacker may obtain tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),server_finished,(((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G))))),CKE(e2b(dh_ideal(G,x_4)))),FIN(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G))))),CKE(e2b(dh_ideal(G,x_4)))))))).
attacker(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),server_finished,(((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G))))),CKE(e2b(dh_ideal(G,x_4)))),FIN(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G))))),CKE(e2b(dh_ideal(G,x_4))))))))).

56. By 55, the attacker may know tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),server_finished,(((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G))))),CKE(e2b(dh_ideal(G,x_4)))),FIN(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G))))),CKE(e2b(dh_ideal(G,x_4)))))))).
Using the function FIN the attacker may obtain FIN(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),server_finished,(((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G))))),CKE(e2b(dh_ideal(G,x_4)))),FIN(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G))))),CKE(e2b(dh_ideal(G,x_4))))))))).
attacker(FIN(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),server_finished,(((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G))))),CKE(e2b(dh_ideal(G,x_4)))),FIN(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G))))),CKE(e2b(dh_ideal(G,x_4)))))))))).

57. The message o_16 that the attacker may have by 1 may be received at input {3}.
The message SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9)) that the attacker may have by 10 may be received at input {5}.
The message CRT(pk(k_4)) that the attacker may have by 13 may be received at input {9}.
The entry longTermKeys_tbl(sn_2,k_4,pk(k_4)) that may be in a table by 14 may be read at get {45}.
The message SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G)))) that the attacker may have by 36 may be received at input {12}.
The message FIN(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),server_finished,(((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G))))),CKE(e2b(dh_ideal(G,x_4)))),FIN(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G))))),CKE(e2b(dh_ideal(G,x_4))))))))) that the attacker may have by 56 may be received at input {25}.
We have G ≠ BadElement.
So event ClientFinished(TLS12,cr_18,sr_12,NoPSK,pk(k_4),o_16,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),client_key_expansion,(sr_12,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),server_key_expansion,(sr_12,cr_18))),tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G))))),CKE(e2b(dh_ideal(G,x_4))))),tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12))) may be executed at {29}.
end(ClientFinished(TLS12,cr_18,sr_12,NoPSK,pk(k_4),o_16,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),client_key_expansion,(sr_12,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),server_key_expansion,(sr_12,cr_18))),tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G))))),CKE(e2b(dh_ideal(G,x_4))))),tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)))).

58. By 57, end(ClientFinished(TLS12,cr_18,sr_12,NoPSK,pk(k_4),o_16,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),client_key_expansion,(sr_12,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),server_key_expansion,(sr_12,cr_18))),tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G))))),CKE(e2b(dh_ideal(G,x_4))))),tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)))).
The goal is reached, represented in the following fact:
end(ClientFinished(TLS12,cr_18,sr_12,NoPSK,pk(k_4),o_16,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),client_key_expansion,(sr_12,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),server_key_expansion,(sr_12,cr_18))),tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,hash_ideal((cr_18,sr_12,StrongDH,G))))),CKE(e2b(dh_ideal(G,x_4))))),tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_18,sr_12)))).


Unified offer_2 with o_16
Iterating unifyDerivation.
Fixpoint reached: nothing more to unify.
The clause after unifyDerivation is
attacker(o_17) && attacker(pt_9) && attacker(a_13) && attacker(sr_12) && attacker(sn_2) && attacker(offer_3) && attacker(cr_18) && attacker(pt_10) && attacker(a_14) && attacker(h_2) && attacker(xxx_2) && begin(ServerChoosesKEX(cr_18,sr_1[mode_1 = nego(TLS12,RSA(WeakRSADecryption),h_2,a_14,pt_10),xxx_1 = xxx_2,offer_1 = offer_3,cr_1 = cr_18,!1 = @sid],pk(k_2[a_2 = sn_2,!1 = @sid_1]),TLS12,RSA(WeakRSADecryption))) && begin(ServerChoosesHash(cr_18,sr_1[mode_1 = nego(TLS12,RSA(WeakRSADecryption),h_2,a_14,pt_10),xxx_1 = xxx_2,offer_1 = offer_3,cr_1 = cr_18,!1 = @sid],pk(k_2[a_2 = sn_2,!1 = @sid_1]),TLS12,h_2)) -> end(ClientFinished(TLS12,cr[!1 = @sid_2],sr_12,NoPSK,pk(k_2[a_2 = sn_2,!1 = @sid_1]),o_17,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_1[s = sign(k_2[a_2 = sn_2,!1 = @sid_1],hash_ideal((cr[!1 = @sid_2],sr_12,StrongDH,G))),e = G,xxx = k_2[a_2 = sn_2,!1 = @sid_1],sn = sn_2,p = pk(k_2[a_2 = sn_2,!1 = @sid_1]),mode = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),sr = sr_12,offer = o_17,!1 = @sid_2])),master_secret,(cr[!1 = @sid_2],sr_12)),client_key_expansion,(sr_12,cr[!1 = @sid_2]))),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_1[s = sign(k_2[a_2 = sn_2,!1 = @sid_1],hash_ideal((cr[!1 = @sid_2],sr_12,StrongDH,G))),e = G,xxx = k_2[a_2 = sn_2,!1 = @sid_1],sn = sn_2,p = pk(k_2[a_2 = sn_2,!1 = @sid_1]),mode = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),sr = sr_12,offer = o_17,!1 = @sid_2])),master_secret,(cr[!1 = @sid_2],sr_12)),server_key_expansion,(sr_12,cr[!1 = @sid_2]))),tls12_prf(tls12_prf(e2b(dh_ideal(G,x_1[s = sign(k_2[a_2 = sn_2,!1 = @sid_1],hash_ideal((cr[!1 = @sid_2],sr_12,StrongDH,G))),e = G,xxx = k_2[a_2 = sn_2,!1 = @sid_1],sn = sn_2,p = pk(k_2[a_2 = sn_2,!1 = @sid_1]),mode = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),sr = sr_12,offer = o_17,!1 = @sid_2])),master_secret,(cr[!1 = @sid_2],sr_12)),client_finished,((((CH(cr[!1 = @sid_2],o_17),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(k_2[a_2 = sn_2,!1 = @sid_1]))),SKE(StrongDH,G,sign(k_2[a_2 = sn_2,!1 = @sid_1],hash_ideal((cr[!1 = @sid_2],sr_12,StrongDH,G))))),CKE(e2b(dh_ideal(G,x_1[s = sign(k_2[a_2 = sn_2,!1 = @sid_1],hash_ideal((cr[!1 = @sid_2],sr_12,StrongDH,G))),e = G,xxx = k_2[a_2 = sn_2,!1 = @sid_1],sn = sn_2,p = pk(k_2[a_2 = sn_2,!1 = @sid_1]),mode = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),sr = sr_12,offer = o_17,!1 = @sid_2]))))),tls12_prf(e2b(dh_ideal(G,x_1[s = sign(k_2[a_2 = sn_2,!1 = @sid_1],hash_ideal((cr[!1 = @sid_2],sr_12,StrongDH,G))),e = G,xxx = k_2[a_2 = sn_2,!1 = @sid_1],sn = sn_2,p = pk(k_2[a_2 = sn_2,!1 = @sid_1]),mode = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),sr = sr_12,offer = o_17,!1 = @sid_2])),master_secret,(cr[!1 = @sid_2],sr_12))))
This clause still contradicts the query.
A more detailed output of the traces is available with
  set traceDisplay = long.

new cr: random creating cr_19 at {2} in copy a_15

in(io, a_16) at {3} in copy a_15

out(io, CH(~M,~M_1)) with ~M = cr_19, ~M_1 = a_16 at {4} in copy a_15

in(io, SH(a_17,nego(TLS12,DHE(StrongDH),StrongHash,a_18,a_19))) at {5} in copy a_15

in(io, CH(a_20,a_21)) at {47} in copy a_22

in(io, SH(a_23,nego(TLS12,RSA(WeakRSADecryption),a_24,a_25,a_26))) at {48} in copy a_22

new sr_1: random creating sr_13 at {51} in copy a_22

out(io, SH(~M_2,nego(~M_3,RSA(~M_4),~M_5,~M_6,~M_7))) with ~M_2 = sr_13, ~M_3 = TLS12, ~M_4 = WeakRSADecryption, ~M_5 = a_24, ~M_6 = a_25, ~M_7 = a_26 at {52} in copy a_22

in(io, a_27) at {104} in copy a_28

new k_2: privkey creating k_4 at {105} in copy a_28

insert longTermKeys_tbl(a_27,k_4,pk(k_4)) at {106} in copy a_28

out(io, ~M_8) with ~M_8 = pk(k_4) at {107} in copy a_28

in(io, CRT(~M_8)) with ~M_8 = pk(k_4) at {9} in copy a_15

get longTermKeys_tbl(a_27,k_4,pk(k_4)) at {45} in copy a_15

get longTermKeys_tbl(a_27,k_4,pk(k_4)) at {101} in copy a_22

event ServerChoosesVersion(a_20,sr_13,pk(k_4),TLS12) at {54} in copy a_22

event ServerChoosesKEX(a_20,sr_13,pk(k_4),TLS12,RSA(WeakRSADecryption)) at {55} in copy a_22

event ServerChoosesAE(a_20,sr_13,pk(k_4),TLS12,a_25) at {56} in copy a_22

event ServerChoosesHash(a_20,sr_13,pk(k_4),TLS12,a_24) at {57} in copy a_22

out(io, CRT(~M_9)) with ~M_9 = pk(k_4) at {58} in copy a_22

in(io, CKE(rsa_enc(~M_8,hash_ideal((~M,a_17,StrongDH,G))))) with rsa_enc(~M_8,hash_ideal((~M,a_17,StrongDH,G))) = rsa_enc(pk(k_4),hash_ideal((cr_19,a_17,StrongDH,G))) at {84} in copy a_22

out(io, (~M_10,~M_11)) with ~M_10 = hash_ideal((cr_19,a_17,StrongDH,G)), ~M_11 = sign(k_4,hash_ideal((cr_19,a_17,StrongDH,G))) at {87} in copy a_22

in(io, SKE(StrongDH,G,~M_11)) with ~M_11 = sign(k_4,hash_ideal((cr_19,a_17,StrongDH,G))) at {12} in copy a_15

new x_1: bitstring creating x_4 at {15} in copy a_15

out(io, CKE(e2b(~M_12))) with ~M_12 = dh_ideal(G,x_4) at {20} in copy a_15

out(io, FIN(~M_13)) with ~M_13 = tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_19,a_17)),client_finished,((((CH(cr_19,a_16),SH(a_17,nego(TLS12,DHE(StrongDH),StrongHash,a_18,a_19))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,hash_ideal((cr_19,a_17,StrongDH,G))))),CKE(e2b(dh_ideal(G,x_4))))) at {23} in copy a_15

in(io, FIN(tls12_prf(tls12_prf(e2b(~M_12),master_secret,(~M,a_17)),server_finished,(((((CH(~M,a_16),SH(a_17,nego(TLS12,DHE(StrongDH),StrongHash,a_18,a_19))),CRT(~M_8)),SKE(StrongDH,G,~M_11)),CKE(e2b(~M_12))),FIN(tls12_prf(tls12_prf(e2b(~M_12),master_secret,(~M,a_17)),client_finished,((((CH(~M,a_16),SH(a_17,nego(TLS12,DHE(StrongDH),StrongHash,a_18,a_19))),CRT(~M_8)),SKE(StrongDH,G,~M_11)),CKE(e2b(~M_12))))))))) with tls12_prf(tls12_prf(e2b(~M_12),master_secret,(~M,a_17)),server_finished,(((((CH(~M,a_16),SH(a_17,nego(TLS12,DHE(StrongDH),StrongHash,a_18,a_19))),CRT(~M_8)),SKE(StrongDH,G,~M_11)),CKE(e2b(~M_12))),FIN(tls12_prf(tls12_prf(e2b(~M_12),master_secret,(~M,a_17)),client_finished,((((CH(~M,a_16),SH(a_17,nego(TLS12,DHE(StrongDH),StrongHash,a_18,a_19))),CRT(~M_8)),SKE(StrongDH,G,~M_11)),CKE(e2b(~M_12))))))) = tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_19,a_17)),server_finished,(((((CH(cr_19,a_16),SH(a_17,nego(TLS12,DHE(StrongDH),StrongHash,a_18,a_19))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,hash_ideal((cr_19,a_17,StrongDH,G))))),CKE(e2b(dh_ideal(G,x_4)))),FIN(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_19,a_17)),client_finished,((((CH(cr_19,a_16),SH(a_17,nego(TLS12,DHE(StrongDH),StrongHash,a_18,a_19))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,hash_ideal((cr_19,a_17,StrongDH,G))))),CKE(e2b(dh_ideal(G,x_4)))))))) at {25} in copy a_15

event ClientFinished(TLS12,cr_19,a_17,NoPSK,pk(k_4),a_16,nego(TLS12,DHE(StrongDH),StrongHash,a_18,a_19),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_19,a_17)),client_key_expansion,(a_17,cr_19))),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_19,a_17)),server_key_expansion,(a_17,cr_19))),tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_19,a_17)),client_finished,((((CH(cr_19,a_16),SH(a_17,nego(TLS12,DHE(StrongDH),StrongHash,a_18,a_19))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,hash_ideal((cr_19,a_17,StrongDH,G))))),CKE(e2b(dh_ideal(G,x_4))))),tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_19,a_17))) at {29} in copy a_15 (goal)

The event ClientFinished(TLS12,cr_19,a_17,NoPSK,pk(k_4),a_16,nego(TLS12,DHE(StrongDH),StrongHash,a_18,a_19),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_19,a_17)),client_key_expansion,(a_17,cr_19))),b2ae(tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_19,a_17)),server_key_expansion,(a_17,cr_19))),tls12_prf(tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_19,a_17)),client_finished,((((CH(cr_19,a_16),SH(a_17,nego(TLS12,DHE(StrongDH),StrongHash,a_18,a_19))),CRT(pk(k_4))),SKE(StrongDH,G,sign(k_4,hash_ideal((cr_19,a_17,StrongDH,G))))),CKE(e2b(dh_ideal(G,x_4))))),tls12_prf(e2b(dh_ideal(G,x_4)),master_secret,(cr_19,a_17))) is executed at {29} in copy a_15.
A trace has been found.
RESULT event(ClientFinished(TLS12,cr_18,sr_12,NoPSK,p_7,o_16,m_10,ck_12,sk_8,cb_5,ms_9)) ==> event(ServerFinished(TLS12,cr_18,sr_12,NoPSK,p_7,o_16,m_10,ck_12,sk_8,cb_5,ms_9)) || event(WeakOrCompromisedKey(p_7)) || event(ServerChoosesKEX(cr_18,sr_12,p_7,TLS12,DHE(WeakDH))) || event(ServerChoosesHash(cr'_5,sr'_3,p_7,TLS12,WeakHash)) is false.
-- Query event(ClientFinished(TLS12,cr_18,sr_12,NoPSK,p_7,o_16,m_10,ck_12,sk_8,cb_5,ms_9)) ==> event(ServerFinished(TLS12,cr_18,sr_12,NoPSK,p_7,o_16,m_10,ck_12,sk_8,cb_5,ms_9)) || event(WeakOrCompromisedKey(p_7)) || event(ServerChoosesKEX(cr'_5,sr'_3,p_7,TLS12,RSA(WeakRSADecryption))) || event(ServerChoosesHash(cr'_5,sr'_3,p_7,TLS12,WeakHash)) in process 0.
Completing...
200 rules inserted. The rule base contains 200 rules. 140 rules in the queue.
400 rules inserted. The rule base contains 397 rules. 86 rules in the queue.
600 rules inserted. The rule base contains 511 rules. 142 rules in the queue.
800 rules inserted. The rule base contains 596 rules. 228 rules in the queue.
1000 rules inserted. The rule base contains 659 rules. 277 rules in the queue.
1200 rules inserted. The rule base contains 705 rules. 271 rules in the queue.
1400 rules inserted. The rule base contains 771 rules. 318 rules in the queue.
1600 rules inserted. The rule base contains 858 rules. 413 rules in the queue.
1800 rules inserted. The rule base contains 908 rules. 398 rules in the queue.
2000 rules inserted. The rule base contains 947 rules. 415 rules in the queue.
2200 rules inserted. The rule base contains 1009 rules. 429 rules in the queue.
2400 rules inserted. The rule base contains 1057 rules. 437 rules in the queue.
2600 rules inserted. The rule base contains 1152 rules. 389 rules in the queue.
2800 rules inserted. The rule base contains 1207 rules. 393 rules in the queue.
3000 rules inserted. The rule base contains 1289 rules. 429 rules in the queue.
3200 rules inserted. The rule base contains 1370 rules. 452 rules in the queue.
3400 rules inserted. The rule base contains 1476 rules. 444 rules in the queue.
3600 rules inserted. The rule base contains 1569 rules. 488 rules in the queue.
3800 rules inserted. The rule base contains 1643 rules. 455 rules in the queue.
4000 rules inserted. The rule base contains 1747 rules. 437 rules in the queue.
4200 rules inserted. The rule base contains 1862 rules. 417 rules in the queue.
4400 rules inserted. The rule base contains 1957 rules. 424 rules in the queue.
4600 rules inserted. The rule base contains 2052 rules. 407 rules in the queue.
4800 rules inserted. The rule base contains 2142 rules. 365 rules in the queue.
5000 rules inserted. The rule base contains 2281 rules. 316 rules in the queue.
5200 rules inserted. The rule base contains 2402 rules. 312 rules in the queue.
5400 rules inserted. The rule base contains 2467 rules. 370 rules in the queue.
5600 rules inserted. The rule base contains 2534 rules. 364 rules in the queue.
5800 rules inserted. The rule base contains 2574 rules. 278 rules in the queue.
6000 rules inserted. The rule base contains 2620 rules. 217 rules in the queue.
6200 rules inserted. The rule base contains 2601 rules. 163 rules in the queue.
6400 rules inserted. The rule base contains 2621 rules. 82 rules in the queue.
6600 rules inserted. The rule base contains 2693 rules. 29 rules in the queue.
Starting query event(ClientFinished(TLS12,cr_18,sr_12,NoPSK,p_7,o_16,m_10,ck_12,sk_8,cb_5,ms_9)) ==> event(ServerFinished(TLS12,cr_18,sr_12,NoPSK,p_7,o_16,m_10,ck_12,sk_8,cb_5,ms_9)) || event(WeakOrCompromisedKey(p_7)) || event(ServerChoosesKEX(cr'_5,sr'_3,p_7,TLS12,RSA(WeakRSADecryption))) || event(ServerChoosesHash(cr'_5,sr'_3,p_7,TLS12,WeakHash))
goal reachable: begin(ServerChoosesHash(cr_18,sr_12,pk(k_4),TLS12,StrongHash)) && begin(ServerChoosesKEX(cr_18,sr_12,pk(k_4),TLS12,DHE(WeakDH))) && attacker(sn_2) && attacker(xxx_2) && attacker(a_13) && attacker(pt_9) && attacker(offer_2) && attacker(a_14) && attacker(pt_10) && attacker(o_16) -> end(ClientFinished(TLS12,cr_18,sr_12,NoPSK,pk(k_4),o_16,nego(TLS12,DHE(WeakDH),StrongHash,a_14,pt_10),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_key_expansion,(sr_12,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),server_key_expansion,(sr_12,cr_18))),tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,a_14,pt_10))),CRT(pk(k_4))),SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))))),CKE(e2b(BadElement)))),tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12))))
Abbreviations:
cr_18 = cr[!1 = @sid]
sr_12 = sr_1[mode_1 = nego(TLS12,DHE(WeakDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = offer_2,cr_1 = cr_18,!1 = @sid_1]
k_4 = k_2[a_2 = sn_2,!1 = @sid_2]

Derivation:
Abbreviations:
cr_18 = cr[!1 = @sid]
sr_12 = sr_1[mode_1 = nego(TLS12,DHE(WeakDH),StrongHash,a_13,pt_9),xxx_1 = xxx_2,offer_1 = offer_2,cr_1 = cr_18,!1 = @sid_1]
k_4 = k_2[a_2 = sn_2,!1 = @sid_2]

1. We assume as hypothesis that
attacker(o_16).

2. We assume as hypothesis that
attacker(pt_10).

3. We assume as hypothesis that
attacker(a_14).

4. Using the function StrongHash the attacker may obtain StrongHash.
attacker(StrongHash).

5. Using the function WeakDH the attacker may obtain WeakDH.
attacker(WeakDH).

6. By 5, the attacker may know WeakDH.
Using the function DHE the attacker may obtain DHE(WeakDH).
attacker(DHE(WeakDH)).

7. Using the function TLS12 the attacker may obtain TLS12.
attacker(TLS12).

8. By 7, the attacker may know TLS12.
By 6, the attacker may know DHE(WeakDH).
By 4, the attacker may know StrongHash.
By 3, the attacker may know a_14.
By 2, the attacker may know pt_10.
Using the function nego the attacker may obtain nego(TLS12,DHE(WeakDH),StrongHash,a_14,pt_10).
attacker(nego(TLS12,DHE(WeakDH),StrongHash,a_14,pt_10)).

9. We assume as hypothesis that
attacker(offer_2).

10. The attacker has some term offer_3.
attacker(offer_3).

11. The message offer_3 that the attacker may have by 10 may be received at input {3}.
So the message CH(cr_18,offer_3) may be sent to the attacker at output {4}.
attacker(CH(cr_18,offer_3)).

12. By 11, the attacker may know CH(cr_18,offer_3).
Using the function 1-proj-CH the attacker may obtain cr_18.
attacker(cr_18).

13. By 12, the attacker may know cr_18.
By 9, the attacker may know offer_2.
Using the function CH the attacker may obtain CH(cr_18,offer_2).
attacker(CH(cr_18,offer_2)).

14. We assume as hypothesis that
attacker(pt_9).

15. We assume as hypothesis that
attacker(a_13).

16. By 7, the attacker may know TLS12.
By 6, the attacker may know DHE(WeakDH).
By 4, the attacker may know StrongHash.
By 15, the attacker may know a_13.
By 14, the attacker may know pt_9.
Using the function nego the attacker may obtain nego(TLS12,DHE(WeakDH),StrongHash,a_13,pt_9).
attacker(nego(TLS12,DHE(WeakDH),StrongHash,a_13,pt_9)).

17. We assume as hypothesis that
attacker(xxx_2).

18. By 17, the attacker may know xxx_2.
By 16, the attacker may know nego(TLS12,DHE(WeakDH),StrongHash,a_13,pt_9).
Using the function SH the attacker may obtain SH(xxx_2,nego(TLS12,DHE(WeakDH),StrongHash,a_13,pt_9)).
attacker(SH(xxx_2,nego(TLS12,DHE(WeakDH),StrongHash,a_13,pt_9))).

19. The message CH(cr_18,offer_2) that the attacker may have by 13 may be received at input {47}.
The message SH(xxx_2,nego(TLS12,DHE(WeakDH),StrongHash,a_13,pt_9)) that the attacker may have by 18 may be received at input {48}.
So the message SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,a_13,pt_9)) may be sent to the attacker at output {52}.
attacker(SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,a_13,pt_9))).

20. By 19, the attacker may know SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,a_13,pt_9)).
Using the function 1-proj-SH the attacker may obtain sr_12.
attacker(sr_12).

21. By 20, the attacker may know sr_12.
By 8, the attacker may know nego(TLS12,DHE(WeakDH),StrongHash,a_14,pt_10).
Using the function SH the attacker may obtain SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,a_14,pt_10)).
attacker(SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,a_14,pt_10))).

22. We assume as hypothesis that
attacker(sn_2).

23. The message sn_2 that the attacker may have by 22 may be received at input {104}.
So the message pk(k_4) may be sent to the attacker at output {107}.
attacker(pk(k_4)).

24. By 23, the attacker may know pk(k_4).
Using the function CRT the attacker may obtain CRT(pk(k_4)).
attacker(CRT(pk(k_4))).

25. The message sn_2 that the attacker may have by 22 may be received at input {104}.
So the entry longTermKeys_tbl(sn_2,k_4,pk(k_4)) may be inserted in a table at insert {106}.
table(longTermKeys_tbl(sn_2,k_4,pk(k_4))).

26. The message CH(cr_18,offer_2) that the attacker may have by 13 may be received at input {47}.
The message SH(xxx_2,nego(TLS12,DHE(WeakDH),StrongHash,a_13,pt_9)) that the attacker may have by 18 may be received at input {48}.
The entry longTermKeys_tbl(sn_2,k_4,pk(k_4)) that may be in a table by 25 may be read at get {101}.
The event ServerChoosesKEX(cr_18,sr_12,pk(k_4),TLS12,DHE(WeakDH)) may be executed at {55}.
The event ServerChoosesHash(cr_18,sr_12,pk(k_4),TLS12,StrongHash) may be executed at {57}.
So the message SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement)))) may be sent to the attacker at output {65}.
attacker(SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))))).

27. By 26, the attacker may know SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement)))).
Using the function 3-proj-SKE the attacker may obtain sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))).
attacker(sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement)))).

28. Using the function BadElement the attacker may obtain BadElement.
attacker(BadElement).

29. By 5, the attacker may know WeakDH.
By 28, the attacker may know BadElement.
By 27, the attacker may know sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))).
Using the function SKE the attacker may obtain SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement)))).
attacker(SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))))).

30. By 28, the attacker may know BadElement.
Using the function e2b the attacker may obtain e2b(BadElement).
attacker(e2b(BadElement)).

31. By 30, the attacker may know e2b(BadElement).
Using the function CKE the attacker may obtain CKE(e2b(BadElement)).
attacker(CKE(e2b(BadElement))).

32. By 12, the attacker may know cr_18.
By 1, the attacker may know o_16.
Using the function CH the attacker may obtain CH(cr_18,o_16).
attacker(CH(cr_18,o_16)).

33. By 32, the attacker may know CH(cr_18,o_16).
By 21, the attacker may know SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,a_14,pt_10)).
Using the function 2-tuple the attacker may obtain (CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,a_14,pt_10))).
attacker((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,a_14,pt_10)))).

34. By 33, the attacker may know (CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,a_14,pt_10))).
By 24, the attacker may know CRT(pk(k_4)).
Using the function 2-tuple the attacker may obtain ((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,a_14,pt_10))),CRT(pk(k_4))).
attacker(((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,a_14,pt_10))),CRT(pk(k_4)))).

35. By 34, the attacker may know ((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,a_14,pt_10))),CRT(pk(k_4))).
By 29, the attacker may know SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement)))).
Using the function 2-tuple the attacker may obtain (((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,a_14,pt_10))),CRT(pk(k_4))),SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))))).
attacker((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,a_14,pt_10))),CRT(pk(k_4))),SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement)))))).

36. By 35, the attacker may know (((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,a_14,pt_10))),CRT(pk(k_4))),SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))))).
By 31, the attacker may know CKE(e2b(BadElement)).
Using the function 2-tuple the attacker may obtain ((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,a_14,pt_10))),CRT(pk(k_4))),SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))))),CKE(e2b(BadElement))).
attacker(((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,a_14,pt_10))),CRT(pk(k_4))),SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))))),CKE(e2b(BadElement)))).

37. Using the function client_finished the attacker may obtain client_finished.
attacker(client_finished).

38. By 12, the attacker may know cr_18.
By 20, the attacker may know sr_12.
Using the function 2-tuple the attacker may obtain (cr_18,sr_12).
attacker((cr_18,sr_12)).

39. Using the function master_secret the attacker may obtain master_secret.
attacker(master_secret).

40. By 30, the attacker may know e2b(BadElement).
By 39, the attacker may know master_secret.
By 38, the attacker may know (cr_18,sr_12).
Using the function tls12_prf the attacker may obtain tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)).
attacker(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12))).

41. By 40, the attacker may know tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)).
By 37, the attacker may know client_finished.
By 36, the attacker may know ((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,a_14,pt_10))),CRT(pk(k_4))),SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))))),CKE(e2b(BadElement))).
Using the function tls12_prf the attacker may obtain tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,a_14,pt_10))),CRT(pk(k_4))),SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))))),CKE(e2b(BadElement)))).
attacker(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,a_14,pt_10))),CRT(pk(k_4))),SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))))),CKE(e2b(BadElement))))).

42. By 41, the attacker may know tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,a_14,pt_10))),CRT(pk(k_4))),SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))))),CKE(e2b(BadElement)))).
Using the function FIN the attacker may obtain FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,a_14,pt_10))),CRT(pk(k_4))),SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))))),CKE(e2b(BadElement))))).
attacker(FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,a_14,pt_10))),CRT(pk(k_4))),SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))))),CKE(e2b(BadElement)))))).

43. By 36, the attacker may know ((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,a_14,pt_10))),CRT(pk(k_4))),SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))))),CKE(e2b(BadElement))).
By 42, the attacker may know FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,a_14,pt_10))),CRT(pk(k_4))),SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))))),CKE(e2b(BadElement))))).
Using the function 2-tuple the attacker may obtain (((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,a_14,pt_10))),CRT(pk(k_4))),SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))))),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,a_14,pt_10))),CRT(pk(k_4))),SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))))),CKE(e2b(BadElement)))))).
attacker((((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,a_14,pt_10))),CRT(pk(k_4))),SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))))),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,a_14,pt_10))),CRT(pk(k_4))),SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))))),CKE(e2b(BadElement))))))).

44. Using the function server_finished the attacker may obtain server_finished.
attacker(server_finished).

45. By 40, the attacker may know tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)).
By 44, the attacker may know server_finished.
By 43, the attacker may know (((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,a_14,pt_10))),CRT(pk(k_4))),SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))))),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,a_14,pt_10))),CRT(pk(k_4))),SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))))),CKE(e2b(BadElement)))))).
Using the function tls12_prf the attacker may obtain tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),server_finished,(((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,a_14,pt_10))),CRT(pk(k_4))),SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))))),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,a_14,pt_10))),CRT(pk(k_4))),SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))))),CKE(e2b(BadElement))))))).
attacker(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),server_finished,(((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,a_14,pt_10))),CRT(pk(k_4))),SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))))),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,a_14,pt_10))),CRT(pk(k_4))),SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))))),CKE(e2b(BadElement)))))))).

46. By 45, the attacker may know tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),server_finished,(((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,a_14,pt_10))),CRT(pk(k_4))),SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))))),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,a_14,pt_10))),CRT(pk(k_4))),SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))))),CKE(e2b(BadElement))))))).
Using the function FIN the attacker may obtain FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),server_finished,(((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,a_14,pt_10))),CRT(pk(k_4))),SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))))),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,a_14,pt_10))),CRT(pk(k_4))),SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))))),CKE(e2b(BadElement)))))))).
attacker(FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),server_finished,(((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,a_14,pt_10))),CRT(pk(k_4))),SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))))),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,a_14,pt_10))),CRT(pk(k_4))),SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))))),CKE(e2b(BadElement))))))))).

47. The message o_16 that the attacker may have by 1 may be received at input {3}.
The message SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,a_14,pt_10)) that the attacker may have by 21 may be received at input {5}.
The message CRT(pk(k_4)) that the attacker may have by 24 may be received at input {9}.
The entry longTermKeys_tbl(sn_2,k_4,pk(k_4)) that may be in a table by 25 may be read at get {45}.
The message SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement)))) that the attacker may have by 29 may be received at input {12}.
The message FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),server_finished,(((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,a_14,pt_10))),CRT(pk(k_4))),SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))))),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,a_14,pt_10))),CRT(pk(k_4))),SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))))),CKE(e2b(BadElement)))))))) that the attacker may have by 46 may be received at input {25}.
So event ClientFinished(TLS12,cr_18,sr_12,NoPSK,pk(k_4),o_16,nego(TLS12,DHE(WeakDH),StrongHash,a_14,pt_10),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_key_expansion,(sr_12,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),server_key_expansion,(sr_12,cr_18))),tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,a_14,pt_10))),CRT(pk(k_4))),SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))))),CKE(e2b(BadElement)))),tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12))) may be executed at {29}.
end(ClientFinished(TLS12,cr_18,sr_12,NoPSK,pk(k_4),o_16,nego(TLS12,DHE(WeakDH),StrongHash,a_14,pt_10),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_key_expansion,(sr_12,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),server_key_expansion,(sr_12,cr_18))),tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,a_14,pt_10))),CRT(pk(k_4))),SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))))),CKE(e2b(BadElement)))),tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)))).

48. By 47, end(ClientFinished(TLS12,cr_18,sr_12,NoPSK,pk(k_4),o_16,nego(TLS12,DHE(WeakDH),StrongHash,a_14,pt_10),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_key_expansion,(sr_12,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),server_key_expansion,(sr_12,cr_18))),tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,a_14,pt_10))),CRT(pk(k_4))),SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))))),CKE(e2b(BadElement)))),tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)))).
The goal is reached, represented in the following fact:
end(ClientFinished(TLS12,cr_18,sr_12,NoPSK,pk(k_4),o_16,nego(TLS12,DHE(WeakDH),StrongHash,a_14,pt_10),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_key_expansion,(sr_12,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),server_key_expansion,(sr_12,cr_18))),tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,a_14,pt_10))),CRT(pk(k_4))),SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))))),CKE(e2b(BadElement)))),tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)))).


Unified offer_2 with o_16
Iterating unifyDerivation.
Fixpoint reached: nothing more to unify.
The clause after unifyDerivation is
attacker(o_17) && attacker(pt_9) && attacker(a_13) && attacker(offer_3) && attacker(pt_10) && attacker(a_14) && attacker(xxx_2) && attacker(sn_2) && begin(ServerChoosesKEX(cr[!1 = @sid],sr_1[mode_1 = nego(TLS12,DHE(WeakDH),StrongHash,a_14,pt_10),xxx_1 = xxx_2,offer_1 = offer_3,cr_1 = cr[!1 = @sid],!1 = @sid_1],pk(k_2[a_2 = sn_2,!1 = @sid_2]),TLS12,DHE(WeakDH))) && begin(ServerChoosesHash(cr[!1 = @sid],sr_1[mode_1 = nego(TLS12,DHE(WeakDH),StrongHash,a_14,pt_10),xxx_1 = xxx_2,offer_1 = offer_3,cr_1 = cr[!1 = @sid],!1 = @sid_1],pk(k_2[a_2 = sn_2,!1 = @sid_2]),TLS12,StrongHash)) -> end(ClientFinished(TLS12,cr[!1 = @sid],sr_1[mode_1 = nego(TLS12,DHE(WeakDH),StrongHash,a_14,pt_10),xxx_1 = xxx_2,offer_1 = offer_3,cr_1 = cr[!1 = @sid],!1 = @sid_1],NoPSK,pk(k_2[a_2 = sn_2,!1 = @sid_2]),o_17,nego(TLS12,DHE(WeakDH),StrongHash,a_13,pt_9),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr[!1 = @sid],sr_1[mode_1 = nego(TLS12,DHE(WeakDH),StrongHash,a_14,pt_10),xxx_1 = xxx_2,offer_1 = offer_3,cr_1 = cr[!1 = @sid],!1 = @sid_1])),client_key_expansion,(sr_1[mode_1 = nego(TLS12,DHE(WeakDH),StrongHash,a_14,pt_10),xxx_1 = xxx_2,offer_1 = offer_3,cr_1 = cr[!1 = @sid],!1 = @sid_1],cr[!1 = @sid]))),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr[!1 = @sid],sr_1[mode_1 = nego(TLS12,DHE(WeakDH),StrongHash,a_14,pt_10),xxx_1 = xxx_2,offer_1 = offer_3,cr_1 = cr[!1 = @sid],!1 = @sid_1])),server_key_expansion,(sr_1[mode_1 = nego(TLS12,DHE(WeakDH),StrongHash,a_14,pt_10),xxx_1 = xxx_2,offer_1 = offer_3,cr_1 = cr[!1 = @sid],!1 = @sid_1],cr[!1 = @sid]))),tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr[!1 = @sid],sr_1[mode_1 = nego(TLS12,DHE(WeakDH),StrongHash,a_14,pt_10),xxx_1 = xxx_2,offer_1 = offer_3,cr_1 = cr[!1 = @sid],!1 = @sid_1])),client_finished,((((CH(cr[!1 = @sid],o_17),SH(sr_1[mode_1 = nego(TLS12,DHE(WeakDH),StrongHash,a_14,pt_10),xxx_1 = xxx_2,offer_1 = offer_3,cr_1 = cr[!1 = @sid],!1 = @sid_1],nego(TLS12,DHE(WeakDH),StrongHash,a_13,pt_9))),CRT(pk(k_2[a_2 = sn_2,!1 = @sid_2]))),SKE(WeakDH,BadElement,sign(k_2[a_2 = sn_2,!1 = @sid_2],hash_ideal((cr[!1 = @sid],sr_1[mode_1 = nego(TLS12,DHE(WeakDH),StrongHash,a_14,pt_10),xxx_1 = xxx_2,offer_1 = offer_3,cr_1 = cr[!1 = @sid],!1 = @sid_1],WeakDH,BadElement))))),CKE(e2b(BadElement)))),tls12_prf(e2b(BadElement),master_secret,(cr[!1 = @sid],sr_1[mode_1 = nego(TLS12,DHE(WeakDH),StrongHash,a_14,pt_10),xxx_1 = xxx_2,offer_1 = offer_3,cr_1 = cr[!1 = @sid],!1 = @sid_1]))))
This clause still contradicts the query.
A more detailed output of the traces is available with
  set traceDisplay = long.

new cr: random creating cr_18 at {2} in copy a_15

in(io, a_16) at {3} in copy a_15

out(io, CH(~M,~M_1)) with ~M = cr_18, ~M_1 = a_16 at {4} in copy a_15

in(io, CH(~M,a_17)) with ~M = cr_18 at {47} in copy a_18

in(io, SH(a_19,nego(TLS12,DHE(WeakDH),StrongHash,a_20,a_21))) at {48} in copy a_18

new sr_1: random creating sr_12 at {51} in copy a_18

out(io, SH(~M_2,nego(~M_3,DHE(WeakDH),StrongHash,~M_4,~M_5))) with ~M_2 = sr_12, ~M_3 = TLS12, ~M_4 = a_20, ~M_5 = a_21 at {52} in copy a_18

in(io, SH(~M_2,nego(TLS12,DHE(WeakDH),StrongHash,a_22,a_23))) with ~M_2 = sr_12 at {5} in copy a_15

in(io, a_24) at {104} in copy a_25

new k_2: privkey creating k_4 at {105} in copy a_25

insert longTermKeys_tbl(a_24,k_4,pk(k_4)) at {106} in copy a_25

out(io, ~M_6) with ~M_6 = pk(k_4) at {107} in copy a_25

in(io, CRT(~M_6)) with ~M_6 = pk(k_4) at {9} in copy a_15

get longTermKeys_tbl(a_24,k_4,pk(k_4)) at {45} in copy a_15

get longTermKeys_tbl(a_24,k_4,pk(k_4)) at {101} in copy a_18

event ServerChoosesVersion(cr_18,sr_12,pk(k_4),TLS12) at {54} in copy a_18

event ServerChoosesKEX(cr_18,sr_12,pk(k_4),TLS12,DHE(WeakDH)) at {55} in copy a_18

event ServerChoosesAE(cr_18,sr_12,pk(k_4),TLS12,a_20) at {56} in copy a_18

event ServerChoosesHash(cr_18,sr_12,pk(k_4),TLS12,StrongHash) at {57} in copy a_18

out(io, CRT(~M_7)) with ~M_7 = pk(k_4) at {58} in copy a_18

new x_3: bitstring creating x_4 at {61} in copy a_18

out(io, SKE(WeakDH,BadElement,~M_8)) with ~M_8 = sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))) at {65} in copy a_18

in(io, SKE(WeakDH,BadElement,~M_8)) with ~M_8 = sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))) at {12} in copy a_15

new x_1: bitstring creating x_5 at {15} in copy a_15

out(io, CKE(e2b(BadElement))) at {20} in copy a_15

out(io, FIN(~M_9)) with ~M_9 = tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,a_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,a_22,a_23))),CRT(pk(k_4))),SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))))),CKE(e2b(BadElement)))) at {23} in copy a_15

in(io, FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(~M,~M_2)),server_finished,(((((CH(~M,a_16),SH(~M_2,nego(TLS12,DHE(WeakDH),StrongHash,a_22,a_23))),CRT(~M_6)),SKE(WeakDH,BadElement,~M_8)),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(~M,~M_2)),client_finished,((((CH(~M,a_16),SH(~M_2,nego(TLS12,DHE(WeakDH),StrongHash,a_22,a_23))),CRT(~M_6)),SKE(WeakDH,BadElement,~M_8)),CKE(e2b(BadElement))))))))) with tls12_prf(tls12_prf(e2b(BadElement),master_secret,(~M,~M_2)),server_finished,(((((CH(~M,a_16),SH(~M_2,nego(TLS12,DHE(WeakDH),StrongHash,a_22,a_23))),CRT(~M_6)),SKE(WeakDH,BadElement,~M_8)),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(~M,~M_2)),client_finished,((((CH(~M,a_16),SH(~M_2,nego(TLS12,DHE(WeakDH),StrongHash,a_22,a_23))),CRT(~M_6)),SKE(WeakDH,BadElement,~M_8)),CKE(e2b(BadElement))))))) = tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),server_finished,(((((CH(cr_18,a_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,a_22,a_23))),CRT(pk(k_4))),SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))))),CKE(e2b(BadElement))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,a_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,a_22,a_23))),CRT(pk(k_4))),SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))))),CKE(e2b(BadElement))))))) at {25} in copy a_15

event ClientFinished(TLS12,cr_18,sr_12,NoPSK,pk(k_4),a_16,nego(TLS12,DHE(WeakDH),StrongHash,a_22,a_23),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_key_expansion,(sr_12,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),server_key_expansion,(sr_12,cr_18))),tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,a_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,a_22,a_23))),CRT(pk(k_4))),SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))))),CKE(e2b(BadElement)))),tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12))) at {29} in copy a_15 (goal)

The event ClientFinished(TLS12,cr_18,sr_12,NoPSK,pk(k_4),a_16,nego(TLS12,DHE(WeakDH),StrongHash,a_22,a_23),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_key_expansion,(sr_12,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),server_key_expansion,(sr_12,cr_18))),tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,a_16),SH(sr_12,nego(TLS12,DHE(WeakDH),StrongHash,a_22,a_23))),CRT(pk(k_4))),SKE(WeakDH,BadElement,sign(k_4,hash_ideal((cr_18,sr_12,WeakDH,BadElement))))),CKE(e2b(BadElement)))),tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12))) is executed at {29} in copy a_15.
A trace has been found.
RESULT event(ClientFinished(TLS12,cr_18,sr_12,NoPSK,p_7,o_16,m_10,ck_12,sk_8,cb_5,ms_9)) ==> event(ServerFinished(TLS12,cr_18,sr_12,NoPSK,p_7,o_16,m_10,ck_12,sk_8,cb_5,ms_9)) || event(WeakOrCompromisedKey(p_7)) || event(ServerChoosesKEX(cr'_5,sr'_3,p_7,TLS12,RSA(WeakRSADecryption))) || event(ServerChoosesHash(cr'_5,sr'_3,p_7,TLS12,WeakHash)) is false.
-- Query event(ClientFinished(TLS12,cr_18,sr_12,NoPSK,p_7,o_16,m_10,ck_12,sk_8,cb_5,ms_9)) ==> event(ServerFinished(TLS12,cr_18,sr_12,NoPSK,p_7,o_16,m_10,ck_12,sk_8,cb_5,ms_9)) || event(ServerChoosesKEX(cr_18,sr_12,p_7,TLS12,DHE(WeakDH))) || event(ServerChoosesKEX(cr'_5,sr'_3,p_7,TLS12,RSA(WeakRSADecryption))) || event(ServerChoosesHash(cr'_5,sr'_3,p_7,TLS12,WeakHash)) in process 0.
Completing...
200 rules inserted. The rule base contains 200 rules. 140 rules in the queue.
400 rules inserted. The rule base contains 396 rules. 81 rules in the queue.
600 rules inserted. The rule base contains 518 rules. 146 rules in the queue.
800 rules inserted. The rule base contains 586 rules. 217 rules in the queue.
1000 rules inserted. The rule base contains 644 rules. 259 rules in the queue.
1200 rules inserted. The rule base contains 702 rules. 297 rules in the queue.
1400 rules inserted. The rule base contains 750 rules. 309 rules in the queue.
1600 rules inserted. The rule base contains 846 rules. 406 rules in the queue.
1800 rules inserted. The rule base contains 886 rules. 397 rules in the queue.
2000 rules inserted. The rule base contains 934 rules. 399 rules in the queue.
2200 rules inserted. The rule base contains 984 rules. 411 rules in the queue.
2400 rules inserted. The rule base contains 1042 rules. 423 rules in the queue.
2600 rules inserted. The rule base contains 1134 rules. 404 rules in the queue.
2800 rules inserted. The rule base contains 1184 rules. 420 rules in the queue.
3000 rules inserted. The rule base contains 1270 rules. 451 rules in the queue.
3200 rules inserted. The rule base contains 1386 rules. 428 rules in the queue.
3400 rules inserted. The rule base contains 1463 rules. 476 rules in the queue.
3600 rules inserted. The rule base contains 1540 rules. 486 rules in the queue.
3800 rules inserted. The rule base contains 1649 rules. 425 rules in the queue.
4000 rules inserted. The rule base contains 1763 rules. 426 rules in the queue.
4200 rules inserted. The rule base contains 1864 rules. 416 rules in the queue.
4400 rules inserted. The rule base contains 1940 rules. 393 rules in the queue.
4600 rules inserted. The rule base contains 2053 rules. 377 rules in the queue.
4800 rules inserted. The rule base contains 2162 rules. 312 rules in the queue.
5000 rules inserted. The rule base contains 2279 rules. 341 rules in the queue.
5200 rules inserted. The rule base contains 2394 rules. 330 rules in the queue.
5400 rules inserted. The rule base contains 2459 rules. 357 rules in the queue.
5600 rules inserted. The rule base contains 2497 rules. 334 rules in the queue.
5800 rules inserted. The rule base contains 2520 rules. 234 rules in the queue.
6000 rules inserted. The rule base contains 2522 rules. 170 rules in the queue.
6200 rules inserted. The rule base contains 2560 rules. 109 rules in the queue.
6400 rules inserted. The rule base contains 2595 rules. 32 rules in the queue.
Starting query event(ClientFinished(TLS12,cr_18,sr_12,NoPSK,p_7,o_16,m_10,ck_12,sk_8,cb_5,ms_9)) ==> event(ServerFinished(TLS12,cr_18,sr_12,NoPSK,p_7,o_16,m_10,ck_12,sk_8,cb_5,ms_9)) || event(ServerChoosesKEX(cr_18,sr_12,p_7,TLS12,DHE(WeakDH))) || event(ServerChoosesKEX(cr'_5,sr'_3,p_7,TLS12,RSA(WeakRSADecryption))) || event(ServerChoosesHash(cr'_5,sr'_3,p_7,TLS12,WeakHash))
goal reachable: attacker(sn_2) && attacker(xxx_2) && attacker(sr_12) && attacker(a_13) && attacker(pt_9) && attacker(o_16) -> end(ClientFinished(TLS12,cr_18,sr_12,NoPSK,pk(xxx_2),o_16,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_key_expansion,(sr_12,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),server_key_expansion,(sr_12,cr_18))),tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(xxx_2))),SKE(StrongDH,BadElement,sign(xxx_2,hash_ideal((cr_18,sr_12,StrongDH,BadElement))))),CKE(e2b(dh_ideal(G,x_4))))),tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12))))
Abbreviations:
cr_18 = cr[!1 = @sid]
x_4 = x_1[s = sign(xxx_2,hash_ideal((cr_18,sr_12,StrongDH,BadElement))),e = BadElement,xxx = xxx_2,sn = sn_2,p = pk(xxx_2),mode = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),sr = sr_12,offer = o_16,!1 = @sid]

Derivation:
Abbreviations:
cr_18 = cr[!1 = @sid]
x_4 = x_1[s = sign(xxx_2,hash_ideal((cr_18,sr_12,StrongDH,BadElement))),e = BadElement,xxx = xxx_2,sn = sn_2,p = pk(xxx_2),mode = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),sr = sr_12,offer = o_16,!1 = @sid]

1. We assume as hypothesis that
attacker(o_16).

2. We assume as hypothesis that
attacker(pt_9).

3. We assume as hypothesis that
attacker(a_13).

4. Using the function StrongHash the attacker may obtain StrongHash.
attacker(StrongHash).

5. Using the function StrongDH the attacker may obtain StrongDH.
attacker(StrongDH).

6. By 5, the attacker may know StrongDH.
Using the function DHE the attacker may obtain DHE(StrongDH).
attacker(DHE(StrongDH)).

7. Using the function TLS12 the attacker may obtain TLS12.
attacker(TLS12).

8. By 7, the attacker may know TLS12.
By 6, the attacker may know DHE(StrongDH).
By 4, the attacker may know StrongHash.
By 3, the attacker may know a_13.
By 2, the attacker may know pt_9.
Using the function nego the attacker may obtain nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9).
attacker(nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9)).

9. We assume as hypothesis that
attacker(sr_12).

10. By 9, the attacker may know sr_12.
By 8, the attacker may know nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9).
Using the function SH the attacker may obtain SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9)).
attacker(SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))).

11. We assume as hypothesis that
attacker(xxx_2).

12. By 11, the attacker may know xxx_2.
Using the function pk the attacker may obtain pk(xxx_2).
attacker(pk(xxx_2)).

13. By 12, the attacker may know pk(xxx_2).
Using the function CRT the attacker may obtain CRT(pk(xxx_2)).
attacker(CRT(pk(xxx_2))).

14. We assume as hypothesis that
attacker(sn_2).

15. By 14, the attacker may know sn_2.
By 11, the attacker may know xxx_2.
Using the function 2-tuple the attacker may obtain (sn_2,xxx_2).
attacker((sn_2,xxx_2)).

16. The message (sn_2,xxx_2) that the attacker may have by 15 may be received at input {108}.
So the entry longTermKeys_tbl(sn_2,xxx_2,pk(xxx_2)) may be inserted in a table at insert {110}.
table(longTermKeys_tbl(sn_2,xxx_2,pk(xxx_2))).

17. Using the function BadElement the attacker may obtain BadElement.
attacker(BadElement).

18. The attacker has some term offer_2.
attacker(offer_2).

19. The message offer_2 that the attacker may have by 18 may be received at input {3}.
So the message CH(cr_18,offer_2) may be sent to the attacker at output {4}.
attacker(CH(cr_18,offer_2)).

20. By 19, the attacker may know CH(cr_18,offer_2).
Using the function 1-proj-CH the attacker may obtain cr_18.
attacker(cr_18).

21. By 20, the attacker may know cr_18.
By 9, the attacker may know sr_12.
By 5, the attacker may know StrongDH.
By 17, the attacker may know BadElement.
Using the function 4-tuple the attacker may obtain (cr_18,sr_12,StrongDH,BadElement).
attacker((cr_18,sr_12,StrongDH,BadElement)).

22. By 21, the attacker may know (cr_18,sr_12,StrongDH,BadElement).
Using the function hash_ideal the attacker may obtain hash_ideal((cr_18,sr_12,StrongDH,BadElement)).
attacker(hash_ideal((cr_18,sr_12,StrongDH,BadElement))).

23. By 11, the attacker may know xxx_2.
By 22, the attacker may know hash_ideal((cr_18,sr_12,StrongDH,BadElement)).
Using the function sign the attacker may obtain sign(xxx_2,hash_ideal((cr_18,sr_12,StrongDH,BadElement))).
attacker(sign(xxx_2,hash_ideal((cr_18,sr_12,StrongDH,BadElement)))).

24. By 5, the attacker may know StrongDH.
By 17, the attacker may know BadElement.
By 23, the attacker may know sign(xxx_2,hash_ideal((cr_18,sr_12,StrongDH,BadElement))).
Using the function SKE the attacker may obtain SKE(StrongDH,BadElement,sign(xxx_2,hash_ideal((cr_18,sr_12,StrongDH,BadElement)))).
attacker(SKE(StrongDH,BadElement,sign(xxx_2,hash_ideal((cr_18,sr_12,StrongDH,BadElement))))).

25. The message (sn_2,xxx_2) that the attacker may have by 15 may be received at input {108}.
So the entry longTermKeys_tbl(sn_2,xxx_2,pk(xxx_2)) may be inserted in a table at insert {110}.
table(longTermKeys_tbl(sn_2,xxx_2,pk(xxx_2))).

26. The message o_16 that the attacker may have by 1 may be received at input {3}.
The message SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9)) that the attacker may have by 10 may be received at input {5}.
The message CRT(pk(xxx_2)) that the attacker may have by 13 may be received at input {9}.
The entry longTermKeys_tbl(sn_2,xxx_2,pk(xxx_2)) that may be in a table by 25 may be read at get {45}.
The message SKE(StrongDH,BadElement,sign(xxx_2,hash_ideal((cr_18,sr_12,StrongDH,BadElement)))) that the attacker may have by 24 may be received at input {12}.
So the message CKE(e2b(dh_ideal(G,x_4))) may be sent to the attacker at output {20}.
attacker(CKE(e2b(dh_ideal(G,x_4)))).

27. By 26, the attacker may know CKE(e2b(dh_ideal(G,x_4))).
Using the function 1-proj-CKE the attacker may obtain e2b(dh_ideal(G,x_4)).
attacker(e2b(dh_ideal(G,x_4))).

28. By 27, the attacker may know e2b(dh_ideal(G,x_4)).
Using the function 1-proj-e2b the attacker may obtain dh_ideal(G,x_4).
attacker(dh_ideal(G,x_4)).

29. By 28, the attacker may know dh_ideal(G,x_4).
Using the function e2b the attacker may obtain e2b(dh_ideal(G,x_4)).
attacker(e2b(dh_ideal(G,x_4))).

30. By 29, the attacker may know e2b(dh_ideal(G,x_4)).
Using the function CKE the attacker may obtain CKE(e2b(dh_ideal(G,x_4))).
attacker(CKE(e2b(dh_ideal(G,x_4)))).

31. By 20, the attacker may know cr_18.
By 1, the attacker may know o_16.
Using the function CH the attacker may obtain CH(cr_18,o_16).
attacker(CH(cr_18,o_16)).

32. By 31, the attacker may know CH(cr_18,o_16).
By 10, the attacker may know SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9)).
Using the function 2-tuple the attacker may obtain (CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))).
attacker((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9)))).

33. By 32, the attacker may know (CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))).
By 13, the attacker may know CRT(pk(xxx_2)).
Using the function 2-tuple the attacker may obtain ((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(xxx_2))).
attacker(((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(xxx_2)))).

34. By 33, the attacker may know ((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(xxx_2))).
By 24, the attacker may know SKE(StrongDH,BadElement,sign(xxx_2,hash_ideal((cr_18,sr_12,StrongDH,BadElement)))).
Using the function 2-tuple the attacker may obtain (((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(xxx_2))),SKE(StrongDH,BadElement,sign(xxx_2,hash_ideal((cr_18,sr_12,StrongDH,BadElement))))).
attacker((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(xxx_2))),SKE(StrongDH,BadElement,sign(xxx_2,hash_ideal((cr_18,sr_12,StrongDH,BadElement)))))).

35. By 34, the attacker may know (((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(xxx_2))),SKE(StrongDH,BadElement,sign(xxx_2,hash_ideal((cr_18,sr_12,StrongDH,BadElement))))).
By 30, the attacker may know CKE(e2b(dh_ideal(G,x_4))).
Using the function 2-tuple the attacker may obtain ((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(xxx_2))),SKE(StrongDH,BadElement,sign(xxx_2,hash_ideal((cr_18,sr_12,StrongDH,BadElement))))),CKE(e2b(dh_ideal(G,x_4)))).
attacker(((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(xxx_2))),SKE(StrongDH,BadElement,sign(xxx_2,hash_ideal((cr_18,sr_12,StrongDH,BadElement))))),CKE(e2b(dh_ideal(G,x_4))))).

36. Using the function client_finished the attacker may obtain client_finished.
attacker(client_finished).

37. By 20, the attacker may know cr_18.
By 9, the attacker may know sr_12.
Using the function 2-tuple the attacker may obtain (cr_18,sr_12).
attacker((cr_18,sr_12)).

38. Using the function master_secret the attacker may obtain master_secret.
attacker(master_secret).

39. By 17, the attacker may know BadElement.
Using the function e2b the attacker may obtain e2b(BadElement).
attacker(e2b(BadElement)).

40. By 39, the attacker may know e2b(BadElement).
By 38, the attacker may know master_secret.
By 37, the attacker may know (cr_18,sr_12).
Using the function tls12_prf the attacker may obtain tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)).
attacker(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12))).

41. By 40, the attacker may know tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)).
By 36, the attacker may know client_finished.
By 35, the attacker may know ((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(xxx_2))),SKE(StrongDH,BadElement,sign(xxx_2,hash_ideal((cr_18,sr_12,StrongDH,BadElement))))),CKE(e2b(dh_ideal(G,x_4)))).
Using the function tls12_prf the attacker may obtain tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(xxx_2))),SKE(StrongDH,BadElement,sign(xxx_2,hash_ideal((cr_18,sr_12,StrongDH,BadElement))))),CKE(e2b(dh_ideal(G,x_4))))).
attacker(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(xxx_2))),SKE(StrongDH,BadElement,sign(xxx_2,hash_ideal((cr_18,sr_12,StrongDH,BadElement))))),CKE(e2b(dh_ideal(G,x_4)))))).

42. By 41, the attacker may know tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(xxx_2))),SKE(StrongDH,BadElement,sign(xxx_2,hash_ideal((cr_18,sr_12,StrongDH,BadElement))))),CKE(e2b(dh_ideal(G,x_4))))).
Using the function FIN the attacker may obtain FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(xxx_2))),SKE(StrongDH,BadElement,sign(xxx_2,hash_ideal((cr_18,sr_12,StrongDH,BadElement))))),CKE(e2b(dh_ideal(G,x_4)))))).
attacker(FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(xxx_2))),SKE(StrongDH,BadElement,sign(xxx_2,hash_ideal((cr_18,sr_12,StrongDH,BadElement))))),CKE(e2b(dh_ideal(G,x_4))))))).

43. By 35, the attacker may know ((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(xxx_2))),SKE(StrongDH,BadElement,sign(xxx_2,hash_ideal((cr_18,sr_12,StrongDH,BadElement))))),CKE(e2b(dh_ideal(G,x_4)))).
By 42, the attacker may know FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(xxx_2))),SKE(StrongDH,BadElement,sign(xxx_2,hash_ideal((cr_18,sr_12,StrongDH,BadElement))))),CKE(e2b(dh_ideal(G,x_4)))))).
Using the function 2-tuple the attacker may obtain (((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(xxx_2))),SKE(StrongDH,BadElement,sign(xxx_2,hash_ideal((cr_18,sr_12,StrongDH,BadElement))))),CKE(e2b(dh_ideal(G,x_4)))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(xxx_2))),SKE(StrongDH,BadElement,sign(xxx_2,hash_ideal((cr_18,sr_12,StrongDH,BadElement))))),CKE(e2b(dh_ideal(G,x_4))))))).
attacker((((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(xxx_2))),SKE(StrongDH,BadElement,sign(xxx_2,hash_ideal((cr_18,sr_12,StrongDH,BadElement))))),CKE(e2b(dh_ideal(G,x_4)))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(xxx_2))),SKE(StrongDH,BadElement,sign(xxx_2,hash_ideal((cr_18,sr_12,StrongDH,BadElement))))),CKE(e2b(dh_ideal(G,x_4)))))))).

44. Using the function server_finished the attacker may obtain server_finished.
attacker(server_finished).

45. By 40, the attacker may know tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)).
By 44, the attacker may know server_finished.
By 43, the attacker may know (((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(xxx_2))),SKE(StrongDH,BadElement,sign(xxx_2,hash_ideal((cr_18,sr_12,StrongDH,BadElement))))),CKE(e2b(dh_ideal(G,x_4)))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(xxx_2))),SKE(StrongDH,BadElement,sign(xxx_2,hash_ideal((cr_18,sr_12,StrongDH,BadElement))))),CKE(e2b(dh_ideal(G,x_4))))))).
Using the function tls12_prf the attacker may obtain tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),server_finished,(((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(xxx_2))),SKE(StrongDH,BadElement,sign(xxx_2,hash_ideal((cr_18,sr_12,StrongDH,BadElement))))),CKE(e2b(dh_ideal(G,x_4)))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(xxx_2))),SKE(StrongDH,BadElement,sign(xxx_2,hash_ideal((cr_18,sr_12,StrongDH,BadElement))))),CKE(e2b(dh_ideal(G,x_4)))))))).
attacker(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),server_finished,(((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(xxx_2))),SKE(StrongDH,BadElement,sign(xxx_2,hash_ideal((cr_18,sr_12,StrongDH,BadElement))))),CKE(e2b(dh_ideal(G,x_4)))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(xxx_2))),SKE(StrongDH,BadElement,sign(xxx_2,hash_ideal((cr_18,sr_12,StrongDH,BadElement))))),CKE(e2b(dh_ideal(G,x_4))))))))).

46. By 45, the attacker may know tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),server_finished,(((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(xxx_2))),SKE(StrongDH,BadElement,sign(xxx_2,hash_ideal((cr_18,sr_12,StrongDH,BadElement))))),CKE(e2b(dh_ideal(G,x_4)))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(xxx_2))),SKE(StrongDH,BadElement,sign(xxx_2,hash_ideal((cr_18,sr_12,StrongDH,BadElement))))),CKE(e2b(dh_ideal(G,x_4)))))))).
Using the function FIN the attacker may obtain FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),server_finished,(((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(xxx_2))),SKE(StrongDH,BadElement,sign(xxx_2,hash_ideal((cr_18,sr_12,StrongDH,BadElement))))),CKE(e2b(dh_ideal(G,x_4)))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(xxx_2))),SKE(StrongDH,BadElement,sign(xxx_2,hash_ideal((cr_18,sr_12,StrongDH,BadElement))))),CKE(e2b(dh_ideal(G,x_4))))))))).
attacker(FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),server_finished,(((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(xxx_2))),SKE(StrongDH,BadElement,sign(xxx_2,hash_ideal((cr_18,sr_12,StrongDH,BadElement))))),CKE(e2b(dh_ideal(G,x_4)))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(xxx_2))),SKE(StrongDH,BadElement,sign(xxx_2,hash_ideal((cr_18,sr_12,StrongDH,BadElement))))),CKE(e2b(dh_ideal(G,x_4)))))))))).

47. The message o_16 that the attacker may have by 1 may be received at input {3}.
The message SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9)) that the attacker may have by 10 may be received at input {5}.
The message CRT(pk(xxx_2)) that the attacker may have by 13 may be received at input {9}.
The entry longTermKeys_tbl(sn_2,xxx_2,pk(xxx_2)) that may be in a table by 16 may be read at get {45}.
The message SKE(StrongDH,BadElement,sign(xxx_2,hash_ideal((cr_18,sr_12,StrongDH,BadElement)))) that the attacker may have by 24 may be received at input {12}.
The message FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),server_finished,(((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(xxx_2))),SKE(StrongDH,BadElement,sign(xxx_2,hash_ideal((cr_18,sr_12,StrongDH,BadElement))))),CKE(e2b(dh_ideal(G,x_4)))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(xxx_2))),SKE(StrongDH,BadElement,sign(xxx_2,hash_ideal((cr_18,sr_12,StrongDH,BadElement))))),CKE(e2b(dh_ideal(G,x_4))))))))) that the attacker may have by 46 may be received at input {25}.
So event ClientFinished(TLS12,cr_18,sr_12,NoPSK,pk(xxx_2),o_16,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_key_expansion,(sr_12,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),server_key_expansion,(sr_12,cr_18))),tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(xxx_2))),SKE(StrongDH,BadElement,sign(xxx_2,hash_ideal((cr_18,sr_12,StrongDH,BadElement))))),CKE(e2b(dh_ideal(G,x_4))))),tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12))) may be executed at {29}.
end(ClientFinished(TLS12,cr_18,sr_12,NoPSK,pk(xxx_2),o_16,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_key_expansion,(sr_12,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),server_key_expansion,(sr_12,cr_18))),tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(xxx_2))),SKE(StrongDH,BadElement,sign(xxx_2,hash_ideal((cr_18,sr_12,StrongDH,BadElement))))),CKE(e2b(dh_ideal(G,x_4))))),tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)))).

48. By 47, end(ClientFinished(TLS12,cr_18,sr_12,NoPSK,pk(xxx_2),o_16,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_key_expansion,(sr_12,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),server_key_expansion,(sr_12,cr_18))),tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(xxx_2))),SKE(StrongDH,BadElement,sign(xxx_2,hash_ideal((cr_18,sr_12,StrongDH,BadElement))))),CKE(e2b(dh_ideal(G,x_4))))),tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)))).
The goal is reached, represented in the following fact:
end(ClientFinished(TLS12,cr_18,sr_12,NoPSK,pk(xxx_2),o_16,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_key_expansion,(sr_12,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),server_key_expansion,(sr_12,cr_18))),tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)),client_finished,((((CH(cr_18,o_16),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(xxx_2))),SKE(StrongDH,BadElement,sign(xxx_2,hash_ideal((cr_18,sr_12,StrongDH,BadElement))))),CKE(e2b(dh_ideal(G,x_4))))),tls12_prf(e2b(BadElement),master_secret,(cr_18,sr_12)))).


Unified offer_2 with o_16
Iterating unifyDerivation.
Fixpoint reached: nothing more to unify.
The clause after unifyDerivation is
attacker(o_17) && attacker(pt_9) && attacker(a_13) && attacker(sr_12) && attacker(xxx_2) && attacker(sn_2) -> end(ClientFinished(TLS12,cr[!1 = @sid],sr_12,NoPSK,pk(xxx_2),o_17,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr[!1 = @sid],sr_12)),client_key_expansion,(sr_12,cr[!1 = @sid]))),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr[!1 = @sid],sr_12)),server_key_expansion,(sr_12,cr[!1 = @sid]))),tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr[!1 = @sid],sr_12)),client_finished,((((CH(cr[!1 = @sid],o_17),SH(sr_12,nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9))),CRT(pk(xxx_2))),SKE(StrongDH,BadElement,sign(xxx_2,hash_ideal((cr[!1 = @sid],sr_12,StrongDH,BadElement))))),CKE(e2b(dh_ideal(G,x_1[s = sign(xxx_2,hash_ideal((cr[!1 = @sid],sr_12,StrongDH,BadElement))),e = BadElement,xxx = xxx_2,sn = sn_2,p = pk(xxx_2),mode = nego(TLS12,DHE(StrongDH),StrongHash,a_13,pt_9),sr = sr_12,offer = o_17,!1 = @sid]))))),tls12_prf(e2b(BadElement),master_secret,(cr[!1 = @sid],sr_12))))
This clause still contradicts the query.
A more detailed output of the traces is available with
  set traceDisplay = long.

event WeakOrCompromisedKey(NoPubKey) at {103} in copy a_14

event WeakOrCompromisedKey(NoPubKey) at {103} in copy a_15

new cr: random creating cr_18 at {2} in copy a_16

in(io, a_17) at {3} in copy a_16

out(io, CH(~M,~M_1)) with ~M = cr_18, ~M_1 = a_17 at {4} in copy a_16

in(io, SH(a_18,nego(TLS12,DHE(StrongDH),StrongHash,a_19,a_20))) at {5} in copy a_16

in(io, CRT(pk(a_21))) at {9} in copy a_16

in(io, (a_22,a_21)) at {108} in copy a_15

event WeakOrCompromisedKey(pk(a_21)) at {109} in copy a_15

insert longTermKeys_tbl(a_22,a_21,pk(a_21)) at {110} in copy a_15

get longTermKeys_tbl(a_22,a_21,pk(a_21)) at {45} in copy a_16

in(io, SKE(StrongDH,BadElement,sign(a_21,hash_ideal((~M,a_18,StrongDH,BadElement))))) with sign(a_21,hash_ideal((~M,a_18,StrongDH,BadElement))) = sign(a_21,hash_ideal((cr_18,a_18,StrongDH,BadElement))) at {12} in copy a_16

new x_1: bitstring creating x_4 at {15} in copy a_16

out(io, CKE(e2b(~M_2))) with ~M_2 = dh_ideal(G,x_4) at {20} in copy a_16

out(io, FIN(~M_3)) with ~M_3 = tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,a_18)),client_finished,((((CH(cr_18,a_17),SH(a_18,nego(TLS12,DHE(StrongDH),StrongHash,a_19,a_20))),CRT(pk(a_21))),SKE(StrongDH,BadElement,sign(a_21,hash_ideal((cr_18,a_18,StrongDH,BadElement))))),CKE(e2b(dh_ideal(G,x_4))))) at {23} in copy a_16

in(io, FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(~M,a_18)),server_finished,(((((CH(~M,a_17),SH(a_18,nego(TLS12,DHE(StrongDH),StrongHash,a_19,a_20))),CRT(pk(a_21))),SKE(StrongDH,BadElement,sign(a_21,hash_ideal((~M,a_18,StrongDH,BadElement))))),CKE(e2b(~M_2))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(~M,a_18)),client_finished,((((CH(~M,a_17),SH(a_18,nego(TLS12,DHE(StrongDH),StrongHash,a_19,a_20))),CRT(pk(a_21))),SKE(StrongDH,BadElement,sign(a_21,hash_ideal((~M,a_18,StrongDH,BadElement))))),CKE(e2b(~M_2))))))))) with tls12_prf(tls12_prf(e2b(BadElement),master_secret,(~M,a_18)),server_finished,(((((CH(~M,a_17),SH(a_18,nego(TLS12,DHE(StrongDH),StrongHash,a_19,a_20))),CRT(pk(a_21))),SKE(StrongDH,BadElement,sign(a_21,hash_ideal((~M,a_18,StrongDH,BadElement))))),CKE(e2b(~M_2))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(~M,a_18)),client_finished,((((CH(~M,a_17),SH(a_18,nego(TLS12,DHE(StrongDH),StrongHash,a_19,a_20))),CRT(pk(a_21))),SKE(StrongDH,BadElement,sign(a_21,hash_ideal((~M,a_18,StrongDH,BadElement))))),CKE(e2b(~M_2))))))) = tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,a_18)),server_finished,(((((CH(cr_18,a_17),SH(a_18,nego(TLS12,DHE(StrongDH),StrongHash,a_19,a_20))),CRT(pk(a_21))),SKE(StrongDH,BadElement,sign(a_21,hash_ideal((cr_18,a_18,StrongDH,BadElement))))),CKE(e2b(dh_ideal(G,x_4)))),FIN(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,a_18)),client_finished,((((CH(cr_18,a_17),SH(a_18,nego(TLS12,DHE(StrongDH),StrongHash,a_19,a_20))),CRT(pk(a_21))),SKE(StrongDH,BadElement,sign(a_21,hash_ideal((cr_18,a_18,StrongDH,BadElement))))),CKE(e2b(dh_ideal(G,x_4)))))))) at {25} in copy a_16

event ClientFinished(TLS12,cr_18,a_18,NoPSK,pk(a_21),a_17,nego(TLS12,DHE(StrongDH),StrongHash,a_19,a_20),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,a_18)),client_key_expansion,(a_18,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,a_18)),server_key_expansion,(a_18,cr_18))),tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,a_18)),client_finished,((((CH(cr_18,a_17),SH(a_18,nego(TLS12,DHE(StrongDH),StrongHash,a_19,a_20))),CRT(pk(a_21))),SKE(StrongDH,BadElement,sign(a_21,hash_ideal((cr_18,a_18,StrongDH,BadElement))))),CKE(e2b(dh_ideal(G,x_4))))),tls12_prf(e2b(BadElement),master_secret,(cr_18,a_18))) at {29} in copy a_16 (goal)

The event ClientFinished(TLS12,cr_18,a_18,NoPSK,pk(a_21),a_17,nego(TLS12,DHE(StrongDH),StrongHash,a_19,a_20),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,a_18)),client_key_expansion,(a_18,cr_18))),b2ae(tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,a_18)),server_key_expansion,(a_18,cr_18))),tls12_prf(tls12_prf(e2b(BadElement),master_secret,(cr_18,a_18)),client_finished,((((CH(cr_18,a_17),SH(a_18,nego(TLS12,DHE(StrongDH),StrongHash,a_19,a_20))),CRT(pk(a_21))),SKE(StrongDH,BadElement,sign(a_21,hash_ideal((cr_18,a_18,StrongDH,BadElement))))),CKE(e2b(dh_ideal(G,x_4))))),tls12_prf(e2b(BadElement),master_secret,(cr_18,a_18))) is executed at {29} in copy a_16.
A trace has been found.
RESULT event(ClientFinished(TLS12,cr_18,sr_12,NoPSK,p_7,o_16,m_10,ck_12,sk_8,cb_5,ms_9)) ==> event(ServerFinished(TLS12,cr_18,sr_12,NoPSK,p_7,o_16,m_10,ck_12,sk_8,cb_5,ms_9)) || event(ServerChoosesKEX(cr_18,sr_12,p_7,TLS12,DHE(WeakDH))) || event(ServerChoosesKEX(cr'_5,sr'_3,p_7,TLS12,RSA(WeakRSADecryption))) || event(ServerChoosesHash(cr'_5,sr'_3,p_7,TLS12,WeakHash)) is false.
-- Query not event(MatchingChannelBinding(TLS12,cr_18,sr_12,p_7,TLS12,cr'_5,sr'_3,p'_3)) in process 0.
Completing...
200 rules inserted. The rule base contains 200 rules. 137 rules in the queue.
400 rules inserted. The rule base contains 393 rules. 68 rules in the queue.
600 rules inserted. The rule base contains 505 rules. 166 rules in the queue.
800 rules inserted. The rule base contains 558 rules. 179 rules in the queue.
1000 rules inserted. The rule base contains 599 rules. 197 rules in the queue.
1200 rules inserted. The rule base contains 671 rules. 222 rules in the queue.
1400 rules inserted. The rule base contains 717 rules. 216 rules in the queue.
1600 rules inserted. The rule base contains 748 rules. 222 rules in the queue.
1800 rules inserted. The rule base contains 817 rules. 197 rules in the queue.
2000 rules inserted. The rule base contains 884 rules. 288 rules in the queue.
2200 rules inserted. The rule base contains 1006 rules. 280 rules in the queue.
2400 rules inserted. The rule base contains 1123 rules. 269 rules in the queue.
2600 rules inserted. The rule base contains 1252 rules. 257 rules in the queue.
2800 rules inserted. The rule base contains 1378 rules. 217 rules in the queue.
3000 rules inserted. The rule base contains 1484 rules. 223 rules in the queue.
3200 rules inserted. The rule base contains 1605 rules. 140 rules in the queue.
3400 rules inserted. The rule base contains 1613 rules. 97 rules in the queue.
3600 rules inserted. The rule base contains 1619 rules. 18 rules in the queue.
Starting query not event(MatchingChannelBinding(TLS12,cr_18,sr_12,p_7,TLS12,cr'_5,sr'_3,p'_3))
RESULT not event(MatchingChannelBinding(TLS12,cr_18,sr_12,p_7,TLS12,cr'_5,sr'_3,p'_3)) is true.
-- Query inj-event(ClientFinished(TLS12,cr_18,sr_12,NoPSK,p_7,o_16,m_10,ck_12,sk_8,cb_5,ms_9)) ==> inj-event(ServerFinished(TLS12,cr_18,sr_12,NoPSK,p_7,o_16,m_10,ck_12,sk_8,cb_5,ms_9)) || event(WeakOrCompromisedKey(p_7)) || event(ServerChoosesKEX(cr_18,sr_12,p_7,TLS12,DHE(WeakDH))) || event(ServerChoosesKEX(cr'_5,sr'_3,p_7,TLS12,RSA(WeakRSADecryption))) || event(ServerChoosesHash(cr'_5,sr'_3,p_7,TLS12,WeakHash)) in process 0.
Completing...
200 rules inserted. The rule base contains 200 rules. 140 rules in the queue.
400 rules inserted. The rule base contains 397 rules. 86 rules in the queue.
600 rules inserted. The rule base contains 511 rules. 142 rules in the queue.
800 rules inserted. The rule base contains 598 rules. 232 rules in the queue.
1000 rules inserted. The rule base contains 659 rules. 281 rules in the queue.
1200 rules inserted. The rule base contains 707 rules. 276 rules in the queue.
1400 rules inserted. The rule base contains 784 rules. 324 rules in the queue.
1600 rules inserted. The rule base contains 865 rules. 414 rules in the queue.
1800 rules inserted. The rule base contains 915 rules. 400 rules in the queue.
2000 rules inserted. The rule base contains 958 rules. 416 rules in the queue.
2200 rules inserted. The rule base contains 1016 rules. 416 rules in the queue.
2400 rules inserted. The rule base contains 1061 rules. 415 rules in the queue.
2600 rules inserted. The rule base contains 1154 rules. 403 rules in the queue.
